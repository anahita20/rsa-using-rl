{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6541231755287416, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0, "total_loss": 9.923146186336394, "policy_loss": -0.008298003685570533, "vf_loss": 9.931444198854509, "vf_explained_var": 9.805925430790071e-08, "kl": -6.115179782801635e-10, "entropy": 2.079428126735072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 429.0, "episode_reward_min": 230.0, "episode_reward_mean": 319.2, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [341.0, 358.0, 371.0, 280.0, 370.0, 323.0, 317.0, 297.0, 358.0, 243.0, 278.0, 356.0, 333.0, 347.0, 347.0, 238.0, 288.0, 270.0, 286.0, 346.0, 361.0, 352.0, 344.0, 250.0, 230.0, 429.0, 360.0, 331.0, 306.0, 391.0, 274.0, 286.0, 295.0, 308.0, 277.0, 310.0, 306.0, 316.0, 382.0, 313.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12106890679597557, "mean_inference_ms": 0.8162921799686187, "mean_action_processing_ms": 0.04159590805271094, "mean_env_wait_ms": 0.12483277400712078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009098052978515625, "StateBufferConnector_ms": 0.0013786554336547852, "ViewRequirementAgentConnector_ms": 0.032231807708740234}, "num_episodes": 40, "episode_return_max": 429.0, "episode_return_min": 230.0, "episode_return_mean": 319.2}, "env_runner_results": {"episode_reward_max": 429.0, "episode_reward_min": 230.0, "episode_reward_mean": 319.2, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [341.0, 358.0, 371.0, 280.0, 370.0, 323.0, 317.0, 297.0, 358.0, 243.0, 278.0, 356.0, 333.0, 347.0, 347.0, 238.0, 288.0, 270.0, 286.0, 346.0, 361.0, 352.0, 344.0, 250.0, 230.0, 429.0, 360.0, 331.0, 306.0, 391.0, 274.0, 286.0, 295.0, 308.0, 277.0, 310.0, 306.0, 316.0, 382.0, 313.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12106890679597557, "mean_inference_ms": 0.8162921799686187, "mean_action_processing_ms": 0.04159590805271094, "mean_env_wait_ms": 0.12483277400712078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009098052978515625, "StateBufferConnector_ms": 0.0013786554336547852, "ViewRequirementAgentConnector_ms": 0.032231807708740234}, "num_episodes": 40, "episode_return_max": 429.0, "episode_return_min": 230.0, "episode_return_mean": 319.2}, "episode_reward_max": 429.0, "episode_reward_min": 230.0, "episode_reward_mean": 319.2, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [341.0, 358.0, 371.0, 280.0, 370.0, 323.0, 317.0, 297.0, 358.0, 243.0, 278.0, 356.0, 333.0, 347.0, 347.0, 238.0, 288.0, 270.0, 286.0, 346.0, 361.0, 352.0, 344.0, 250.0, 230.0, 429.0, 360.0, 331.0, 306.0, 391.0, 274.0, 286.0, 295.0, 308.0, 277.0, 310.0, 306.0, 316.0, 382.0, 313.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12106890679597557, "mean_inference_ms": 0.8162921799686187, "mean_action_processing_ms": 0.04159590805271094, "mean_env_wait_ms": 0.12483277400712078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009098052978515625, "StateBufferConnector_ms": 0.0013786554336547852, "ViewRequirementAgentConnector_ms": 0.032231807708740234}, "num_episodes": 40, "episode_return_max": 429.0, "episode_return_min": 230.0, "episode_return_mean": 319.2, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 439.2558044209191, "num_env_steps_trained_throughput_per_sec": 439.2558044209191, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 9106.335, "restore_workers_time_ms": 0.009, "training_step_time_ms": 9106.248, "sample_time_ms": 4436.061, "load_time_ms": 0.154, "load_throughput": 25970922.601, "learn_time_ms": 4669.412, "learn_throughput": 856.639, "synch_weights_time_ms": 0.032}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 40, "training_iteration": 1, "trial_id": "default", "date": "2024-05-19_18-14-47", "timestamp": 1716167687, "time_this_iter_s": 9.107292175292969, "time_total_s": 9.107292175292969, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyBaselineCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 9.107292175292969, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 36.193461538461534, "ram_util_percent": 84.69653846153845}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.660494610186546, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0, "total_loss": 9.931018367890388, "policy_loss": -0.008912526401540926, "vf_loss": 9.93993091583252, "vf_explained_var": -3.6647242884482107e-06, "kl": -2.5865293732994385e-10, "entropy": 2.079428057516775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 429.0, "episode_reward_min": 230.0, "episode_reward_mean": 324.125, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [341.0, 358.0, 371.0, 280.0, 370.0, 323.0, 317.0, 297.0, 358.0, 243.0, 278.0, 356.0, 333.0, 347.0, 347.0, 238.0, 288.0, 270.0, 286.0, 346.0, 361.0, 352.0, 344.0, 250.0, 230.0, 429.0, 360.0, 331.0, 306.0, 391.0, 274.0, 286.0, 295.0, 308.0, 277.0, 310.0, 306.0, 316.0, 382.0, 313.0, 343.0, 364.0, 375.0, 273.0, 334.0, 286.0, 246.0, 251.0, 318.0, 347.0, 387.0, 261.0, 343.0, 359.0, 351.0, 366.0, 343.0, 316.0, 381.0, 281.0, 371.0, 407.0, 326.0, 290.0, 314.0, 329.0, 301.0, 378.0, 337.0, 393.0, 349.0, 334.0, 281.0, 362.0, 326.0, 333.0, 293.0, 339.0, 280.0, 294.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12097885245130133, "mean_inference_ms": 0.8183850960534894, "mean_action_processing_ms": 0.040940926920315326, "mean_env_wait_ms": 0.12139506753924385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008450448513031006, "StateBufferConnector_ms": 0.0013872981071472168, "ViewRequirementAgentConnector_ms": 0.033005475997924805}, "num_episodes": 40, "episode_return_max": 429.0, "episode_return_min": 230.0, "episode_return_mean": 324.125}, "env_runner_results": {"episode_reward_max": 429.0, "episode_reward_min": 230.0, "episode_reward_mean": 324.125, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [341.0, 358.0, 371.0, 280.0, 370.0, 323.0, 317.0, 297.0, 358.0, 243.0, 278.0, 356.0, 333.0, 347.0, 347.0, 238.0, 288.0, 270.0, 286.0, 346.0, 361.0, 352.0, 344.0, 250.0, 230.0, 429.0, 360.0, 331.0, 306.0, 391.0, 274.0, 286.0, 295.0, 308.0, 277.0, 310.0, 306.0, 316.0, 382.0, 313.0, 343.0, 364.0, 375.0, 273.0, 334.0, 286.0, 246.0, 251.0, 318.0, 347.0, 387.0, 261.0, 343.0, 359.0, 351.0, 366.0, 343.0, 316.0, 381.0, 281.0, 371.0, 407.0, 326.0, 290.0, 314.0, 329.0, 301.0, 378.0, 337.0, 393.0, 349.0, 334.0, 281.0, 362.0, 326.0, 333.0, 293.0, 339.0, 280.0, 294.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12097885245130133, "mean_inference_ms": 0.8183850960534894, "mean_action_processing_ms": 0.040940926920315326, "mean_env_wait_ms": 0.12139506753924385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008450448513031006, "StateBufferConnector_ms": 0.0013872981071472168, "ViewRequirementAgentConnector_ms": 0.033005475997924805}, "num_episodes": 40, "episode_return_max": 429.0, "episode_return_min": 230.0, "episode_return_mean": 324.125}, "episode_reward_max": 429.0, "episode_reward_min": 230.0, "episode_reward_mean": 324.125, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [341.0, 358.0, 371.0, 280.0, 370.0, 323.0, 317.0, 297.0, 358.0, 243.0, 278.0, 356.0, 333.0, 347.0, 347.0, 238.0, 288.0, 270.0, 286.0, 346.0, 361.0, 352.0, 344.0, 250.0, 230.0, 429.0, 360.0, 331.0, 306.0, 391.0, 274.0, 286.0, 295.0, 308.0, 277.0, 310.0, 306.0, 316.0, 382.0, 313.0, 343.0, 364.0, 375.0, 273.0, 334.0, 286.0, 246.0, 251.0, 318.0, 347.0, 387.0, 261.0, 343.0, 359.0, 351.0, 366.0, 343.0, 316.0, 381.0, 281.0, 371.0, 407.0, 326.0, 290.0, 314.0, 329.0, 301.0, 378.0, 337.0, 393.0, 349.0, 334.0, 281.0, 362.0, 326.0, 333.0, 293.0, 339.0, 280.0, 294.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12097885245130133, "mean_inference_ms": 0.8183850960534894, "mean_action_processing_ms": 0.040940926920315326, "mean_env_wait_ms": 0.12139506753924385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008450448513031006, "StateBufferConnector_ms": 0.0013872981071472168, "ViewRequirementAgentConnector_ms": 0.033005475997924805}, "num_episodes": 40, "episode_return_max": 429.0, "episode_return_min": 230.0, "episode_return_mean": 324.125, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 438.21320389881186, "num_env_steps_trained_throughput_per_sec": 438.21320389881186, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 9117.166, "restore_workers_time_ms": 0.008, "training_step_time_ms": 9117.084, "sample_time_ms": 4427.051, "load_time_ms": 0.859, "load_throughput": 4653874.064, "learn_time_ms": 4688.577, "learn_throughput": 853.137, "synch_weights_time_ms": 0.027}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 80, "training_iteration": 2, "trial_id": "default", "date": "2024-05-19_18-14-56", "timestamp": 1716167696, "time_this_iter_s": 9.129518270492554, "time_total_s": 18.236810445785522, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyBaselineCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 18.236810445785522, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 35.676923076923075, "ram_util_percent": 84.76923076923075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6240955322019515, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0, "total_loss": 9.94094596370574, "policy_loss": -0.006921227300359357, "vf_loss": 9.947867178147838, "vf_explained_var": -4.658775944863596e-06, "kl": 4.759898071571647e-10, "entropy": 2.079428172880603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 429.0, "episode_reward_min": 230.0, "episode_reward_mean": 328.03, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [361.0, 352.0, 344.0, 250.0, 230.0, 429.0, 360.0, 331.0, 306.0, 391.0, 274.0, 286.0, 295.0, 308.0, 277.0, 310.0, 306.0, 316.0, 382.0, 313.0, 343.0, 364.0, 375.0, 273.0, 334.0, 286.0, 246.0, 251.0, 318.0, 347.0, 387.0, 261.0, 343.0, 359.0, 351.0, 366.0, 343.0, 316.0, 381.0, 281.0, 371.0, 407.0, 326.0, 290.0, 314.0, 329.0, 301.0, 378.0, 337.0, 393.0, 349.0, 334.0, 281.0, 362.0, 326.0, 333.0, 293.0, 339.0, 280.0, 294.0, 312.0, 358.0, 394.0, 343.0, 319.0, 310.0, 343.0, 278.0, 284.0, 360.0, 347.0, 292.0, 353.0, 326.0, 373.0, 347.0, 305.0, 262.0, 379.0, 330.0, 364.0, 360.0, 318.0, 365.0, 344.0, 294.0, 356.0, 288.0, 353.0, 356.0, 316.0, 287.0, 312.0, 354.0, 333.0, 303.0, 329.0, 403.0, 289.0, 281.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11874041632419705, "mean_inference_ms": 0.8025943616508378, "mean_action_processing_ms": 0.03997920621238832, "mean_env_wait_ms": 0.11768331162070676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008151054382324219, "StateBufferConnector_ms": 0.0013725757598876953, "ViewRequirementAgentConnector_ms": 0.0325932502746582}, "num_episodes": 40, "episode_return_max": 429.0, "episode_return_min": 230.0, "episode_return_mean": 328.03}, "env_runner_results": {"episode_reward_max": 429.0, "episode_reward_min": 230.0, "episode_reward_mean": 328.03, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [361.0, 352.0, 344.0, 250.0, 230.0, 429.0, 360.0, 331.0, 306.0, 391.0, 274.0, 286.0, 295.0, 308.0, 277.0, 310.0, 306.0, 316.0, 382.0, 313.0, 343.0, 364.0, 375.0, 273.0, 334.0, 286.0, 246.0, 251.0, 318.0, 347.0, 387.0, 261.0, 343.0, 359.0, 351.0, 366.0, 343.0, 316.0, 381.0, 281.0, 371.0, 407.0, 326.0, 290.0, 314.0, 329.0, 301.0, 378.0, 337.0, 393.0, 349.0, 334.0, 281.0, 362.0, 326.0, 333.0, 293.0, 339.0, 280.0, 294.0, 312.0, 358.0, 394.0, 343.0, 319.0, 310.0, 343.0, 278.0, 284.0, 360.0, 347.0, 292.0, 353.0, 326.0, 373.0, 347.0, 305.0, 262.0, 379.0, 330.0, 364.0, 360.0, 318.0, 365.0, 344.0, 294.0, 356.0, 288.0, 353.0, 356.0, 316.0, 287.0, 312.0, 354.0, 333.0, 303.0, 329.0, 403.0, 289.0, 281.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11874041632419705, "mean_inference_ms": 0.8025943616508378, "mean_action_processing_ms": 0.03997920621238832, "mean_env_wait_ms": 0.11768331162070676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008151054382324219, "StateBufferConnector_ms": 0.0013725757598876953, "ViewRequirementAgentConnector_ms": 0.0325932502746582}, "num_episodes": 40, "episode_return_max": 429.0, "episode_return_min": 230.0, "episode_return_mean": 328.03}, "episode_reward_max": 429.0, "episode_reward_min": 230.0, "episode_reward_mean": 328.03, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [361.0, 352.0, 344.0, 250.0, 230.0, 429.0, 360.0, 331.0, 306.0, 391.0, 274.0, 286.0, 295.0, 308.0, 277.0, 310.0, 306.0, 316.0, 382.0, 313.0, 343.0, 364.0, 375.0, 273.0, 334.0, 286.0, 246.0, 251.0, 318.0, 347.0, 387.0, 261.0, 343.0, 359.0, 351.0, 366.0, 343.0, 316.0, 381.0, 281.0, 371.0, 407.0, 326.0, 290.0, 314.0, 329.0, 301.0, 378.0, 337.0, 393.0, 349.0, 334.0, 281.0, 362.0, 326.0, 333.0, 293.0, 339.0, 280.0, 294.0, 312.0, 358.0, 394.0, 343.0, 319.0, 310.0, 343.0, 278.0, 284.0, 360.0, 347.0, 292.0, 353.0, 326.0, 373.0, 347.0, 305.0, 262.0, 379.0, 330.0, 364.0, 360.0, 318.0, 365.0, 344.0, 294.0, 356.0, 288.0, 353.0, 356.0, 316.0, 287.0, 312.0, 354.0, 333.0, 303.0, 329.0, 403.0, 289.0, 281.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11874041632419705, "mean_inference_ms": 0.8025943616508378, "mean_action_processing_ms": 0.03997920621238832, "mean_env_wait_ms": 0.11768331162070676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008151054382324219, "StateBufferConnector_ms": 0.0013725757598876953, "ViewRequirementAgentConnector_ms": 0.0325932502746582}, "num_episodes": 40, "episode_return_max": 429.0, "episode_return_min": 230.0, "episode_return_mean": 328.03, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 467.0621448291037, "num_env_steps_trained_throughput_per_sec": 467.0621448291037, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 8932.842, "restore_workers_time_ms": 0.01, "training_step_time_ms": 8932.752, "sample_time_ms": 4210.665, "load_time_ms": 2.422, "load_throughput": 1651788.52, "learn_time_ms": 4719.047, "learn_throughput": 847.629, "synch_weights_time_ms": 0.032}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 120, "training_iteration": 3, "trial_id": "default", "date": "2024-05-19_18-15-05", "timestamp": 1716167705, "time_this_iter_s": 8.565968036651611, "time_total_s": 26.802778482437134, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyBaselineCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 26.802778482437134, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 33.74166666666667, "ram_util_percent": 85.91666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.629899174936356, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0, "total_loss": 9.939733105321084, "policy_loss": -0.008149445297256593, "vf_loss": 9.947882559991651, "vf_explained_var": -6.287328658565398e-07, "kl": -8.369343838037797e-10, "entropy": 2.0794280652076966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 407.0, "episode_reward_min": 224.0, "episode_reward_mean": 325.63, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [371.0, 407.0, 326.0, 290.0, 314.0, 329.0, 301.0, 378.0, 337.0, 393.0, 349.0, 334.0, 281.0, 362.0, 326.0, 333.0, 293.0, 339.0, 280.0, 294.0, 312.0, 358.0, 394.0, 343.0, 319.0, 310.0, 343.0, 278.0, 284.0, 360.0, 347.0, 292.0, 353.0, 326.0, 373.0, 347.0, 305.0, 262.0, 379.0, 330.0, 364.0, 360.0, 318.0, 365.0, 344.0, 294.0, 356.0, 288.0, 353.0, 356.0, 316.0, 287.0, 312.0, 354.0, 333.0, 303.0, 329.0, 403.0, 289.0, 281.0, 329.0, 383.0, 254.0, 316.0, 308.0, 315.0, 390.0, 323.0, 357.0, 297.0, 345.0, 309.0, 280.0, 348.0, 347.0, 294.0, 284.0, 241.0, 280.0, 353.0, 224.0, 311.0, 297.0, 375.0, 282.0, 355.0, 340.0, 278.0, 400.0, 291.0, 298.0, 288.0, 351.0, 369.0, 297.0, 264.0, 358.0, 300.0, 354.0, 321.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11890446917817442, "mean_inference_ms": 0.7930936075094192, "mean_action_processing_ms": 0.04013350813354236, "mean_env_wait_ms": 0.11673657338768056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008578062057495117, "StateBufferConnector_ms": 0.0014395713806152344, "ViewRequirementAgentConnector_ms": 0.03618931770324707}, "num_episodes": 40, "episode_return_max": 407.0, "episode_return_min": 224.0, "episode_return_mean": 325.63}, "env_runner_results": {"episode_reward_max": 407.0, "episode_reward_min": 224.0, "episode_reward_mean": 325.63, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [371.0, 407.0, 326.0, 290.0, 314.0, 329.0, 301.0, 378.0, 337.0, 393.0, 349.0, 334.0, 281.0, 362.0, 326.0, 333.0, 293.0, 339.0, 280.0, 294.0, 312.0, 358.0, 394.0, 343.0, 319.0, 310.0, 343.0, 278.0, 284.0, 360.0, 347.0, 292.0, 353.0, 326.0, 373.0, 347.0, 305.0, 262.0, 379.0, 330.0, 364.0, 360.0, 318.0, 365.0, 344.0, 294.0, 356.0, 288.0, 353.0, 356.0, 316.0, 287.0, 312.0, 354.0, 333.0, 303.0, 329.0, 403.0, 289.0, 281.0, 329.0, 383.0, 254.0, 316.0, 308.0, 315.0, 390.0, 323.0, 357.0, 297.0, 345.0, 309.0, 280.0, 348.0, 347.0, 294.0, 284.0, 241.0, 280.0, 353.0, 224.0, 311.0, 297.0, 375.0, 282.0, 355.0, 340.0, 278.0, 400.0, 291.0, 298.0, 288.0, 351.0, 369.0, 297.0, 264.0, 358.0, 300.0, 354.0, 321.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11890446917817442, "mean_inference_ms": 0.7930936075094192, "mean_action_processing_ms": 0.04013350813354236, "mean_env_wait_ms": 0.11673657338768056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008578062057495117, "StateBufferConnector_ms": 0.0014395713806152344, "ViewRequirementAgentConnector_ms": 0.03618931770324707}, "num_episodes": 40, "episode_return_max": 407.0, "episode_return_min": 224.0, "episode_return_mean": 325.63}, "episode_reward_max": 407.0, "episode_reward_min": 224.0, "episode_reward_mean": 325.63, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [371.0, 407.0, 326.0, 290.0, 314.0, 329.0, 301.0, 378.0, 337.0, 393.0, 349.0, 334.0, 281.0, 362.0, 326.0, 333.0, 293.0, 339.0, 280.0, 294.0, 312.0, 358.0, 394.0, 343.0, 319.0, 310.0, 343.0, 278.0, 284.0, 360.0, 347.0, 292.0, 353.0, 326.0, 373.0, 347.0, 305.0, 262.0, 379.0, 330.0, 364.0, 360.0, 318.0, 365.0, 344.0, 294.0, 356.0, 288.0, 353.0, 356.0, 316.0, 287.0, 312.0, 354.0, 333.0, 303.0, 329.0, 403.0, 289.0, 281.0, 329.0, 383.0, 254.0, 316.0, 308.0, 315.0, 390.0, 323.0, 357.0, 297.0, 345.0, 309.0, 280.0, 348.0, 347.0, 294.0, 284.0, 241.0, 280.0, 353.0, 224.0, 311.0, 297.0, 375.0, 282.0, 355.0, 340.0, 278.0, 400.0, 291.0, 298.0, 288.0, 351.0, 369.0, 297.0, 264.0, 358.0, 300.0, 354.0, 321.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11890446917817442, "mean_inference_ms": 0.7930936075094192, "mean_action_processing_ms": 0.04013350813354236, "mean_env_wait_ms": 0.11673657338768056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008578062057495117, "StateBufferConnector_ms": 0.0014395713806152344, "ViewRequirementAgentConnector_ms": 0.03618931770324707}, "num_episodes": 40, "episode_return_max": 407.0, "episode_return_min": 224.0, "episode_return_mean": 325.63, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.29674089894667, "num_env_steps_trained_throughput_per_sec": 417.29674089894667, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 9096.013, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9095.922, "sample_time_ms": 4333.12, "load_time_ms": 4.765, "load_throughput": 839458.914, "learn_time_ms": 4757.226, "learn_throughput": 840.826, "synch_weights_time_ms": 0.03}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 160, "training_iteration": 4, "trial_id": "default", "date": "2024-05-19_18-15-14", "timestamp": 1716167714, "time_this_iter_s": 9.587389945983887, "time_total_s": 36.39016842842102, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyBaselineCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 36.39016842842102, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 41.135714285714286, "ram_util_percent": 84.50714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6571860255733613, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0, "total_loss": 9.950401275388655, "policy_loss": -0.0078094952829903174, "vf_loss": 9.958210822074644, "vf_explained_var": -4.110797759025328e-06, "kl": 1.9835824246579895e-10, "entropy": 2.079427880625571, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 428.0, "episode_reward_min": 224.0, "episode_reward_mean": 328.63, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [364.0, 360.0, 318.0, 365.0, 344.0, 294.0, 356.0, 288.0, 353.0, 356.0, 316.0, 287.0, 312.0, 354.0, 333.0, 303.0, 329.0, 403.0, 289.0, 281.0, 329.0, 383.0, 254.0, 316.0, 308.0, 315.0, 390.0, 323.0, 357.0, 297.0, 345.0, 309.0, 280.0, 348.0, 347.0, 294.0, 284.0, 241.0, 280.0, 353.0, 224.0, 311.0, 297.0, 375.0, 282.0, 355.0, 340.0, 278.0, 400.0, 291.0, 298.0, 288.0, 351.0, 369.0, 297.0, 264.0, 358.0, 300.0, 354.0, 321.0, 285.0, 308.0, 327.0, 361.0, 378.0, 318.0, 293.0, 368.0, 329.0, 290.0, 268.0, 298.0, 335.0, 308.0, 311.0, 324.0, 382.0, 388.0, 286.0, 288.0, 366.0, 320.0, 380.0, 395.0, 338.0, 322.0, 428.0, 371.0, 327.0, 323.0, 352.0, 294.0, 357.0, 367.0, 341.0, 355.0, 402.0, 350.0, 316.0, 403.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11890724103555456, "mean_inference_ms": 0.7835522739695149, "mean_action_processing_ms": 0.04042168368238208, "mean_env_wait_ms": 0.11699110252235925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008604288101196289, "StateBufferConnector_ms": 0.0014481544494628906, "ViewRequirementAgentConnector_ms": 0.036222219467163086}, "num_episodes": 40, "episode_return_max": 428.0, "episode_return_min": 224.0, "episode_return_mean": 328.63}, "env_runner_results": {"episode_reward_max": 428.0, "episode_reward_min": 224.0, "episode_reward_mean": 328.63, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [364.0, 360.0, 318.0, 365.0, 344.0, 294.0, 356.0, 288.0, 353.0, 356.0, 316.0, 287.0, 312.0, 354.0, 333.0, 303.0, 329.0, 403.0, 289.0, 281.0, 329.0, 383.0, 254.0, 316.0, 308.0, 315.0, 390.0, 323.0, 357.0, 297.0, 345.0, 309.0, 280.0, 348.0, 347.0, 294.0, 284.0, 241.0, 280.0, 353.0, 224.0, 311.0, 297.0, 375.0, 282.0, 355.0, 340.0, 278.0, 400.0, 291.0, 298.0, 288.0, 351.0, 369.0, 297.0, 264.0, 358.0, 300.0, 354.0, 321.0, 285.0, 308.0, 327.0, 361.0, 378.0, 318.0, 293.0, 368.0, 329.0, 290.0, 268.0, 298.0, 335.0, 308.0, 311.0, 324.0, 382.0, 388.0, 286.0, 288.0, 366.0, 320.0, 380.0, 395.0, 338.0, 322.0, 428.0, 371.0, 327.0, 323.0, 352.0, 294.0, 357.0, 367.0, 341.0, 355.0, 402.0, 350.0, 316.0, 403.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11890724103555456, "mean_inference_ms": 0.7835522739695149, "mean_action_processing_ms": 0.04042168368238208, "mean_env_wait_ms": 0.11699110252235925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008604288101196289, "StateBufferConnector_ms": 0.0014481544494628906, "ViewRequirementAgentConnector_ms": 0.036222219467163086}, "num_episodes": 40, "episode_return_max": 428.0, "episode_return_min": 224.0, "episode_return_mean": 328.63}, "episode_reward_max": 428.0, "episode_reward_min": 224.0, "episode_reward_mean": 328.63, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [364.0, 360.0, 318.0, 365.0, 344.0, 294.0, 356.0, 288.0, 353.0, 356.0, 316.0, 287.0, 312.0, 354.0, 333.0, 303.0, 329.0, 403.0, 289.0, 281.0, 329.0, 383.0, 254.0, 316.0, 308.0, 315.0, 390.0, 323.0, 357.0, 297.0, 345.0, 309.0, 280.0, 348.0, 347.0, 294.0, 284.0, 241.0, 280.0, 353.0, 224.0, 311.0, 297.0, 375.0, 282.0, 355.0, 340.0, 278.0, 400.0, 291.0, 298.0, 288.0, 351.0, 369.0, 297.0, 264.0, 358.0, 300.0, 354.0, 321.0, 285.0, 308.0, 327.0, 361.0, 378.0, 318.0, 293.0, 368.0, 329.0, 290.0, 268.0, 298.0, 335.0, 308.0, 311.0, 324.0, 382.0, 388.0, 286.0, 288.0, 366.0, 320.0, 380.0, 395.0, 338.0, 322.0, 428.0, 371.0, 327.0, 323.0, 352.0, 294.0, 357.0, 367.0, 341.0, 355.0, 402.0, 350.0, 316.0, 403.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11890724103555456, "mean_inference_ms": 0.7835522739695149, "mean_action_processing_ms": 0.04042168368238208, "mean_env_wait_ms": 0.11699110252235925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008604288101196289, "StateBufferConnector_ms": 0.0014481544494628906, "ViewRequirementAgentConnector_ms": 0.036222219467163086}, "num_episodes": 40, "episode_return_max": 428.0, "episode_return_min": 224.0, "episode_return_mean": 328.63, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 452.5053876091503, "num_env_steps_trained_throughput_per_sec": 452.5053876091503, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 9044.75, "restore_workers_time_ms": 0.011, "training_step_time_ms": 9044.656, "sample_time_ms": 4226.792, "load_time_ms": 4.047, "load_throughput": 988488.269, "learn_time_ms": 4813.016, "learn_throughput": 831.08, "synch_weights_time_ms": 0.031}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 200, "training_iteration": 5, "trial_id": "default", "date": "2024-05-19_18-15-23", "timestamp": 1716167723, "time_this_iter_s": 8.84180498123169, "time_total_s": 45.23197340965271, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyBaselineCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 45.23197340965271, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 35.31666666666667, "ram_util_percent": 84.14166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6608752435253513, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0, "total_loss": 9.940984110678396, "policy_loss": -0.009555406177476529, "vf_loss": 9.950539527400847, "vf_explained_var": -7.327525846419796e-06, "kl": 5.975318412108865e-10, "entropy": 2.079427934462024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 428.0, "episode_reward_min": 221.0, "episode_reward_mean": 330.54, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [224.0, 311.0, 297.0, 375.0, 282.0, 355.0, 340.0, 278.0, 400.0, 291.0, 298.0, 288.0, 351.0, 369.0, 297.0, 264.0, 358.0, 300.0, 354.0, 321.0, 285.0, 308.0, 327.0, 361.0, 378.0, 318.0, 293.0, 368.0, 329.0, 290.0, 268.0, 298.0, 335.0, 308.0, 311.0, 324.0, 382.0, 388.0, 286.0, 288.0, 366.0, 320.0, 380.0, 395.0, 338.0, 322.0, 428.0, 371.0, 327.0, 323.0, 352.0, 294.0, 357.0, 367.0, 341.0, 355.0, 402.0, 350.0, 316.0, 403.0, 368.0, 380.0, 322.0, 282.0, 303.0, 395.0, 390.0, 350.0, 347.0, 328.0, 276.0, 364.0, 314.0, 291.0, 358.0, 308.0, 315.0, 288.0, 346.0, 316.0, 366.0, 223.0, 379.0, 341.0, 253.0, 317.0, 335.0, 386.0, 339.0, 390.0, 288.0, 374.0, 320.0, 300.0, 376.0, 221.0, 332.0, 353.0, 284.0, 331.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11857233988901608, "mean_inference_ms": 0.7772691562818586, "mean_action_processing_ms": 0.04039755608425862, "mean_env_wait_ms": 0.11677493556961398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008661746978759766, "StateBufferConnector_ms": 0.0014743804931640625, "ViewRequirementAgentConnector_ms": 0.036089420318603516}, "num_episodes": 40, "episode_return_max": 428.0, "episode_return_min": 221.0, "episode_return_mean": 330.54}, "env_runner_results": {"episode_reward_max": 428.0, "episode_reward_min": 221.0, "episode_reward_mean": 330.54, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [224.0, 311.0, 297.0, 375.0, 282.0, 355.0, 340.0, 278.0, 400.0, 291.0, 298.0, 288.0, 351.0, 369.0, 297.0, 264.0, 358.0, 300.0, 354.0, 321.0, 285.0, 308.0, 327.0, 361.0, 378.0, 318.0, 293.0, 368.0, 329.0, 290.0, 268.0, 298.0, 335.0, 308.0, 311.0, 324.0, 382.0, 388.0, 286.0, 288.0, 366.0, 320.0, 380.0, 395.0, 338.0, 322.0, 428.0, 371.0, 327.0, 323.0, 352.0, 294.0, 357.0, 367.0, 341.0, 355.0, 402.0, 350.0, 316.0, 403.0, 368.0, 380.0, 322.0, 282.0, 303.0, 395.0, 390.0, 350.0, 347.0, 328.0, 276.0, 364.0, 314.0, 291.0, 358.0, 308.0, 315.0, 288.0, 346.0, 316.0, 366.0, 223.0, 379.0, 341.0, 253.0, 317.0, 335.0, 386.0, 339.0, 390.0, 288.0, 374.0, 320.0, 300.0, 376.0, 221.0, 332.0, 353.0, 284.0, 331.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11857233988901608, "mean_inference_ms": 0.7772691562818586, "mean_action_processing_ms": 0.04039755608425862, "mean_env_wait_ms": 0.11677493556961398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008661746978759766, "StateBufferConnector_ms": 0.0014743804931640625, "ViewRequirementAgentConnector_ms": 0.036089420318603516}, "num_episodes": 40, "episode_return_max": 428.0, "episode_return_min": 221.0, "episode_return_mean": 330.54}, "episode_reward_max": 428.0, "episode_reward_min": 221.0, "episode_reward_mean": 330.54, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [224.0, 311.0, 297.0, 375.0, 282.0, 355.0, 340.0, 278.0, 400.0, 291.0, 298.0, 288.0, 351.0, 369.0, 297.0, 264.0, 358.0, 300.0, 354.0, 321.0, 285.0, 308.0, 327.0, 361.0, 378.0, 318.0, 293.0, 368.0, 329.0, 290.0, 268.0, 298.0, 335.0, 308.0, 311.0, 324.0, 382.0, 388.0, 286.0, 288.0, 366.0, 320.0, 380.0, 395.0, 338.0, 322.0, 428.0, 371.0, 327.0, 323.0, 352.0, 294.0, 357.0, 367.0, 341.0, 355.0, 402.0, 350.0, 316.0, 403.0, 368.0, 380.0, 322.0, 282.0, 303.0, 395.0, 390.0, 350.0, 347.0, 328.0, 276.0, 364.0, 314.0, 291.0, 358.0, 308.0, 315.0, 288.0, 346.0, 316.0, 366.0, 223.0, 379.0, 341.0, 253.0, 317.0, 335.0, 386.0, 339.0, 390.0, 288.0, 374.0, 320.0, 300.0, 376.0, 221.0, 332.0, 353.0, 284.0, 331.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11857233988901608, "mean_inference_ms": 0.7772691562818586, "mean_action_processing_ms": 0.04039755608425862, "mean_env_wait_ms": 0.11677493556961398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008661746978759766, "StateBufferConnector_ms": 0.0014743804931640625, "ViewRequirementAgentConnector_ms": 0.036089420318603516}, "num_episodes": 40, "episode_return_max": 428.0, "episode_return_min": 221.0, "episode_return_mean": 330.54, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 453.88618232906435, "num_env_steps_trained_throughput_per_sec": 453.88618232906435, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 9006.093, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9005.996, "sample_time_ms": 4201.801, "load_time_ms": 3.879, "load_throughput": 1031143.235, "learn_time_ms": 4799.428, "learn_throughput": 833.433, "synch_weights_time_ms": 0.033}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 240, "training_iteration": 6, "trial_id": "default", "date": "2024-05-19_18-15-32", "timestamp": 1716167732, "time_this_iter_s": 8.815240144729614, "time_total_s": 54.047213554382324, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyBaselineCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 54.047213554382324, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 37.0923076923077, "ram_util_percent": 83.98461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.719328213122583, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0, "total_loss": 9.930782318115234, "policy_loss": -0.008023018017411232, "vf_loss": 9.938805364793346, "vf_explained_var": -2.6072225263041835e-06, "kl": -8.277871936300126e-11, "entropy": 2.07942811904415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 428.0, "episode_reward_min": 221.0, "episode_reward_mean": 338.1, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.0, 320.0, 380.0, 395.0, 338.0, 322.0, 428.0, 371.0, 327.0, 323.0, 352.0, 294.0, 357.0, 367.0, 341.0, 355.0, 402.0, 350.0, 316.0, 403.0, 368.0, 380.0, 322.0, 282.0, 303.0, 395.0, 390.0, 350.0, 347.0, 328.0, 276.0, 364.0, 314.0, 291.0, 358.0, 308.0, 315.0, 288.0, 346.0, 316.0, 366.0, 223.0, 379.0, 341.0, 253.0, 317.0, 335.0, 386.0, 339.0, 390.0, 288.0, 374.0, 320.0, 300.0, 376.0, 221.0, 332.0, 353.0, 284.0, 331.0, 295.0, 391.0, 307.0, 338.0, 394.0, 343.0, 319.0, 281.0, 349.0, 307.0, 312.0, 376.0, 379.0, 351.0, 314.0, 355.0, 363.0, 368.0, 355.0, 330.0, 273.0, 295.0, 337.0, 358.0, 335.0, 352.0, 353.0, 382.0, 361.0, 354.0, 343.0, 269.0, 269.0, 378.0, 340.0, 318.0, 387.0, 371.0, 325.0, 327.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1169017297341652, "mean_inference_ms": 0.7669928799393934, "mean_action_processing_ms": 0.03983725906743314, "mean_env_wait_ms": 0.11543711339676722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008028268814086914, "StateBufferConnector_ms": 0.0013740062713623047, "ViewRequirementAgentConnector_ms": 0.031919002532958984}, "num_episodes": 40, "episode_return_max": 428.0, "episode_return_min": 221.0, "episode_return_mean": 338.1}, "env_runner_results": {"episode_reward_max": 428.0, "episode_reward_min": 221.0, "episode_reward_mean": 338.1, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.0, 320.0, 380.0, 395.0, 338.0, 322.0, 428.0, 371.0, 327.0, 323.0, 352.0, 294.0, 357.0, 367.0, 341.0, 355.0, 402.0, 350.0, 316.0, 403.0, 368.0, 380.0, 322.0, 282.0, 303.0, 395.0, 390.0, 350.0, 347.0, 328.0, 276.0, 364.0, 314.0, 291.0, 358.0, 308.0, 315.0, 288.0, 346.0, 316.0, 366.0, 223.0, 379.0, 341.0, 253.0, 317.0, 335.0, 386.0, 339.0, 390.0, 288.0, 374.0, 320.0, 300.0, 376.0, 221.0, 332.0, 353.0, 284.0, 331.0, 295.0, 391.0, 307.0, 338.0, 394.0, 343.0, 319.0, 281.0, 349.0, 307.0, 312.0, 376.0, 379.0, 351.0, 314.0, 355.0, 363.0, 368.0, 355.0, 330.0, 273.0, 295.0, 337.0, 358.0, 335.0, 352.0, 353.0, 382.0, 361.0, 354.0, 343.0, 269.0, 269.0, 378.0, 340.0, 318.0, 387.0, 371.0, 325.0, 327.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1169017297341652, "mean_inference_ms": 0.7669928799393934, "mean_action_processing_ms": 0.03983725906743314, "mean_env_wait_ms": 0.11543711339676722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008028268814086914, "StateBufferConnector_ms": 0.0013740062713623047, "ViewRequirementAgentConnector_ms": 0.031919002532958984}, "num_episodes": 40, "episode_return_max": 428.0, "episode_return_min": 221.0, "episode_return_mean": 338.1}, "episode_reward_max": 428.0, "episode_reward_min": 221.0, "episode_reward_mean": 338.1, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [366.0, 320.0, 380.0, 395.0, 338.0, 322.0, 428.0, 371.0, 327.0, 323.0, 352.0, 294.0, 357.0, 367.0, 341.0, 355.0, 402.0, 350.0, 316.0, 403.0, 368.0, 380.0, 322.0, 282.0, 303.0, 395.0, 390.0, 350.0, 347.0, 328.0, 276.0, 364.0, 314.0, 291.0, 358.0, 308.0, 315.0, 288.0, 346.0, 316.0, 366.0, 223.0, 379.0, 341.0, 253.0, 317.0, 335.0, 386.0, 339.0, 390.0, 288.0, 374.0, 320.0, 300.0, 376.0, 221.0, 332.0, 353.0, 284.0, 331.0, 295.0, 391.0, 307.0, 338.0, 394.0, 343.0, 319.0, 281.0, 349.0, 307.0, 312.0, 376.0, 379.0, 351.0, 314.0, 355.0, 363.0, 368.0, 355.0, 330.0, 273.0, 295.0, 337.0, 358.0, 335.0, 352.0, 353.0, 382.0, 361.0, 354.0, 343.0, 269.0, 269.0, 378.0, 340.0, 318.0, 387.0, 371.0, 325.0, 327.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1169017297341652, "mean_inference_ms": 0.7669928799393934, "mean_action_processing_ms": 0.03983725906743314, "mean_env_wait_ms": 0.11543711339676722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008028268814086914, "StateBufferConnector_ms": 0.0013740062713623047, "ViewRequirementAgentConnector_ms": 0.031919002532958984}, "num_episodes": 40, "episode_return_max": 428.0, "episode_return_min": 221.0, "episode_return_mean": 338.1, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 457.62715424247807, "num_env_steps_trained_throughput_per_sec": 457.62715424247807, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 8968.189, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8968.096, "sample_time_ms": 4139.44, "load_time_ms": 3.518, "load_throughput": 1137152.02, "learn_time_ms": 4824.299, "learn_throughput": 829.136, "synch_weights_time_ms": 0.03}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 280, "training_iteration": 7, "trial_id": "default", "date": "2024-05-19_18-15-41", "timestamp": 1716167741, "time_this_iter_s": 8.741807222366333, "time_total_s": 62.78902077674866, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyBaselineCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 62.78902077674866, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 28.275000000000002, "ram_util_percent": 84.59166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5142928419574615, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0, "total_loss": 9.954540652613487, "policy_loss": -0.008914524929658059, "vf_loss": 9.963455138667937, "vf_explained_var": -3.5455149988974295e-06, "kl": -4.463137717825744e-10, "entropy": 2.079428172880603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 415.0, "episode_reward_min": 214.0, "episode_reward_mean": 335.2, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.0, 223.0, 379.0, 341.0, 253.0, 317.0, 335.0, 386.0, 339.0, 390.0, 288.0, 374.0, 320.0, 300.0, 376.0, 221.0, 332.0, 353.0, 284.0, 331.0, 295.0, 391.0, 307.0, 338.0, 394.0, 343.0, 319.0, 281.0, 349.0, 307.0, 312.0, 376.0, 379.0, 351.0, 314.0, 355.0, 363.0, 368.0, 355.0, 330.0, 273.0, 295.0, 337.0, 358.0, 335.0, 352.0, 353.0, 382.0, 361.0, 354.0, 343.0, 269.0, 269.0, 378.0, 340.0, 318.0, 387.0, 371.0, 325.0, 327.0, 283.0, 332.0, 415.0, 237.0, 324.0, 332.0, 388.0, 314.0, 360.0, 400.0, 288.0, 341.0, 352.0, 330.0, 400.0, 324.0, 384.0, 356.0, 318.0, 408.0, 382.0, 317.0, 214.0, 311.0, 345.0, 366.0, 401.0, 316.0, 314.0, 333.0, 337.0, 308.0, 314.0, 358.0, 360.0, 299.0, 283.0, 323.0, 345.0, 346.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1160644849063841, "mean_inference_ms": 0.7628861644659211, "mean_action_processing_ms": 0.039540555295132285, "mean_env_wait_ms": 0.11473168698825574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008479833602905273, "StateBufferConnector_ms": 0.0014159679412841797, "ViewRequirementAgentConnector_ms": 0.0322878360748291}, "num_episodes": 40, "episode_return_max": 415.0, "episode_return_min": 214.0, "episode_return_mean": 335.2}, "env_runner_results": {"episode_reward_max": 415.0, "episode_reward_min": 214.0, "episode_reward_mean": 335.2, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.0, 223.0, 379.0, 341.0, 253.0, 317.0, 335.0, 386.0, 339.0, 390.0, 288.0, 374.0, 320.0, 300.0, 376.0, 221.0, 332.0, 353.0, 284.0, 331.0, 295.0, 391.0, 307.0, 338.0, 394.0, 343.0, 319.0, 281.0, 349.0, 307.0, 312.0, 376.0, 379.0, 351.0, 314.0, 355.0, 363.0, 368.0, 355.0, 330.0, 273.0, 295.0, 337.0, 358.0, 335.0, 352.0, 353.0, 382.0, 361.0, 354.0, 343.0, 269.0, 269.0, 378.0, 340.0, 318.0, 387.0, 371.0, 325.0, 327.0, 283.0, 332.0, 415.0, 237.0, 324.0, 332.0, 388.0, 314.0, 360.0, 400.0, 288.0, 341.0, 352.0, 330.0, 400.0, 324.0, 384.0, 356.0, 318.0, 408.0, 382.0, 317.0, 214.0, 311.0, 345.0, 366.0, 401.0, 316.0, 314.0, 333.0, 337.0, 308.0, 314.0, 358.0, 360.0, 299.0, 283.0, 323.0, 345.0, 346.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1160644849063841, "mean_inference_ms": 0.7628861644659211, "mean_action_processing_ms": 0.039540555295132285, "mean_env_wait_ms": 0.11473168698825574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008479833602905273, "StateBufferConnector_ms": 0.0014159679412841797, "ViewRequirementAgentConnector_ms": 0.0322878360748291}, "num_episodes": 40, "episode_return_max": 415.0, "episode_return_min": 214.0, "episode_return_mean": 335.2}, "episode_reward_max": 415.0, "episode_reward_min": 214.0, "episode_reward_mean": 335.2, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [366.0, 223.0, 379.0, 341.0, 253.0, 317.0, 335.0, 386.0, 339.0, 390.0, 288.0, 374.0, 320.0, 300.0, 376.0, 221.0, 332.0, 353.0, 284.0, 331.0, 295.0, 391.0, 307.0, 338.0, 394.0, 343.0, 319.0, 281.0, 349.0, 307.0, 312.0, 376.0, 379.0, 351.0, 314.0, 355.0, 363.0, 368.0, 355.0, 330.0, 273.0, 295.0, 337.0, 358.0, 335.0, 352.0, 353.0, 382.0, 361.0, 354.0, 343.0, 269.0, 269.0, 378.0, 340.0, 318.0, 387.0, 371.0, 325.0, 327.0, 283.0, 332.0, 415.0, 237.0, 324.0, 332.0, 388.0, 314.0, 360.0, 400.0, 288.0, 341.0, 352.0, 330.0, 400.0, 324.0, 384.0, 356.0, 318.0, 408.0, 382.0, 317.0, 214.0, 311.0, 345.0, 366.0, 401.0, 316.0, 314.0, 333.0, 337.0, 308.0, 314.0, 358.0, 360.0, 299.0, 283.0, 323.0, 345.0, 346.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1160644849063841, "mean_inference_ms": 0.7628861644659211, "mean_action_processing_ms": 0.039540555295132285, "mean_env_wait_ms": 0.11473168698825574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008479833602905273, "StateBufferConnector_ms": 0.0014159679412841797, "ViewRequirementAgentConnector_ms": 0.0322878360748291}, "num_episodes": 40, "episode_return_max": 415.0, "episode_return_min": 214.0, "episode_return_mean": 335.2, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 419.0515459735739, "num_env_steps_trained_throughput_per_sec": 419.0515459735739, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 9040.338, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9040.246, "sample_time_ms": 4153.242, "load_time_ms": 3.455, "load_throughput": 1157748.02, "learn_time_ms": 4882.716, "learn_throughput": 819.216, "synch_weights_time_ms": 0.03}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 320, "training_iteration": 8, "trial_id": "default", "date": "2024-05-19_18-15-50", "timestamp": 1716167750, "time_this_iter_s": 9.547218799591064, "time_total_s": 72.33623957633972, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyBaselineCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 72.33623957633972, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 39.75714285714286, "ram_util_percent": 84.85714285714288}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.515704502982478, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0, "total_loss": 9.92129405852287, "policy_loss": -0.010731423544066568, "vf_loss": 9.932025447968513, "vf_explained_var": -4.379980025752898e-06, "kl": 9.79852464847334e-10, "entropy": 2.079428034444009, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 415.0, "episode_reward_min": 214.0, "episode_reward_mean": 331.92, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [273.0, 295.0, 337.0, 358.0, 335.0, 352.0, 353.0, 382.0, 361.0, 354.0, 343.0, 269.0, 269.0, 378.0, 340.0, 318.0, 387.0, 371.0, 325.0, 327.0, 283.0, 332.0, 415.0, 237.0, 324.0, 332.0, 388.0, 314.0, 360.0, 400.0, 288.0, 341.0, 352.0, 330.0, 400.0, 324.0, 384.0, 356.0, 318.0, 408.0, 382.0, 317.0, 214.0, 311.0, 345.0, 366.0, 401.0, 316.0, 314.0, 333.0, 337.0, 308.0, 314.0, 358.0, 360.0, 299.0, 283.0, 323.0, 345.0, 346.0, 344.0, 381.0, 381.0, 361.0, 381.0, 327.0, 297.0, 333.0, 361.0, 295.0, 390.0, 313.0, 292.0, 377.0, 294.0, 345.0, 329.0, 230.0, 343.0, 362.0, 366.0, 246.0, 279.0, 274.0, 280.0, 335.0, 220.0, 323.0, 284.0, 317.0, 405.0, 345.0, 404.0, 297.0, 318.0, 349.0, 368.0, 358.0, 240.0, 263.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11558439251289915, "mean_inference_ms": 0.7602166463767737, "mean_action_processing_ms": 0.03929793022378915, "mean_env_wait_ms": 0.11416285256766137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008381128311157227, "StateBufferConnector_ms": 0.0014503002166748047, "ViewRequirementAgentConnector_ms": 0.031896352767944336}, "num_episodes": 40, "episode_return_max": 415.0, "episode_return_min": 214.0, "episode_return_mean": 331.92}, "env_runner_results": {"episode_reward_max": 415.0, "episode_reward_min": 214.0, "episode_reward_mean": 331.92, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [273.0, 295.0, 337.0, 358.0, 335.0, 352.0, 353.0, 382.0, 361.0, 354.0, 343.0, 269.0, 269.0, 378.0, 340.0, 318.0, 387.0, 371.0, 325.0, 327.0, 283.0, 332.0, 415.0, 237.0, 324.0, 332.0, 388.0, 314.0, 360.0, 400.0, 288.0, 341.0, 352.0, 330.0, 400.0, 324.0, 384.0, 356.0, 318.0, 408.0, 382.0, 317.0, 214.0, 311.0, 345.0, 366.0, 401.0, 316.0, 314.0, 333.0, 337.0, 308.0, 314.0, 358.0, 360.0, 299.0, 283.0, 323.0, 345.0, 346.0, 344.0, 381.0, 381.0, 361.0, 381.0, 327.0, 297.0, 333.0, 361.0, 295.0, 390.0, 313.0, 292.0, 377.0, 294.0, 345.0, 329.0, 230.0, 343.0, 362.0, 366.0, 246.0, 279.0, 274.0, 280.0, 335.0, 220.0, 323.0, 284.0, 317.0, 405.0, 345.0, 404.0, 297.0, 318.0, 349.0, 368.0, 358.0, 240.0, 263.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11558439251289915, "mean_inference_ms": 0.7602166463767737, "mean_action_processing_ms": 0.03929793022378915, "mean_env_wait_ms": 0.11416285256766137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008381128311157227, "StateBufferConnector_ms": 0.0014503002166748047, "ViewRequirementAgentConnector_ms": 0.031896352767944336}, "num_episodes": 40, "episode_return_max": 415.0, "episode_return_min": 214.0, "episode_return_mean": 331.92}, "episode_reward_max": 415.0, "episode_reward_min": 214.0, "episode_reward_mean": 331.92, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [273.0, 295.0, 337.0, 358.0, 335.0, 352.0, 353.0, 382.0, 361.0, 354.0, 343.0, 269.0, 269.0, 378.0, 340.0, 318.0, 387.0, 371.0, 325.0, 327.0, 283.0, 332.0, 415.0, 237.0, 324.0, 332.0, 388.0, 314.0, 360.0, 400.0, 288.0, 341.0, 352.0, 330.0, 400.0, 324.0, 384.0, 356.0, 318.0, 408.0, 382.0, 317.0, 214.0, 311.0, 345.0, 366.0, 401.0, 316.0, 314.0, 333.0, 337.0, 308.0, 314.0, 358.0, 360.0, 299.0, 283.0, 323.0, 345.0, 346.0, 344.0, 381.0, 381.0, 361.0, 381.0, 327.0, 297.0, 333.0, 361.0, 295.0, 390.0, 313.0, 292.0, 377.0, 294.0, 345.0, 329.0, 230.0, 343.0, 362.0, 366.0, 246.0, 279.0, 274.0, 280.0, 335.0, 220.0, 323.0, 284.0, 317.0, 405.0, 345.0, 404.0, 297.0, 318.0, 349.0, 368.0, 358.0, 240.0, 263.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11558439251289915, "mean_inference_ms": 0.7602166463767737, "mean_action_processing_ms": 0.03929793022378915, "mean_env_wait_ms": 0.11416285256766137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008381128311157227, "StateBufferConnector_ms": 0.0014503002166748047, "ViewRequirementAgentConnector_ms": 0.031896352767944336}, "num_episodes": 40, "episode_return_max": 415.0, "episode_return_min": 214.0, "episode_return_mean": 331.92, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 472.0602297992364, "num_env_steps_trained_throughput_per_sec": 472.0602297992364, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 8977.358, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8977.268, "sample_time_ms": 4129.925, "load_time_ms": 3.267, "load_throughput": 1224286.639, "learn_time_ms": 4843.275, "learn_throughput": 825.887, "synch_weights_time_ms": 0.03}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 360, "training_iteration": 9, "trial_id": "default", "date": "2024-05-19_18-15-59", "timestamp": 1716167759, "time_this_iter_s": 8.474303960800171, "time_total_s": 80.81054353713989, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyBaselineCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 80.81054353713989, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 31.958333333333332, "ram_util_percent": 83.24166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6402350010410431, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0, "total_loss": 9.933822170380623, "policy_loss": -0.00717216365099434, "vf_loss": 9.940994447277438, "vf_explained_var": 1.392056865076865e-06, "kl": -1.6194422863645375e-10, "entropy": 2.07942795753479, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 408.0, "episode_reward_min": 214.0, "episode_reward_mean": 325.77, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [382.0, 317.0, 214.0, 311.0, 345.0, 366.0, 401.0, 316.0, 314.0, 333.0, 337.0, 308.0, 314.0, 358.0, 360.0, 299.0, 283.0, 323.0, 345.0, 346.0, 344.0, 381.0, 381.0, 361.0, 381.0, 327.0, 297.0, 333.0, 361.0, 295.0, 390.0, 313.0, 292.0, 377.0, 294.0, 345.0, 329.0, 230.0, 343.0, 362.0, 366.0, 246.0, 279.0, 274.0, 280.0, 335.0, 220.0, 323.0, 284.0, 317.0, 405.0, 345.0, 404.0, 297.0, 318.0, 349.0, 368.0, 358.0, 240.0, 263.0, 303.0, 315.0, 324.0, 328.0, 370.0, 293.0, 364.0, 346.0, 291.0, 332.0, 327.0, 274.0, 244.0, 277.0, 337.0, 325.0, 306.0, 408.0, 271.0, 397.0, 276.0, 314.0, 333.0, 318.0, 298.0, 356.0, 313.0, 344.0, 317.0, 391.0, 330.0, 377.0, 326.0, 287.0, 358.0, 314.0, 344.0, 282.0, 358.0, 330.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11497563899350162, "mean_inference_ms": 0.7561283102130816, "mean_action_processing_ms": 0.03903610348770501, "mean_env_wait_ms": 0.11352719552137948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008474111557006836, "StateBufferConnector_ms": 0.0014772415161132812, "ViewRequirementAgentConnector_ms": 0.03189969062805176}, "num_episodes": 40, "episode_return_max": 408.0, "episode_return_min": 214.0, "episode_return_mean": 325.77}, "env_runner_results": {"episode_reward_max": 408.0, "episode_reward_min": 214.0, "episode_reward_mean": 325.77, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [382.0, 317.0, 214.0, 311.0, 345.0, 366.0, 401.0, 316.0, 314.0, 333.0, 337.0, 308.0, 314.0, 358.0, 360.0, 299.0, 283.0, 323.0, 345.0, 346.0, 344.0, 381.0, 381.0, 361.0, 381.0, 327.0, 297.0, 333.0, 361.0, 295.0, 390.0, 313.0, 292.0, 377.0, 294.0, 345.0, 329.0, 230.0, 343.0, 362.0, 366.0, 246.0, 279.0, 274.0, 280.0, 335.0, 220.0, 323.0, 284.0, 317.0, 405.0, 345.0, 404.0, 297.0, 318.0, 349.0, 368.0, 358.0, 240.0, 263.0, 303.0, 315.0, 324.0, 328.0, 370.0, 293.0, 364.0, 346.0, 291.0, 332.0, 327.0, 274.0, 244.0, 277.0, 337.0, 325.0, 306.0, 408.0, 271.0, 397.0, 276.0, 314.0, 333.0, 318.0, 298.0, 356.0, 313.0, 344.0, 317.0, 391.0, 330.0, 377.0, 326.0, 287.0, 358.0, 314.0, 344.0, 282.0, 358.0, 330.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11497563899350162, "mean_inference_ms": 0.7561283102130816, "mean_action_processing_ms": 0.03903610348770501, "mean_env_wait_ms": 0.11352719552137948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008474111557006836, "StateBufferConnector_ms": 0.0014772415161132812, "ViewRequirementAgentConnector_ms": 0.03189969062805176}, "num_episodes": 40, "episode_return_max": 408.0, "episode_return_min": 214.0, "episode_return_mean": 325.77}, "episode_reward_max": 408.0, "episode_reward_min": 214.0, "episode_reward_mean": 325.77, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [382.0, 317.0, 214.0, 311.0, 345.0, 366.0, 401.0, 316.0, 314.0, 333.0, 337.0, 308.0, 314.0, 358.0, 360.0, 299.0, 283.0, 323.0, 345.0, 346.0, 344.0, 381.0, 381.0, 361.0, 381.0, 327.0, 297.0, 333.0, 361.0, 295.0, 390.0, 313.0, 292.0, 377.0, 294.0, 345.0, 329.0, 230.0, 343.0, 362.0, 366.0, 246.0, 279.0, 274.0, 280.0, 335.0, 220.0, 323.0, 284.0, 317.0, 405.0, 345.0, 404.0, 297.0, 318.0, 349.0, 368.0, 358.0, 240.0, 263.0, 303.0, 315.0, 324.0, 328.0, 370.0, 293.0, 364.0, 346.0, 291.0, 332.0, 327.0, 274.0, 244.0, 277.0, 337.0, 325.0, 306.0, 408.0, 271.0, 397.0, 276.0, 314.0, 333.0, 318.0, 298.0, 356.0, 313.0, 344.0, 317.0, 391.0, 330.0, 377.0, 326.0, 287.0, 358.0, 314.0, 344.0, 282.0, 358.0, 330.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11497563899350162, "mean_inference_ms": 0.7561283102130816, "mean_action_processing_ms": 0.03903610348770501, "mean_env_wait_ms": 0.11352719552137948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008474111557006836, "StateBufferConnector_ms": 0.0014772415161132812, "ViewRequirementAgentConnector_ms": 0.03189969062805176}, "num_episodes": 40, "episode_return_max": 408.0, "episode_return_min": 214.0, "episode_return_mean": 325.77, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.7052520400857, "num_env_steps_trained_throughput_per_sec": 500.7052520400857, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 8878.497, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8878.409, "sample_time_ms": 4089.469, "load_time_ms": 3.135, "load_throughput": 1275960.057, "learn_time_ms": 4785.034, "learn_throughput": 835.94, "synch_weights_time_ms": 0.03}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 400, "training_iteration": 10, "trial_id": "default", "date": "2024-05-19_18-16-07", "timestamp": 1716167767, "time_this_iter_s": 7.98950719833374, "time_total_s": 88.80005073547363, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyBaselineCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 88.80005073547363, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 30.018181818181823, "ram_util_percent": 83.43636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5989781368163325, "cur_kl_coeff": 0.00019531250000000004, "cur_lr": 0.0, "total_loss": 9.907706076099027, "policy_loss": -0.007780559976855593, "vf_loss": 9.915486735682334, "vf_explained_var": -5.362495299308531e-06, "kl": -4.765563123332675e-10, "entropy": 2.079428549735777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 418.0, "episode_reward_min": 218.0, "episode_reward_mean": 321.1, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.0, 246.0, 279.0, 274.0, 280.0, 335.0, 220.0, 323.0, 284.0, 317.0, 405.0, 345.0, 404.0, 297.0, 318.0, 349.0, 368.0, 358.0, 240.0, 263.0, 303.0, 315.0, 324.0, 328.0, 370.0, 293.0, 364.0, 346.0, 291.0, 332.0, 327.0, 274.0, 244.0, 277.0, 337.0, 325.0, 306.0, 408.0, 271.0, 397.0, 276.0, 314.0, 333.0, 318.0, 298.0, 356.0, 313.0, 344.0, 317.0, 391.0, 330.0, 377.0, 326.0, 287.0, 358.0, 314.0, 344.0, 282.0, 358.0, 330.0, 362.0, 235.0, 365.0, 343.0, 326.0, 304.0, 408.0, 372.0, 308.0, 372.0, 273.0, 350.0, 404.0, 387.0, 295.0, 290.0, 248.0, 364.0, 295.0, 286.0, 418.0, 318.0, 292.0, 330.0, 267.0, 326.0, 343.0, 378.0, 298.0, 325.0, 281.0, 322.0, 289.0, 285.0, 329.0, 218.0, 311.0, 324.0, 260.0, 340.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11414218015575858, "mean_inference_ms": 0.7503935637868148, "mean_action_processing_ms": 0.03873960152648325, "mean_env_wait_ms": 0.11280586835893264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00794839859008789, "StateBufferConnector_ms": 0.0014188289642333984, "ViewRequirementAgentConnector_ms": 0.031395673751831055}, "num_episodes": 40, "episode_return_max": 418.0, "episode_return_min": 218.0, "episode_return_mean": 321.1}, "env_runner_results": {"episode_reward_max": 418.0, "episode_reward_min": 218.0, "episode_reward_mean": 321.1, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.0, 246.0, 279.0, 274.0, 280.0, 335.0, 220.0, 323.0, 284.0, 317.0, 405.0, 345.0, 404.0, 297.0, 318.0, 349.0, 368.0, 358.0, 240.0, 263.0, 303.0, 315.0, 324.0, 328.0, 370.0, 293.0, 364.0, 346.0, 291.0, 332.0, 327.0, 274.0, 244.0, 277.0, 337.0, 325.0, 306.0, 408.0, 271.0, 397.0, 276.0, 314.0, 333.0, 318.0, 298.0, 356.0, 313.0, 344.0, 317.0, 391.0, 330.0, 377.0, 326.0, 287.0, 358.0, 314.0, 344.0, 282.0, 358.0, 330.0, 362.0, 235.0, 365.0, 343.0, 326.0, 304.0, 408.0, 372.0, 308.0, 372.0, 273.0, 350.0, 404.0, 387.0, 295.0, 290.0, 248.0, 364.0, 295.0, 286.0, 418.0, 318.0, 292.0, 330.0, 267.0, 326.0, 343.0, 378.0, 298.0, 325.0, 281.0, 322.0, 289.0, 285.0, 329.0, 218.0, 311.0, 324.0, 260.0, 340.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11414218015575858, "mean_inference_ms": 0.7503935637868148, "mean_action_processing_ms": 0.03873960152648325, "mean_env_wait_ms": 0.11280586835893264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00794839859008789, "StateBufferConnector_ms": 0.0014188289642333984, "ViewRequirementAgentConnector_ms": 0.031395673751831055}, "num_episodes": 40, "episode_return_max": 418.0, "episode_return_min": 218.0, "episode_return_mean": 321.1}, "episode_reward_max": 418.0, "episode_reward_min": 218.0, "episode_reward_mean": 321.1, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [366.0, 246.0, 279.0, 274.0, 280.0, 335.0, 220.0, 323.0, 284.0, 317.0, 405.0, 345.0, 404.0, 297.0, 318.0, 349.0, 368.0, 358.0, 240.0, 263.0, 303.0, 315.0, 324.0, 328.0, 370.0, 293.0, 364.0, 346.0, 291.0, 332.0, 327.0, 274.0, 244.0, 277.0, 337.0, 325.0, 306.0, 408.0, 271.0, 397.0, 276.0, 314.0, 333.0, 318.0, 298.0, 356.0, 313.0, 344.0, 317.0, 391.0, 330.0, 377.0, 326.0, 287.0, 358.0, 314.0, 344.0, 282.0, 358.0, 330.0, 362.0, 235.0, 365.0, 343.0, 326.0, 304.0, 408.0, 372.0, 308.0, 372.0, 273.0, 350.0, 404.0, 387.0, 295.0, 290.0, 248.0, 364.0, 295.0, 286.0, 418.0, 318.0, 292.0, 330.0, 267.0, 326.0, 343.0, 378.0, 298.0, 325.0, 281.0, 322.0, 289.0, 285.0, 329.0, 218.0, 311.0, 324.0, 260.0, 340.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11414218015575858, "mean_inference_ms": 0.7503935637868148, "mean_action_processing_ms": 0.03873960152648325, "mean_env_wait_ms": 0.11280586835893264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00794839859008789, "StateBufferConnector_ms": 0.0014188289642333984, "ViewRequirementAgentConnector_ms": 0.031395673751831055}, "num_episodes": 40, "episode_return_max": 418.0, "episode_return_min": 218.0, "episode_return_mean": 321.1, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 470.6921130221103, "num_env_steps_trained_throughput_per_sec": 470.6921130221103, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 8817.683, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8817.565, "sample_time_ms": 4027.543, "load_time_ms": 3.288, "load_throughput": 1216657.191, "learn_time_ms": 4785.721, "learn_throughput": 835.82, "synch_weights_time_ms": 0.085}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 440, "training_iteration": 11, "trial_id": "default", "date": "2024-05-19_18-16-15", "timestamp": 1716167775, "time_this_iter_s": 8.509016036987305, "time_total_s": 97.30906677246094, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyBaselineCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 97.30906677246094, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 30.74166666666667, "ram_util_percent": 84.75833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6183779451154894, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0, "total_loss": 9.932335299830283, "policy_loss": -0.008952592709852804, "vf_loss": 9.941287963621077, "vf_explained_var": -2.272667423371346e-06, "kl": -7.155230221047152e-10, "entropy": 2.0794281036623063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 418.0, "episode_reward_min": 218.0, "episode_reward_mean": 326.95, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [276.0, 314.0, 333.0, 318.0, 298.0, 356.0, 313.0, 344.0, 317.0, 391.0, 330.0, 377.0, 326.0, 287.0, 358.0, 314.0, 344.0, 282.0, 358.0, 330.0, 362.0, 235.0, 365.0, 343.0, 326.0, 304.0, 408.0, 372.0, 308.0, 372.0, 273.0, 350.0, 404.0, 387.0, 295.0, 290.0, 248.0, 364.0, 295.0, 286.0, 418.0, 318.0, 292.0, 330.0, 267.0, 326.0, 343.0, 378.0, 298.0, 325.0, 281.0, 322.0, 289.0, 285.0, 329.0, 218.0, 311.0, 324.0, 260.0, 340.0, 356.0, 368.0, 391.0, 325.0, 371.0, 390.0, 317.0, 289.0, 282.0, 349.0, 387.0, 234.0, 404.0, 307.0, 305.0, 310.0, 348.0, 349.0, 358.0, 320.0, 367.0, 377.0, 325.0, 305.0, 289.0, 273.0, 333.0, 321.0, 314.0, 315.0, 372.0, 308.0, 309.0, 290.0, 349.0, 402.0, 318.0, 325.0, 304.0, 332.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11326977020197586, "mean_inference_ms": 0.7449258306455283, "mean_action_processing_ms": 0.038475455275437144, "mean_env_wait_ms": 0.11213839059973893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007863283157348633, "StateBufferConnector_ms": 0.0014121532440185547, "ViewRequirementAgentConnector_ms": 0.031250953674316406}, "num_episodes": 40, "episode_return_max": 418.0, "episode_return_min": 218.0, "episode_return_mean": 326.95}, "env_runner_results": {"episode_reward_max": 418.0, "episode_reward_min": 218.0, "episode_reward_mean": 326.95, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [276.0, 314.0, 333.0, 318.0, 298.0, 356.0, 313.0, 344.0, 317.0, 391.0, 330.0, 377.0, 326.0, 287.0, 358.0, 314.0, 344.0, 282.0, 358.0, 330.0, 362.0, 235.0, 365.0, 343.0, 326.0, 304.0, 408.0, 372.0, 308.0, 372.0, 273.0, 350.0, 404.0, 387.0, 295.0, 290.0, 248.0, 364.0, 295.0, 286.0, 418.0, 318.0, 292.0, 330.0, 267.0, 326.0, 343.0, 378.0, 298.0, 325.0, 281.0, 322.0, 289.0, 285.0, 329.0, 218.0, 311.0, 324.0, 260.0, 340.0, 356.0, 368.0, 391.0, 325.0, 371.0, 390.0, 317.0, 289.0, 282.0, 349.0, 387.0, 234.0, 404.0, 307.0, 305.0, 310.0, 348.0, 349.0, 358.0, 320.0, 367.0, 377.0, 325.0, 305.0, 289.0, 273.0, 333.0, 321.0, 314.0, 315.0, 372.0, 308.0, 309.0, 290.0, 349.0, 402.0, 318.0, 325.0, 304.0, 332.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11326977020197586, "mean_inference_ms": 0.7449258306455283, "mean_action_processing_ms": 0.038475455275437144, "mean_env_wait_ms": 0.11213839059973893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007863283157348633, "StateBufferConnector_ms": 0.0014121532440185547, "ViewRequirementAgentConnector_ms": 0.031250953674316406}, "num_episodes": 40, "episode_return_max": 418.0, "episode_return_min": 218.0, "episode_return_mean": 326.95}, "episode_reward_max": 418.0, "episode_reward_min": 218.0, "episode_reward_mean": 326.95, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [276.0, 314.0, 333.0, 318.0, 298.0, 356.0, 313.0, 344.0, 317.0, 391.0, 330.0, 377.0, 326.0, 287.0, 358.0, 314.0, 344.0, 282.0, 358.0, 330.0, 362.0, 235.0, 365.0, 343.0, 326.0, 304.0, 408.0, 372.0, 308.0, 372.0, 273.0, 350.0, 404.0, 387.0, 295.0, 290.0, 248.0, 364.0, 295.0, 286.0, 418.0, 318.0, 292.0, 330.0, 267.0, 326.0, 343.0, 378.0, 298.0, 325.0, 281.0, 322.0, 289.0, 285.0, 329.0, 218.0, 311.0, 324.0, 260.0, 340.0, 356.0, 368.0, 391.0, 325.0, 371.0, 390.0, 317.0, 289.0, 282.0, 349.0, 387.0, 234.0, 404.0, 307.0, 305.0, 310.0, 348.0, 349.0, 358.0, 320.0, 367.0, 377.0, 325.0, 305.0, 289.0, 273.0, 333.0, 321.0, 314.0, 315.0, 372.0, 308.0, 309.0, 290.0, 349.0, 402.0, 318.0, 325.0, 304.0, 332.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11326977020197586, "mean_inference_ms": 0.7449258306455283, "mean_action_processing_ms": 0.038475455275437144, "mean_env_wait_ms": 0.11213839059973893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007863283157348633, "StateBufferConnector_ms": 0.0014121532440185547, "ViewRequirementAgentConnector_ms": 0.031250953674316406}, "num_episodes": 40, "episode_return_max": 418.0, "episode_return_min": 218.0, "episode_return_mean": 326.95, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 453.94208464069646, "num_env_steps_trained_throughput_per_sec": 453.94208464069646, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 8786.056, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8785.94, "sample_time_ms": 3957.657, "load_time_ms": 3.293, "load_throughput": 1214842.363, "learn_time_ms": 4823.977, "learn_throughput": 829.191, "synch_weights_time_ms": 0.083}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 480, "training_iteration": 12, "trial_id": "default", "date": "2024-05-19_18-16-24", "timestamp": 1716167784, "time_this_iter_s": 8.812628984451294, "time_total_s": 106.12169575691223, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyBaselineCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 106.12169575691223, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 30.26923076923077, "ram_util_percent": 85.73846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4784591986287026, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0, "total_loss": 9.934972363133584, "policy_loss": -0.01309297498195402, "vf_loss": 9.948065204005088, "vf_explained_var": -4.476116549584173e-06, "kl": -4.5542132386066833e-10, "entropy": 2.0794280113712436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 430.0, "episode_reward_min": 218.0, "episode_reward_mean": 325.22, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [418.0, 318.0, 292.0, 330.0, 267.0, 326.0, 343.0, 378.0, 298.0, 325.0, 281.0, 322.0, 289.0, 285.0, 329.0, 218.0, 311.0, 324.0, 260.0, 340.0, 356.0, 368.0, 391.0, 325.0, 371.0, 390.0, 317.0, 289.0, 282.0, 349.0, 387.0, 234.0, 404.0, 307.0, 305.0, 310.0, 348.0, 349.0, 358.0, 320.0, 367.0, 377.0, 325.0, 305.0, 289.0, 273.0, 333.0, 321.0, 314.0, 315.0, 372.0, 308.0, 309.0, 290.0, 349.0, 402.0, 318.0, 325.0, 304.0, 332.0, 354.0, 311.0, 325.0, 322.0, 296.0, 300.0, 335.0, 293.0, 269.0, 372.0, 334.0, 315.0, 403.0, 393.0, 335.0, 317.0, 279.0, 308.0, 430.0, 321.0, 247.0, 278.0, 294.0, 379.0, 346.0, 284.0, 310.0, 333.0, 324.0, 315.0, 353.0, 362.0, 355.0, 278.0, 304.0, 378.0, 274.0, 321.0, 330.0, 303.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11273763831741375, "mean_inference_ms": 0.7413867844104817, "mean_action_processing_ms": 0.03829997087329866, "mean_env_wait_ms": 0.11171783442312584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00814509391784668, "StateBufferConnector_ms": 0.0014159679412841797, "ViewRequirementAgentConnector_ms": 0.03260540962219238}, "num_episodes": 40, "episode_return_max": 430.0, "episode_return_min": 218.0, "episode_return_mean": 325.22}, "env_runner_results": {"episode_reward_max": 430.0, "episode_reward_min": 218.0, "episode_reward_mean": 325.22, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [418.0, 318.0, 292.0, 330.0, 267.0, 326.0, 343.0, 378.0, 298.0, 325.0, 281.0, 322.0, 289.0, 285.0, 329.0, 218.0, 311.0, 324.0, 260.0, 340.0, 356.0, 368.0, 391.0, 325.0, 371.0, 390.0, 317.0, 289.0, 282.0, 349.0, 387.0, 234.0, 404.0, 307.0, 305.0, 310.0, 348.0, 349.0, 358.0, 320.0, 367.0, 377.0, 325.0, 305.0, 289.0, 273.0, 333.0, 321.0, 314.0, 315.0, 372.0, 308.0, 309.0, 290.0, 349.0, 402.0, 318.0, 325.0, 304.0, 332.0, 354.0, 311.0, 325.0, 322.0, 296.0, 300.0, 335.0, 293.0, 269.0, 372.0, 334.0, 315.0, 403.0, 393.0, 335.0, 317.0, 279.0, 308.0, 430.0, 321.0, 247.0, 278.0, 294.0, 379.0, 346.0, 284.0, 310.0, 333.0, 324.0, 315.0, 353.0, 362.0, 355.0, 278.0, 304.0, 378.0, 274.0, 321.0, 330.0, 303.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11273763831741375, "mean_inference_ms": 0.7413867844104817, "mean_action_processing_ms": 0.03829997087329866, "mean_env_wait_ms": 0.11171783442312584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00814509391784668, "StateBufferConnector_ms": 0.0014159679412841797, "ViewRequirementAgentConnector_ms": 0.03260540962219238}, "num_episodes": 40, "episode_return_max": 430.0, "episode_return_min": 218.0, "episode_return_mean": 325.22}, "episode_reward_max": 430.0, "episode_reward_min": 218.0, "episode_reward_mean": 325.22, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [418.0, 318.0, 292.0, 330.0, 267.0, 326.0, 343.0, 378.0, 298.0, 325.0, 281.0, 322.0, 289.0, 285.0, 329.0, 218.0, 311.0, 324.0, 260.0, 340.0, 356.0, 368.0, 391.0, 325.0, 371.0, 390.0, 317.0, 289.0, 282.0, 349.0, 387.0, 234.0, 404.0, 307.0, 305.0, 310.0, 348.0, 349.0, 358.0, 320.0, 367.0, 377.0, 325.0, 305.0, 289.0, 273.0, 333.0, 321.0, 314.0, 315.0, 372.0, 308.0, 309.0, 290.0, 349.0, 402.0, 318.0, 325.0, 304.0, 332.0, 354.0, 311.0, 325.0, 322.0, 296.0, 300.0, 335.0, 293.0, 269.0, 372.0, 334.0, 315.0, 403.0, 393.0, 335.0, 317.0, 279.0, 308.0, 430.0, 321.0, 247.0, 278.0, 294.0, 379.0, 346.0, 284.0, 310.0, 333.0, 324.0, 315.0, 353.0, 362.0, 355.0, 278.0, 304.0, 378.0, 274.0, 321.0, 330.0, 303.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11273763831741375, "mean_inference_ms": 0.7413867844104817, "mean_action_processing_ms": 0.03829997087329866, "mean_env_wait_ms": 0.11171783442312584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00814509391784668, "StateBufferConnector_ms": 0.0014159679412841797, "ViewRequirementAgentConnector_ms": 0.03260540962219238}, "num_episodes": 40, "episode_return_max": 430.0, "episode_return_min": 218.0, "episode_return_mean": 325.22, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 448.06913053888184, "num_env_steps_trained_throughput_per_sec": 448.06913053888184, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 8822.358, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8822.24, "sample_time_ms": 3975.284, "load_time_ms": 2.905, "load_throughput": 1377168.374, "learn_time_ms": 4842.468, "learn_throughput": 826.025, "synch_weights_time_ms": 0.085}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 520, "training_iteration": 13, "trial_id": "default", "date": "2024-05-19_18-16-33", "timestamp": 1716167793, "time_this_iter_s": 8.929989099502563, "time_total_s": 115.0516848564148, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyBaselineCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 115.0516848564148, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 36.84615384615384, "ram_util_percent": 84.96153846153847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6723927547854762, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0, "total_loss": 9.901790342023295, "policy_loss": -0.007997599460424916, "vf_loss": 9.909788008659117, "vf_explained_var": 4.268461658108619e-07, "kl": 5.366553970922378e-10, "entropy": 2.0794280728986188, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 430.0, "episode_reward_min": 226.0, "episode_reward_mean": 322.45, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [367.0, 377.0, 325.0, 305.0, 289.0, 273.0, 333.0, 321.0, 314.0, 315.0, 372.0, 308.0, 309.0, 290.0, 349.0, 402.0, 318.0, 325.0, 304.0, 332.0, 354.0, 311.0, 325.0, 322.0, 296.0, 300.0, 335.0, 293.0, 269.0, 372.0, 334.0, 315.0, 403.0, 393.0, 335.0, 317.0, 279.0, 308.0, 430.0, 321.0, 247.0, 278.0, 294.0, 379.0, 346.0, 284.0, 310.0, 333.0, 324.0, 315.0, 353.0, 362.0, 355.0, 278.0, 304.0, 378.0, 274.0, 321.0, 330.0, 303.0, 317.0, 331.0, 335.0, 323.0, 311.0, 369.0, 341.0, 323.0, 297.0, 286.0, 312.0, 378.0, 303.0, 311.0, 359.0, 323.0, 304.0, 274.0, 351.0, 237.0, 226.0, 316.0, 348.0, 348.0, 288.0, 293.0, 321.0, 351.0, 284.0, 295.0, 348.0, 324.0, 282.0, 293.0, 327.0, 378.0, 344.0, 350.0, 300.0, 336.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.112486112040621, "mean_inference_ms": 0.7397452153335092, "mean_action_processing_ms": 0.03820829980409169, "mean_env_wait_ms": 0.11149916484461438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008192777633666992, "StateBufferConnector_ms": 0.0014352798461914062, "ViewRequirementAgentConnector_ms": 0.032836198806762695}, "num_episodes": 40, "episode_return_max": 430.0, "episode_return_min": 226.0, "episode_return_mean": 322.45}, "env_runner_results": {"episode_reward_max": 430.0, "episode_reward_min": 226.0, "episode_reward_mean": 322.45, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [367.0, 377.0, 325.0, 305.0, 289.0, 273.0, 333.0, 321.0, 314.0, 315.0, 372.0, 308.0, 309.0, 290.0, 349.0, 402.0, 318.0, 325.0, 304.0, 332.0, 354.0, 311.0, 325.0, 322.0, 296.0, 300.0, 335.0, 293.0, 269.0, 372.0, 334.0, 315.0, 403.0, 393.0, 335.0, 317.0, 279.0, 308.0, 430.0, 321.0, 247.0, 278.0, 294.0, 379.0, 346.0, 284.0, 310.0, 333.0, 324.0, 315.0, 353.0, 362.0, 355.0, 278.0, 304.0, 378.0, 274.0, 321.0, 330.0, 303.0, 317.0, 331.0, 335.0, 323.0, 311.0, 369.0, 341.0, 323.0, 297.0, 286.0, 312.0, 378.0, 303.0, 311.0, 359.0, 323.0, 304.0, 274.0, 351.0, 237.0, 226.0, 316.0, 348.0, 348.0, 288.0, 293.0, 321.0, 351.0, 284.0, 295.0, 348.0, 324.0, 282.0, 293.0, 327.0, 378.0, 344.0, 350.0, 300.0, 336.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.112486112040621, "mean_inference_ms": 0.7397452153335092, "mean_action_processing_ms": 0.03820829980409169, "mean_env_wait_ms": 0.11149916484461438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008192777633666992, "StateBufferConnector_ms": 0.0014352798461914062, "ViewRequirementAgentConnector_ms": 0.032836198806762695}, "num_episodes": 40, "episode_return_max": 430.0, "episode_return_min": 226.0, "episode_return_mean": 322.45}, "episode_reward_max": 430.0, "episode_reward_min": 226.0, "episode_reward_mean": 322.45, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [367.0, 377.0, 325.0, 305.0, 289.0, 273.0, 333.0, 321.0, 314.0, 315.0, 372.0, 308.0, 309.0, 290.0, 349.0, 402.0, 318.0, 325.0, 304.0, 332.0, 354.0, 311.0, 325.0, 322.0, 296.0, 300.0, 335.0, 293.0, 269.0, 372.0, 334.0, 315.0, 403.0, 393.0, 335.0, 317.0, 279.0, 308.0, 430.0, 321.0, 247.0, 278.0, 294.0, 379.0, 346.0, 284.0, 310.0, 333.0, 324.0, 315.0, 353.0, 362.0, 355.0, 278.0, 304.0, 378.0, 274.0, 321.0, 330.0, 303.0, 317.0, 331.0, 335.0, 323.0, 311.0, 369.0, 341.0, 323.0, 297.0, 286.0, 312.0, 378.0, 303.0, 311.0, 359.0, 323.0, 304.0, 274.0, 351.0, 237.0, 226.0, 316.0, 348.0, 348.0, 288.0, 293.0, 321.0, 351.0, 284.0, 295.0, 348.0, 324.0, 282.0, 293.0, 327.0, 378.0, 344.0, 350.0, 300.0, 336.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.112486112040621, "mean_inference_ms": 0.7397452153335092, "mean_action_processing_ms": 0.03820829980409169, "mean_env_wait_ms": 0.11149916484461438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008192777633666992, "StateBufferConnector_ms": 0.0014352798461914062, "ViewRequirementAgentConnector_ms": 0.032836198806762695}, "num_episodes": 40, "episode_return_max": 430.0, "episode_return_min": 226.0, "episode_return_mean": 322.45, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 480.806793557484, "num_env_steps_trained_throughput_per_sec": 480.806793557484, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 8695.743, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8695.625, "sample_time_ms": 3905.415, "load_time_ms": 1.879, "load_throughput": 2128332.065, "learn_time_ms": 4786.829, "learn_throughput": 835.626, "synch_weights_time_ms": 0.086}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 560, "training_iteration": 14, "trial_id": "default", "date": "2024-05-19_18-16-41", "timestamp": 1716167801, "time_this_iter_s": 8.320433139801025, "time_total_s": 123.37211799621582, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyBaselineCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 123.37211799621582, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 29.172727272727265, "ram_util_percent": 83.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6388190619407161, "cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 0.0, "total_loss": 9.93272602942682, "policy_loss": -0.008057871292675696, "vf_loss": 9.940783746780887, "vf_explained_var": 7.787058430333291e-07, "kl": 8.811961689010829e-10, "entropy": 2.0794284112991823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 404.0, "episode_reward_min": 168.0, "episode_reward_mean": 324.4, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [247.0, 278.0, 294.0, 379.0, 346.0, 284.0, 310.0, 333.0, 324.0, 315.0, 353.0, 362.0, 355.0, 278.0, 304.0, 378.0, 274.0, 321.0, 330.0, 303.0, 317.0, 331.0, 335.0, 323.0, 311.0, 369.0, 341.0, 323.0, 297.0, 286.0, 312.0, 378.0, 303.0, 311.0, 359.0, 323.0, 304.0, 274.0, 351.0, 237.0, 226.0, 316.0, 348.0, 348.0, 288.0, 293.0, 321.0, 351.0, 284.0, 295.0, 348.0, 324.0, 282.0, 293.0, 327.0, 378.0, 344.0, 350.0, 300.0, 336.0, 361.0, 359.0, 299.0, 392.0, 344.0, 357.0, 404.0, 355.0, 314.0, 168.0, 295.0, 365.0, 271.0, 360.0, 283.0, 279.0, 327.0, 388.0, 342.0, 389.0, 380.0, 336.0, 307.0, 280.0, 316.0, 347.0, 325.0, 353.0, 339.0, 358.0, 248.0, 361.0, 292.0, 336.0, 323.0, 402.0, 342.0, 385.0, 318.0, 335.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11216172077640806, "mean_inference_ms": 0.737820880432994, "mean_action_processing_ms": 0.038101338808124226, "mean_env_wait_ms": 0.11122116763225795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008141756057739258, "StateBufferConnector_ms": 0.0014033317565917969, "ViewRequirementAgentConnector_ms": 0.0319974422454834}, "num_episodes": 40, "episode_return_max": 404.0, "episode_return_min": 168.0, "episode_return_mean": 324.4}, "env_runner_results": {"episode_reward_max": 404.0, "episode_reward_min": 168.0, "episode_reward_mean": 324.4, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [247.0, 278.0, 294.0, 379.0, 346.0, 284.0, 310.0, 333.0, 324.0, 315.0, 353.0, 362.0, 355.0, 278.0, 304.0, 378.0, 274.0, 321.0, 330.0, 303.0, 317.0, 331.0, 335.0, 323.0, 311.0, 369.0, 341.0, 323.0, 297.0, 286.0, 312.0, 378.0, 303.0, 311.0, 359.0, 323.0, 304.0, 274.0, 351.0, 237.0, 226.0, 316.0, 348.0, 348.0, 288.0, 293.0, 321.0, 351.0, 284.0, 295.0, 348.0, 324.0, 282.0, 293.0, 327.0, 378.0, 344.0, 350.0, 300.0, 336.0, 361.0, 359.0, 299.0, 392.0, 344.0, 357.0, 404.0, 355.0, 314.0, 168.0, 295.0, 365.0, 271.0, 360.0, 283.0, 279.0, 327.0, 388.0, 342.0, 389.0, 380.0, 336.0, 307.0, 280.0, 316.0, 347.0, 325.0, 353.0, 339.0, 358.0, 248.0, 361.0, 292.0, 336.0, 323.0, 402.0, 342.0, 385.0, 318.0, 335.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11216172077640806, "mean_inference_ms": 0.737820880432994, "mean_action_processing_ms": 0.038101338808124226, "mean_env_wait_ms": 0.11122116763225795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008141756057739258, "StateBufferConnector_ms": 0.0014033317565917969, "ViewRequirementAgentConnector_ms": 0.0319974422454834}, "num_episodes": 40, "episode_return_max": 404.0, "episode_return_min": 168.0, "episode_return_mean": 324.4}, "episode_reward_max": 404.0, "episode_reward_min": 168.0, "episode_reward_mean": 324.4, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [247.0, 278.0, 294.0, 379.0, 346.0, 284.0, 310.0, 333.0, 324.0, 315.0, 353.0, 362.0, 355.0, 278.0, 304.0, 378.0, 274.0, 321.0, 330.0, 303.0, 317.0, 331.0, 335.0, 323.0, 311.0, 369.0, 341.0, 323.0, 297.0, 286.0, 312.0, 378.0, 303.0, 311.0, 359.0, 323.0, 304.0, 274.0, 351.0, 237.0, 226.0, 316.0, 348.0, 348.0, 288.0, 293.0, 321.0, 351.0, 284.0, 295.0, 348.0, 324.0, 282.0, 293.0, 327.0, 378.0, 344.0, 350.0, 300.0, 336.0, 361.0, 359.0, 299.0, 392.0, 344.0, 357.0, 404.0, 355.0, 314.0, 168.0, 295.0, 365.0, 271.0, 360.0, 283.0, 279.0, 327.0, 388.0, 342.0, 389.0, 380.0, 336.0, 307.0, 280.0, 316.0, 347.0, 325.0, 353.0, 339.0, 358.0, 248.0, 361.0, 292.0, 336.0, 323.0, 402.0, 342.0, 385.0, 318.0, 335.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11216172077640806, "mean_inference_ms": 0.737820880432994, "mean_action_processing_ms": 0.038101338808124226, "mean_env_wait_ms": 0.11122116763225795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008141756057739258, "StateBufferConnector_ms": 0.0014033317565917969, "ViewRequirementAgentConnector_ms": 0.0319974422454834}, "num_episodes": 40, "episode_return_max": 404.0, "episode_return_min": 168.0, "episode_return_mean": 324.4, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.5122843545668, "num_env_steps_trained_throughput_per_sec": 499.5122843545668, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 8612.556, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8612.443, "sample_time_ms": 3895.229, "load_time_ms": 1.885, "load_throughput": 2122113.358, "learn_time_ms": 4713.869, "learn_throughput": 848.56, "synch_weights_time_ms": 0.083}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 600, "training_iteration": 15, "trial_id": "default", "date": "2024-05-19_18-16-49", "timestamp": 1716167809, "time_this_iter_s": 8.008506774902344, "time_total_s": 131.38062477111816, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyBaselineCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 131.38062477111816, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 26.816666666666674, "ram_util_percent": 82.59166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5558327551810973, "cur_kl_coeff": 6.103515625000001e-06, "cur_lr": 0.0, "total_loss": 9.933971866484612, "policy_loss": -0.008166735526174307, "vf_loss": 9.942138487292874, "vf_explained_var": -5.9123962156234246e-06, "kl": -7.13978701429791e-11, "entropy": 2.0794279421529462, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 433.0, "episode_reward_min": 168.0, "episode_reward_mean": 328.77, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [226.0, 316.0, 348.0, 348.0, 288.0, 293.0, 321.0, 351.0, 284.0, 295.0, 348.0, 324.0, 282.0, 293.0, 327.0, 378.0, 344.0, 350.0, 300.0, 336.0, 361.0, 359.0, 299.0, 392.0, 344.0, 357.0, 404.0, 355.0, 314.0, 168.0, 295.0, 365.0, 271.0, 360.0, 283.0, 279.0, 327.0, 388.0, 342.0, 389.0, 380.0, 336.0, 307.0, 280.0, 316.0, 347.0, 325.0, 353.0, 339.0, 358.0, 248.0, 361.0, 292.0, 336.0, 323.0, 402.0, 342.0, 385.0, 318.0, 335.0, 255.0, 358.0, 309.0, 375.0, 296.0, 315.0, 375.0, 354.0, 375.0, 321.0, 362.0, 381.0, 319.0, 356.0, 279.0, 255.0, 295.0, 377.0, 305.0, 310.0, 308.0, 311.0, 433.0, 408.0, 307.0, 267.0, 263.0, 378.0, 366.0, 355.0, 318.0, 376.0, 356.0, 361.0, 330.0, 288.0, 269.0, 335.0, 248.0, 341.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11179089714722715, "mean_inference_ms": 0.7355301032197994, "mean_action_processing_ms": 0.03798809968416484, "mean_env_wait_ms": 0.11089713893516034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007712602615356445, "StateBufferConnector_ms": 0.0013577938079833984, "ViewRequirementAgentConnector_ms": 0.030842065811157227}, "num_episodes": 40, "episode_return_max": 433.0, "episode_return_min": 168.0, "episode_return_mean": 328.77}, "env_runner_results": {"episode_reward_max": 433.0, "episode_reward_min": 168.0, "episode_reward_mean": 328.77, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [226.0, 316.0, 348.0, 348.0, 288.0, 293.0, 321.0, 351.0, 284.0, 295.0, 348.0, 324.0, 282.0, 293.0, 327.0, 378.0, 344.0, 350.0, 300.0, 336.0, 361.0, 359.0, 299.0, 392.0, 344.0, 357.0, 404.0, 355.0, 314.0, 168.0, 295.0, 365.0, 271.0, 360.0, 283.0, 279.0, 327.0, 388.0, 342.0, 389.0, 380.0, 336.0, 307.0, 280.0, 316.0, 347.0, 325.0, 353.0, 339.0, 358.0, 248.0, 361.0, 292.0, 336.0, 323.0, 402.0, 342.0, 385.0, 318.0, 335.0, 255.0, 358.0, 309.0, 375.0, 296.0, 315.0, 375.0, 354.0, 375.0, 321.0, 362.0, 381.0, 319.0, 356.0, 279.0, 255.0, 295.0, 377.0, 305.0, 310.0, 308.0, 311.0, 433.0, 408.0, 307.0, 267.0, 263.0, 378.0, 366.0, 355.0, 318.0, 376.0, 356.0, 361.0, 330.0, 288.0, 269.0, 335.0, 248.0, 341.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11179089714722715, "mean_inference_ms": 0.7355301032197994, "mean_action_processing_ms": 0.03798809968416484, "mean_env_wait_ms": 0.11089713893516034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007712602615356445, "StateBufferConnector_ms": 0.0013577938079833984, "ViewRequirementAgentConnector_ms": 0.030842065811157227}, "num_episodes": 40, "episode_return_max": 433.0, "episode_return_min": 168.0, "episode_return_mean": 328.77}, "episode_reward_max": 433.0, "episode_reward_min": 168.0, "episode_reward_mean": 328.77, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [226.0, 316.0, 348.0, 348.0, 288.0, 293.0, 321.0, 351.0, 284.0, 295.0, 348.0, 324.0, 282.0, 293.0, 327.0, 378.0, 344.0, 350.0, 300.0, 336.0, 361.0, 359.0, 299.0, 392.0, 344.0, 357.0, 404.0, 355.0, 314.0, 168.0, 295.0, 365.0, 271.0, 360.0, 283.0, 279.0, 327.0, 388.0, 342.0, 389.0, 380.0, 336.0, 307.0, 280.0, 316.0, 347.0, 325.0, 353.0, 339.0, 358.0, 248.0, 361.0, 292.0, 336.0, 323.0, 402.0, 342.0, 385.0, 318.0, 335.0, 255.0, 358.0, 309.0, 375.0, 296.0, 315.0, 375.0, 354.0, 375.0, 321.0, 362.0, 381.0, 319.0, 356.0, 279.0, 255.0, 295.0, 377.0, 305.0, 310.0, 308.0, 311.0, 433.0, 408.0, 307.0, 267.0, 263.0, 378.0, 366.0, 355.0, 318.0, 376.0, 356.0, 361.0, 330.0, 288.0, 269.0, 335.0, 248.0, 341.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11179089714722715, "mean_inference_ms": 0.7355301032197994, "mean_action_processing_ms": 0.03798809968416484, "mean_env_wait_ms": 0.11089713893516034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007712602615356445, "StateBufferConnector_ms": 0.0013577938079833984, "ViewRequirementAgentConnector_ms": 0.030842065811157227}, "num_episodes": 40, "episode_return_max": 433.0, "episode_return_min": 168.0, "episode_return_mean": 328.77, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 492.1184766212121, "num_env_steps_trained_throughput_per_sec": 492.1184766212121, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 8544.089, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8543.983, "sample_time_ms": 3874.044, "load_time_ms": 1.802, "load_throughput": 2220001.323, "learn_time_ms": 4666.763, "learn_throughput": 857.125, "synch_weights_time_ms": 0.08}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 640, "training_iteration": 16, "trial_id": "default", "date": "2024-05-19_18-16-57", "timestamp": 1716167817, "time_this_iter_s": 8.128772258758545, "time_total_s": 139.5093970298767, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyBaselineCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 139.5093970298767, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 27.254545454545454, "ram_util_percent": 83.20909090909089}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5503439211076306, "cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 0.0, "total_loss": 9.93027723989179, "policy_loss": -0.006658717464174955, "vf_loss": 9.936935978551064, "vf_explained_var": -1.167097399311681e-06, "kl": 6.503747450986406e-10, "entropy": 2.079428272862588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 433.0, "episode_reward_min": 213.0, "episode_reward_mean": 321.81, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.0, 336.0, 307.0, 280.0, 316.0, 347.0, 325.0, 353.0, 339.0, 358.0, 248.0, 361.0, 292.0, 336.0, 323.0, 402.0, 342.0, 385.0, 318.0, 335.0, 255.0, 358.0, 309.0, 375.0, 296.0, 315.0, 375.0, 354.0, 375.0, 321.0, 362.0, 381.0, 319.0, 356.0, 279.0, 255.0, 295.0, 377.0, 305.0, 310.0, 308.0, 311.0, 433.0, 408.0, 307.0, 267.0, 263.0, 378.0, 366.0, 355.0, 318.0, 376.0, 356.0, 361.0, 330.0, 288.0, 269.0, 335.0, 248.0, 341.0, 305.0, 344.0, 298.0, 307.0, 350.0, 294.0, 311.0, 275.0, 346.0, 276.0, 295.0, 275.0, 270.0, 229.0, 348.0, 295.0, 284.0, 265.0, 345.0, 309.0, 213.0, 279.0, 428.0, 343.0, 248.0, 278.0, 359.0, 322.0, 327.0, 355.0, 310.0, 350.0, 368.0, 391.0, 325.0, 294.0, 227.0, 304.0, 263.0, 303.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11133864022716343, "mean_inference_ms": 0.7327691730977847, "mean_action_processing_ms": 0.03785311209863304, "mean_env_wait_ms": 0.11053131122172864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007652759552001953, "StateBufferConnector_ms": 0.0013492107391357422, "ViewRequirementAgentConnector_ms": 0.030742168426513672}, "num_episodes": 40, "episode_return_max": 433.0, "episode_return_min": 213.0, "episode_return_mean": 321.81}, "env_runner_results": {"episode_reward_max": 433.0, "episode_reward_min": 213.0, "episode_reward_mean": 321.81, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.0, 336.0, 307.0, 280.0, 316.0, 347.0, 325.0, 353.0, 339.0, 358.0, 248.0, 361.0, 292.0, 336.0, 323.0, 402.0, 342.0, 385.0, 318.0, 335.0, 255.0, 358.0, 309.0, 375.0, 296.0, 315.0, 375.0, 354.0, 375.0, 321.0, 362.0, 381.0, 319.0, 356.0, 279.0, 255.0, 295.0, 377.0, 305.0, 310.0, 308.0, 311.0, 433.0, 408.0, 307.0, 267.0, 263.0, 378.0, 366.0, 355.0, 318.0, 376.0, 356.0, 361.0, 330.0, 288.0, 269.0, 335.0, 248.0, 341.0, 305.0, 344.0, 298.0, 307.0, 350.0, 294.0, 311.0, 275.0, 346.0, 276.0, 295.0, 275.0, 270.0, 229.0, 348.0, 295.0, 284.0, 265.0, 345.0, 309.0, 213.0, 279.0, 428.0, 343.0, 248.0, 278.0, 359.0, 322.0, 327.0, 355.0, 310.0, 350.0, 368.0, 391.0, 325.0, 294.0, 227.0, 304.0, 263.0, 303.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11133864022716343, "mean_inference_ms": 0.7327691730977847, "mean_action_processing_ms": 0.03785311209863304, "mean_env_wait_ms": 0.11053131122172864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007652759552001953, "StateBufferConnector_ms": 0.0013492107391357422, "ViewRequirementAgentConnector_ms": 0.030742168426513672}, "num_episodes": 40, "episode_return_max": 433.0, "episode_return_min": 213.0, "episode_return_mean": 321.81}, "episode_reward_max": 433.0, "episode_reward_min": 213.0, "episode_reward_mean": 321.81, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [380.0, 336.0, 307.0, 280.0, 316.0, 347.0, 325.0, 353.0, 339.0, 358.0, 248.0, 361.0, 292.0, 336.0, 323.0, 402.0, 342.0, 385.0, 318.0, 335.0, 255.0, 358.0, 309.0, 375.0, 296.0, 315.0, 375.0, 354.0, 375.0, 321.0, 362.0, 381.0, 319.0, 356.0, 279.0, 255.0, 295.0, 377.0, 305.0, 310.0, 308.0, 311.0, 433.0, 408.0, 307.0, 267.0, 263.0, 378.0, 366.0, 355.0, 318.0, 376.0, 356.0, 361.0, 330.0, 288.0, 269.0, 335.0, 248.0, 341.0, 305.0, 344.0, 298.0, 307.0, 350.0, 294.0, 311.0, 275.0, 346.0, 276.0, 295.0, 275.0, 270.0, 229.0, 348.0, 295.0, 284.0, 265.0, 345.0, 309.0, 213.0, 279.0, 428.0, 343.0, 248.0, 278.0, 359.0, 322.0, 327.0, 355.0, 310.0, 350.0, 368.0, 391.0, 325.0, 294.0, 227.0, 304.0, 263.0, 303.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11133864022716343, "mean_inference_ms": 0.7327691730977847, "mean_action_processing_ms": 0.03785311209863304, "mean_env_wait_ms": 0.11053131122172864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007652759552001953, "StateBufferConnector_ms": 0.0013492107391357422, "ViewRequirementAgentConnector_ms": 0.030742168426513672}, "num_episodes": 40, "episode_return_max": 433.0, "episode_return_min": 213.0, "episode_return_mean": 321.81, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 488.57672126869073, "num_env_steps_trained_throughput_per_sec": 488.57672126869073, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 8488.719, "restore_workers_time_ms": 0.011, "training_step_time_ms": 8488.614, "sample_time_ms": 3866.442, "load_time_ms": 1.791, "load_throughput": 2233477.908, "learn_time_ms": 4619.025, "learn_throughput": 865.984, "synch_weights_time_ms": 0.08}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 680, "training_iteration": 17, "trial_id": "default", "date": "2024-05-19_18-17-06", "timestamp": 1716167826, "time_this_iter_s": 8.187804937362671, "time_total_s": 147.69720196723938, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyBaselineCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 147.69720196723938, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 26.508333333333336, "ram_util_percent": 84.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4326231960327394, "cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 0.0, "total_loss": 9.939865143068376, "policy_loss": -0.008766698590930431, "vf_loss": 9.948631901894846, "vf_explained_var": -4.991408317319808e-06, "kl": 1.8445382765988707e-10, "entropy": 2.079427819098196, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 441.0, "episode_reward_min": 213.0, "episode_reward_mean": 319.92, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [308.0, 311.0, 433.0, 408.0, 307.0, 267.0, 263.0, 378.0, 366.0, 355.0, 318.0, 376.0, 356.0, 361.0, 330.0, 288.0, 269.0, 335.0, 248.0, 341.0, 305.0, 344.0, 298.0, 307.0, 350.0, 294.0, 311.0, 275.0, 346.0, 276.0, 295.0, 275.0, 270.0, 229.0, 348.0, 295.0, 284.0, 265.0, 345.0, 309.0, 213.0, 279.0, 428.0, 343.0, 248.0, 278.0, 359.0, 322.0, 327.0, 355.0, 310.0, 350.0, 368.0, 391.0, 325.0, 294.0, 227.0, 304.0, 263.0, 303.0, 398.0, 299.0, 284.0, 278.0, 313.0, 276.0, 381.0, 320.0, 265.0, 441.0, 270.0, 325.0, 358.0, 338.0, 331.0, 349.0, 290.0, 372.0, 262.0, 313.0, 287.0, 345.0, 334.0, 344.0, 371.0, 261.0, 321.0, 394.0, 289.0, 369.0, 284.0, 290.0, 313.0, 386.0, 348.0, 377.0, 259.0, 340.0, 314.0, 377.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11089701280295766, "mean_inference_ms": 0.7299742829602675, "mean_action_processing_ms": 0.037708510030427876, "mean_env_wait_ms": 0.11016384847723495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007613658905029297, "StateBufferConnector_ms": 0.0013420581817626953, "ViewRequirementAgentConnector_ms": 0.030688047409057617}, "num_episodes": 40, "episode_return_max": 441.0, "episode_return_min": 213.0, "episode_return_mean": 319.92}, "env_runner_results": {"episode_reward_max": 441.0, "episode_reward_min": 213.0, "episode_reward_mean": 319.92, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [308.0, 311.0, 433.0, 408.0, 307.0, 267.0, 263.0, 378.0, 366.0, 355.0, 318.0, 376.0, 356.0, 361.0, 330.0, 288.0, 269.0, 335.0, 248.0, 341.0, 305.0, 344.0, 298.0, 307.0, 350.0, 294.0, 311.0, 275.0, 346.0, 276.0, 295.0, 275.0, 270.0, 229.0, 348.0, 295.0, 284.0, 265.0, 345.0, 309.0, 213.0, 279.0, 428.0, 343.0, 248.0, 278.0, 359.0, 322.0, 327.0, 355.0, 310.0, 350.0, 368.0, 391.0, 325.0, 294.0, 227.0, 304.0, 263.0, 303.0, 398.0, 299.0, 284.0, 278.0, 313.0, 276.0, 381.0, 320.0, 265.0, 441.0, 270.0, 325.0, 358.0, 338.0, 331.0, 349.0, 290.0, 372.0, 262.0, 313.0, 287.0, 345.0, 334.0, 344.0, 371.0, 261.0, 321.0, 394.0, 289.0, 369.0, 284.0, 290.0, 313.0, 386.0, 348.0, 377.0, 259.0, 340.0, 314.0, 377.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11089701280295766, "mean_inference_ms": 0.7299742829602675, "mean_action_processing_ms": 0.037708510030427876, "mean_env_wait_ms": 0.11016384847723495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007613658905029297, "StateBufferConnector_ms": 0.0013420581817626953, "ViewRequirementAgentConnector_ms": 0.030688047409057617}, "num_episodes": 40, "episode_return_max": 441.0, "episode_return_min": 213.0, "episode_return_mean": 319.92}, "episode_reward_max": 441.0, "episode_reward_min": 213.0, "episode_reward_mean": 319.92, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [308.0, 311.0, 433.0, 408.0, 307.0, 267.0, 263.0, 378.0, 366.0, 355.0, 318.0, 376.0, 356.0, 361.0, 330.0, 288.0, 269.0, 335.0, 248.0, 341.0, 305.0, 344.0, 298.0, 307.0, 350.0, 294.0, 311.0, 275.0, 346.0, 276.0, 295.0, 275.0, 270.0, 229.0, 348.0, 295.0, 284.0, 265.0, 345.0, 309.0, 213.0, 279.0, 428.0, 343.0, 248.0, 278.0, 359.0, 322.0, 327.0, 355.0, 310.0, 350.0, 368.0, 391.0, 325.0, 294.0, 227.0, 304.0, 263.0, 303.0, 398.0, 299.0, 284.0, 278.0, 313.0, 276.0, 381.0, 320.0, 265.0, 441.0, 270.0, 325.0, 358.0, 338.0, 331.0, 349.0, 290.0, 372.0, 262.0, 313.0, 287.0, 345.0, 334.0, 344.0, 371.0, 261.0, 321.0, 394.0, 289.0, 369.0, 284.0, 290.0, 313.0, 386.0, 348.0, 377.0, 259.0, 340.0, 314.0, 377.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11089701280295766, "mean_inference_ms": 0.7299742829602675, "mean_action_processing_ms": 0.037708510030427876, "mean_env_wait_ms": 0.11016384847723495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007613658905029297, "StateBufferConnector_ms": 0.0013420581817626953, "ViewRequirementAgentConnector_ms": 0.030688047409057617}, "num_episodes": 40, "episode_return_max": 441.0, "episode_return_min": 213.0, "episode_return_mean": 319.92, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.99308067705596, "num_env_steps_trained_throughput_per_sec": 486.99308067705596, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 8355.549, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8355.445, "sample_time_ms": 3811.245, "load_time_ms": 1.618, "load_throughput": 2472546.35, "learn_time_ms": 4541.234, "learn_throughput": 880.818, "synch_weights_time_ms": 0.079}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 720, "training_iteration": 18, "trial_id": "default", "date": "2024-05-19_18-17-14", "timestamp": 1716167834, "time_this_iter_s": 8.21542501449585, "time_total_s": 155.91262698173523, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyBaselineCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 155.91262698173523, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 28.333333333333332, "ram_util_percent": 84.39166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6019389994682804, "cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 0.0, "total_loss": 9.930085028371503, "policy_loss": -0.007403297289725273, "vf_loss": 9.937488309798702, "vf_explained_var": -2.0727034538022933e-06, "kl": 5.328883839571208e-12, "entropy": 2.0794281498078377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 441.0, "episode_reward_min": 179.0, "episode_reward_mean": 323.66, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [213.0, 279.0, 428.0, 343.0, 248.0, 278.0, 359.0, 322.0, 327.0, 355.0, 310.0, 350.0, 368.0, 391.0, 325.0, 294.0, 227.0, 304.0, 263.0, 303.0, 398.0, 299.0, 284.0, 278.0, 313.0, 276.0, 381.0, 320.0, 265.0, 441.0, 270.0, 325.0, 358.0, 338.0, 331.0, 349.0, 290.0, 372.0, 262.0, 313.0, 287.0, 345.0, 334.0, 344.0, 371.0, 261.0, 321.0, 394.0, 289.0, 369.0, 284.0, 290.0, 313.0, 386.0, 348.0, 377.0, 259.0, 340.0, 314.0, 377.0, 350.0, 384.0, 269.0, 339.0, 375.0, 264.0, 351.0, 340.0, 323.0, 393.0, 386.0, 271.0, 233.0, 261.0, 301.0, 411.0, 289.0, 371.0, 308.0, 335.0, 279.0, 294.0, 331.0, 313.0, 362.0, 311.0, 323.0, 322.0, 318.0, 306.0, 362.0, 368.0, 347.0, 413.0, 412.0, 179.0, 317.0, 353.0, 246.0, 303.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11045469588185762, "mean_inference_ms": 0.7272104390280846, "mean_action_processing_ms": 0.037564154713661854, "mean_env_wait_ms": 0.10980846399639141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007640361785888672, "StateBufferConnector_ms": 0.0013654232025146484, "ViewRequirementAgentConnector_ms": 0.03060317039489746}, "num_episodes": 40, "episode_return_max": 441.0, "episode_return_min": 179.0, "episode_return_mean": 323.66}, "env_runner_results": {"episode_reward_max": 441.0, "episode_reward_min": 179.0, "episode_reward_mean": 323.66, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [213.0, 279.0, 428.0, 343.0, 248.0, 278.0, 359.0, 322.0, 327.0, 355.0, 310.0, 350.0, 368.0, 391.0, 325.0, 294.0, 227.0, 304.0, 263.0, 303.0, 398.0, 299.0, 284.0, 278.0, 313.0, 276.0, 381.0, 320.0, 265.0, 441.0, 270.0, 325.0, 358.0, 338.0, 331.0, 349.0, 290.0, 372.0, 262.0, 313.0, 287.0, 345.0, 334.0, 344.0, 371.0, 261.0, 321.0, 394.0, 289.0, 369.0, 284.0, 290.0, 313.0, 386.0, 348.0, 377.0, 259.0, 340.0, 314.0, 377.0, 350.0, 384.0, 269.0, 339.0, 375.0, 264.0, 351.0, 340.0, 323.0, 393.0, 386.0, 271.0, 233.0, 261.0, 301.0, 411.0, 289.0, 371.0, 308.0, 335.0, 279.0, 294.0, 331.0, 313.0, 362.0, 311.0, 323.0, 322.0, 318.0, 306.0, 362.0, 368.0, 347.0, 413.0, 412.0, 179.0, 317.0, 353.0, 246.0, 303.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11045469588185762, "mean_inference_ms": 0.7272104390280846, "mean_action_processing_ms": 0.037564154713661854, "mean_env_wait_ms": 0.10980846399639141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007640361785888672, "StateBufferConnector_ms": 0.0013654232025146484, "ViewRequirementAgentConnector_ms": 0.03060317039489746}, "num_episodes": 40, "episode_return_max": 441.0, "episode_return_min": 179.0, "episode_return_mean": 323.66}, "episode_reward_max": 441.0, "episode_reward_min": 179.0, "episode_reward_mean": 323.66, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [213.0, 279.0, 428.0, 343.0, 248.0, 278.0, 359.0, 322.0, 327.0, 355.0, 310.0, 350.0, 368.0, 391.0, 325.0, 294.0, 227.0, 304.0, 263.0, 303.0, 398.0, 299.0, 284.0, 278.0, 313.0, 276.0, 381.0, 320.0, 265.0, 441.0, 270.0, 325.0, 358.0, 338.0, 331.0, 349.0, 290.0, 372.0, 262.0, 313.0, 287.0, 345.0, 334.0, 344.0, 371.0, 261.0, 321.0, 394.0, 289.0, 369.0, 284.0, 290.0, 313.0, 386.0, 348.0, 377.0, 259.0, 340.0, 314.0, 377.0, 350.0, 384.0, 269.0, 339.0, 375.0, 264.0, 351.0, 340.0, 323.0, 393.0, 386.0, 271.0, 233.0, 261.0, 301.0, 411.0, 289.0, 371.0, 308.0, 335.0, 279.0, 294.0, 331.0, 313.0, 362.0, 311.0, 323.0, 322.0, 318.0, 306.0, 362.0, 368.0, 347.0, 413.0, 412.0, 179.0, 317.0, 353.0, 246.0, 303.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11045469588185762, "mean_inference_ms": 0.7272104390280846, "mean_action_processing_ms": 0.037564154713661854, "mean_env_wait_ms": 0.10980846399639141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007640361785888672, "StateBufferConnector_ms": 0.0013654232025146484, "ViewRequirementAgentConnector_ms": 0.03060317039489746}, "num_episodes": 40, "episode_return_max": 441.0, "episode_return_min": 179.0, "episode_return_mean": 323.66, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.4151629598879, "num_env_steps_trained_throughput_per_sec": 500.4151629598879, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 8307.536, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8307.433, "sample_time_ms": 3788.618, "load_time_ms": 1.573, "load_throughput": 2543621.092, "learn_time_ms": 4515.909, "learn_throughput": 885.757, "synch_weights_time_ms": 0.077}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 760, "training_iteration": 19, "trial_id": "default", "date": "2024-05-19_18-17-22", "timestamp": 1716167842, "time_this_iter_s": 7.994258165359497, "time_total_s": 163.90688514709473, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyBaselineCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 163.90688514709473, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 28.83636363636364, "ram_util_percent": 85.49090909090911}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.537597285163018, "cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 0.0, "total_loss": 9.946223720427483, "policy_loss": -0.005685793205855354, "vf_loss": 9.951909495938208, "vf_explained_var": -6.587274612918977e-06, "kl": 4.160461965980171e-10, "entropy": 2.079428134425994, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 413.0, "episode_reward_min": 170.0, "episode_reward_mean": 329.83, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [287.0, 345.0, 334.0, 344.0, 371.0, 261.0, 321.0, 394.0, 289.0, 369.0, 284.0, 290.0, 313.0, 386.0, 348.0, 377.0, 259.0, 340.0, 314.0, 377.0, 350.0, 384.0, 269.0, 339.0, 375.0, 264.0, 351.0, 340.0, 323.0, 393.0, 386.0, 271.0, 233.0, 261.0, 301.0, 411.0, 289.0, 371.0, 308.0, 335.0, 279.0, 294.0, 331.0, 313.0, 362.0, 311.0, 323.0, 322.0, 318.0, 306.0, 362.0, 368.0, 347.0, 413.0, 412.0, 179.0, 317.0, 353.0, 246.0, 303.0, 278.0, 378.0, 308.0, 265.0, 170.0, 371.0, 365.0, 278.0, 285.0, 337.0, 316.0, 400.0, 387.0, 373.0, 259.0, 345.0, 381.0, 356.0, 330.0, 405.0, 346.0, 387.0, 308.0, 317.0, 342.0, 395.0, 294.0, 331.0, 359.0, 292.0, 316.0, 349.0, 355.0, 324.0, 325.0, 364.0, 322.0, 324.0, 360.0, 370.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1103595719668412, "mean_inference_ms": 0.7259663298009635, "mean_action_processing_ms": 0.03752006791867253, "mean_env_wait_ms": 0.10974429638555872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007851362228393555, "StateBufferConnector_ms": 0.0013904571533203125, "ViewRequirementAgentConnector_ms": 0.03136110305786133}, "num_episodes": 40, "episode_return_max": 413.0, "episode_return_min": 170.0, "episode_return_mean": 329.83}, "env_runner_results": {"episode_reward_max": 413.0, "episode_reward_min": 170.0, "episode_reward_mean": 329.83, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [287.0, 345.0, 334.0, 344.0, 371.0, 261.0, 321.0, 394.0, 289.0, 369.0, 284.0, 290.0, 313.0, 386.0, 348.0, 377.0, 259.0, 340.0, 314.0, 377.0, 350.0, 384.0, 269.0, 339.0, 375.0, 264.0, 351.0, 340.0, 323.0, 393.0, 386.0, 271.0, 233.0, 261.0, 301.0, 411.0, 289.0, 371.0, 308.0, 335.0, 279.0, 294.0, 331.0, 313.0, 362.0, 311.0, 323.0, 322.0, 318.0, 306.0, 362.0, 368.0, 347.0, 413.0, 412.0, 179.0, 317.0, 353.0, 246.0, 303.0, 278.0, 378.0, 308.0, 265.0, 170.0, 371.0, 365.0, 278.0, 285.0, 337.0, 316.0, 400.0, 387.0, 373.0, 259.0, 345.0, 381.0, 356.0, 330.0, 405.0, 346.0, 387.0, 308.0, 317.0, 342.0, 395.0, 294.0, 331.0, 359.0, 292.0, 316.0, 349.0, 355.0, 324.0, 325.0, 364.0, 322.0, 324.0, 360.0, 370.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1103595719668412, "mean_inference_ms": 0.7259663298009635, "mean_action_processing_ms": 0.03752006791867253, "mean_env_wait_ms": 0.10974429638555872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007851362228393555, "StateBufferConnector_ms": 0.0013904571533203125, "ViewRequirementAgentConnector_ms": 0.03136110305786133}, "num_episodes": 40, "episode_return_max": 413.0, "episode_return_min": 170.0, "episode_return_mean": 329.83}, "episode_reward_max": 413.0, "episode_reward_min": 170.0, "episode_reward_mean": 329.83, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [287.0, 345.0, 334.0, 344.0, 371.0, 261.0, 321.0, 394.0, 289.0, 369.0, 284.0, 290.0, 313.0, 386.0, 348.0, 377.0, 259.0, 340.0, 314.0, 377.0, 350.0, 384.0, 269.0, 339.0, 375.0, 264.0, 351.0, 340.0, 323.0, 393.0, 386.0, 271.0, 233.0, 261.0, 301.0, 411.0, 289.0, 371.0, 308.0, 335.0, 279.0, 294.0, 331.0, 313.0, 362.0, 311.0, 323.0, 322.0, 318.0, 306.0, 362.0, 368.0, 347.0, 413.0, 412.0, 179.0, 317.0, 353.0, 246.0, 303.0, 278.0, 378.0, 308.0, 265.0, 170.0, 371.0, 365.0, 278.0, 285.0, 337.0, 316.0, 400.0, 387.0, 373.0, 259.0, 345.0, 381.0, 356.0, 330.0, 405.0, 346.0, 387.0, 308.0, 317.0, 342.0, 395.0, 294.0, 331.0, 359.0, 292.0, 316.0, 349.0, 355.0, 324.0, 325.0, 364.0, 322.0, 324.0, 360.0, 370.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1103595719668412, "mean_inference_ms": 0.7259663298009635, "mean_action_processing_ms": 0.03752006791867253, "mean_env_wait_ms": 0.10974429638555872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007851362228393555, "StateBufferConnector_ms": 0.0013904571533203125, "ViewRequirementAgentConnector_ms": 0.03136110305786133}, "num_episodes": 40, "episode_return_max": 413.0, "episode_return_min": 170.0, "episode_return_mean": 329.83, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 481.2141872633076, "num_env_steps_trained_throughput_per_sec": 481.2141872633076, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 8339.893, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8339.79, "sample_time_ms": 3822.918, "load_time_ms": 1.545, "load_throughput": 2589236.373, "learn_time_ms": 4513.989, "learn_throughput": 886.134, "synch_weights_time_ms": 0.076}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 800, "training_iteration": 20, "trial_id": "default", "date": "2024-05-19_18-17-30", "timestamp": 1716167850, "time_this_iter_s": 8.313575983047485, "time_total_s": 172.2204611301422, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyBaselineCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 172.2204611301422, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 30.50833333333333, "ram_util_percent": 85.8}}
