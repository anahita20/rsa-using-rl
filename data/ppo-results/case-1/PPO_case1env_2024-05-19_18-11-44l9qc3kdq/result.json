{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8863627699113663, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.003, "total_loss": 9.875477107878654, "policy_loss": -0.0291124099402398, "vf_loss": 9.864130153450915, "vf_explained_var": -0.02927817734338904, "kl": 0.2022969567737723, "entropy": 1.9051415424193106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 425.0, "episode_reward_min": 245.0, "episode_reward_mean": 328.4, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [291.0, 325.0, 315.0, 297.0, 251.0, 411.0, 287.0, 391.0, 299.0, 374.0, 410.0, 318.0, 320.0, 394.0, 315.0, 273.0, 425.0, 362.0, 319.0, 312.0, 351.0, 327.0, 329.0, 357.0, 330.0, 345.0, 337.0, 296.0, 255.0, 335.0, 372.0, 306.0, 268.0, 394.0, 340.0, 339.0, 359.0, 301.0, 261.0, 245.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11614923684545173, "mean_inference_ms": 0.7544172849991237, "mean_action_processing_ms": 0.04001070159401068, "mean_env_wait_ms": 0.11488212045804466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011031031608581543, "StateBufferConnector_ms": 0.001798868179321289, "ViewRequirementAgentConnector_ms": 0.03607630729675293}, "num_episodes": 40, "episode_return_max": 425.0, "episode_return_min": 245.0, "episode_return_mean": 328.4}, "env_runner_results": {"episode_reward_max": 425.0, "episode_reward_min": 245.0, "episode_reward_mean": 328.4, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [291.0, 325.0, 315.0, 297.0, 251.0, 411.0, 287.0, 391.0, 299.0, 374.0, 410.0, 318.0, 320.0, 394.0, 315.0, 273.0, 425.0, 362.0, 319.0, 312.0, 351.0, 327.0, 329.0, 357.0, 330.0, 345.0, 337.0, 296.0, 255.0, 335.0, 372.0, 306.0, 268.0, 394.0, 340.0, 339.0, 359.0, 301.0, 261.0, 245.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11614923684545173, "mean_inference_ms": 0.7544172849991237, "mean_action_processing_ms": 0.04001070159401068, "mean_env_wait_ms": 0.11488212045804466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011031031608581543, "StateBufferConnector_ms": 0.001798868179321289, "ViewRequirementAgentConnector_ms": 0.03607630729675293}, "num_episodes": 40, "episode_return_max": 425.0, "episode_return_min": 245.0, "episode_return_mean": 328.4}, "episode_reward_max": 425.0, "episode_reward_min": 245.0, "episode_reward_mean": 328.4, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [291.0, 325.0, 315.0, 297.0, 251.0, 411.0, 287.0, 391.0, 299.0, 374.0, 410.0, 318.0, 320.0, 394.0, 315.0, 273.0, 425.0, 362.0, 319.0, 312.0, 351.0, 327.0, 329.0, 357.0, 330.0, 345.0, 337.0, 296.0, 255.0, 335.0, 372.0, 306.0, 268.0, 394.0, 340.0, 339.0, 359.0, 301.0, 261.0, 245.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11614923684545173, "mean_inference_ms": 0.7544172849991237, "mean_action_processing_ms": 0.04001070159401068, "mean_env_wait_ms": 0.11488212045804466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011031031608581543, "StateBufferConnector_ms": 0.001798868179321289, "ViewRequirementAgentConnector_ms": 0.03607630729675293}, "num_episodes": 40, "episode_return_max": 425.0, "episode_return_min": 245.0, "episode_return_mean": 328.4, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 436.44394515897625, "num_env_steps_trained_throughput_per_sec": 436.44394515897625, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 9166.355, "restore_workers_time_ms": 0.009, "training_step_time_ms": 9164.921, "sample_time_ms": 4127.138, "load_time_ms": 0.259, "load_throughput": 15448633.517, "learn_time_ms": 5036.717, "learn_throughput": 794.168, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 40, "training_iteration": 1, "trial_id": "default", "date": "2024-05-19_18-11-53", "timestamp": 1716167513, "time_this_iter_s": 9.166810989379883, "time_total_s": 9.166810989379883, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 9.166810989379883, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 37.93571428571429, "ram_util_percent": 86.00714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.379533365336798, "cur_kl_coeff": 0.3, "cur_lr": 0.003, "total_loss": 9.858158139259585, "policy_loss": -0.07716857734967464, "vf_loss": 9.878670533498129, "vf_explained_var": -0.021712398016324606, "kl": 0.18885394575954223, "entropy": 1.705199710912602, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 482.0, "episode_reward_min": 245.0, "episode_reward_mean": 366.55, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [291.0, 325.0, 315.0, 297.0, 251.0, 411.0, 287.0, 391.0, 299.0, 374.0, 410.0, 318.0, 320.0, 394.0, 315.0, 273.0, 425.0, 362.0, 319.0, 312.0, 351.0, 327.0, 329.0, 357.0, 330.0, 345.0, 337.0, 296.0, 255.0, 335.0, 372.0, 306.0, 268.0, 394.0, 340.0, 339.0, 359.0, 301.0, 261.0, 245.0, 401.0, 386.0, 362.0, 366.0, 404.0, 350.0, 394.0, 366.0, 393.0, 354.0, 386.0, 354.0, 389.0, 412.0, 421.0, 414.0, 421.0, 387.0, 441.0, 447.0, 420.0, 380.0, 443.0, 420.0, 428.0, 426.0, 392.0, 482.0, 339.0, 449.0, 372.0, 478.0, 430.0, 431.0, 349.0, 482.0, 454.0, 325.0, 429.0, 411.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11331549697379564, "mean_inference_ms": 0.7398385782353246, "mean_action_processing_ms": 0.03903042930338925, "mean_env_wait_ms": 0.11375169353330503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009265542030334473, "StateBufferConnector_ms": 0.0015622377395629883, "ViewRequirementAgentConnector_ms": 0.03403574228286743}, "num_episodes": 40, "episode_return_max": 482.0, "episode_return_min": 245.0, "episode_return_mean": 366.55}, "env_runner_results": {"episode_reward_max": 482.0, "episode_reward_min": 245.0, "episode_reward_mean": 366.55, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [291.0, 325.0, 315.0, 297.0, 251.0, 411.0, 287.0, 391.0, 299.0, 374.0, 410.0, 318.0, 320.0, 394.0, 315.0, 273.0, 425.0, 362.0, 319.0, 312.0, 351.0, 327.0, 329.0, 357.0, 330.0, 345.0, 337.0, 296.0, 255.0, 335.0, 372.0, 306.0, 268.0, 394.0, 340.0, 339.0, 359.0, 301.0, 261.0, 245.0, 401.0, 386.0, 362.0, 366.0, 404.0, 350.0, 394.0, 366.0, 393.0, 354.0, 386.0, 354.0, 389.0, 412.0, 421.0, 414.0, 421.0, 387.0, 441.0, 447.0, 420.0, 380.0, 443.0, 420.0, 428.0, 426.0, 392.0, 482.0, 339.0, 449.0, 372.0, 478.0, 430.0, 431.0, 349.0, 482.0, 454.0, 325.0, 429.0, 411.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11331549697379564, "mean_inference_ms": 0.7398385782353246, "mean_action_processing_ms": 0.03903042930338925, "mean_env_wait_ms": 0.11375169353330503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009265542030334473, "StateBufferConnector_ms": 0.0015622377395629883, "ViewRequirementAgentConnector_ms": 0.03403574228286743}, "num_episodes": 40, "episode_return_max": 482.0, "episode_return_min": 245.0, "episode_return_mean": 366.55}, "episode_reward_max": 482.0, "episode_reward_min": 245.0, "episode_reward_mean": 366.55, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [291.0, 325.0, 315.0, 297.0, 251.0, 411.0, 287.0, 391.0, 299.0, 374.0, 410.0, 318.0, 320.0, 394.0, 315.0, 273.0, 425.0, 362.0, 319.0, 312.0, 351.0, 327.0, 329.0, 357.0, 330.0, 345.0, 337.0, 296.0, 255.0, 335.0, 372.0, 306.0, 268.0, 394.0, 340.0, 339.0, 359.0, 301.0, 261.0, 245.0, 401.0, 386.0, 362.0, 366.0, 404.0, 350.0, 394.0, 366.0, 393.0, 354.0, 386.0, 354.0, 389.0, 412.0, 421.0, 414.0, 421.0, 387.0, 441.0, 447.0, 420.0, 380.0, 443.0, 420.0, 428.0, 426.0, 392.0, 482.0, 339.0, 449.0, 372.0, 478.0, 430.0, 431.0, 349.0, 482.0, 454.0, 325.0, 429.0, 411.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11331549697379564, "mean_inference_ms": 0.7398385782353246, "mean_action_processing_ms": 0.03903042930338925, "mean_env_wait_ms": 0.11375169353330503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009265542030334473, "StateBufferConnector_ms": 0.0015622377395629883, "ViewRequirementAgentConnector_ms": 0.03403574228286743}, "num_episodes": 40, "episode_return_max": 482.0, "episode_return_min": 245.0, "episode_return_mean": 366.55, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 475.681375665189, "num_env_steps_trained_throughput_per_sec": 475.681375665189, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 8787.676, "restore_workers_time_ms": 0.008, "training_step_time_ms": 8786.929, "sample_time_ms": 3970.325, "load_time_ms": 1.243, "load_throughput": 3216799.156, "learn_time_ms": 4814.556, "learn_throughput": 830.814, "synch_weights_time_ms": 0.014}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 80, "training_iteration": 2, "trial_id": "default", "date": "2024-05-19_18-12-02", "timestamp": 1716167522, "time_this_iter_s": 8.410517930984497, "time_total_s": 17.57732892036438, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 17.57732892036438, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 33.074999999999996, "ram_util_percent": 85.99166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.8730284207610675, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.003, "total_loss": 9.870745406612274, "policy_loss": -0.07713203685187925, "vf_loss": 9.86671321622787, "vf_explained_var": -0.02390045222415719, "kl": 0.18036505593026678, "entropy": 1.674570591475374, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 482.0, "episode_reward_min": 245.0, "episode_reward_mean": 384.35, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.0, 327.0, 329.0, 357.0, 330.0, 345.0, 337.0, 296.0, 255.0, 335.0, 372.0, 306.0, 268.0, 394.0, 340.0, 339.0, 359.0, 301.0, 261.0, 245.0, 401.0, 386.0, 362.0, 366.0, 404.0, 350.0, 394.0, 366.0, 393.0, 354.0, 386.0, 354.0, 389.0, 412.0, 421.0, 414.0, 421.0, 387.0, 441.0, 447.0, 420.0, 380.0, 443.0, 420.0, 428.0, 426.0, 392.0, 482.0, 339.0, 449.0, 372.0, 478.0, 430.0, 431.0, 349.0, 482.0, 454.0, 325.0, 429.0, 411.0, 350.0, 399.0, 370.0, 398.0, 451.0, 399.0, 418.0, 418.0, 444.0, 407.0, 382.0, 388.0, 417.0, 417.0, 413.0, 346.0, 388.0, 388.0, 391.0, 349.0, 435.0, 366.0, 354.0, 374.0, 391.0, 424.0, 457.0, 374.0, 348.0, 427.0, 379.0, 358.0, 428.0, 417.0, 342.0, 434.0, 386.0, 354.0, 388.0, 431.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11083915952784232, "mean_inference_ms": 0.7268210331078987, "mean_action_processing_ms": 0.0381296719503596, "mean_env_wait_ms": 0.11278548895501657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00965571403503418, "StateBufferConnector_ms": 0.0013942718505859375, "ViewRequirementAgentConnector_ms": 0.032628774642944336}, "num_episodes": 40, "episode_return_max": 482.0, "episode_return_min": 245.0, "episode_return_mean": 384.35}, "env_runner_results": {"episode_reward_max": 482.0, "episode_reward_min": 245.0, "episode_reward_mean": 384.35, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.0, 327.0, 329.0, 357.0, 330.0, 345.0, 337.0, 296.0, 255.0, 335.0, 372.0, 306.0, 268.0, 394.0, 340.0, 339.0, 359.0, 301.0, 261.0, 245.0, 401.0, 386.0, 362.0, 366.0, 404.0, 350.0, 394.0, 366.0, 393.0, 354.0, 386.0, 354.0, 389.0, 412.0, 421.0, 414.0, 421.0, 387.0, 441.0, 447.0, 420.0, 380.0, 443.0, 420.0, 428.0, 426.0, 392.0, 482.0, 339.0, 449.0, 372.0, 478.0, 430.0, 431.0, 349.0, 482.0, 454.0, 325.0, 429.0, 411.0, 350.0, 399.0, 370.0, 398.0, 451.0, 399.0, 418.0, 418.0, 444.0, 407.0, 382.0, 388.0, 417.0, 417.0, 413.0, 346.0, 388.0, 388.0, 391.0, 349.0, 435.0, 366.0, 354.0, 374.0, 391.0, 424.0, 457.0, 374.0, 348.0, 427.0, 379.0, 358.0, 428.0, 417.0, 342.0, 434.0, 386.0, 354.0, 388.0, 431.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11083915952784232, "mean_inference_ms": 0.7268210331078987, "mean_action_processing_ms": 0.0381296719503596, "mean_env_wait_ms": 0.11278548895501657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00965571403503418, "StateBufferConnector_ms": 0.0013942718505859375, "ViewRequirementAgentConnector_ms": 0.032628774642944336}, "num_episodes": 40, "episode_return_max": 482.0, "episode_return_min": 245.0, "episode_return_mean": 384.35}, "episode_reward_max": 482.0, "episode_reward_min": 245.0, "episode_reward_mean": 384.35, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [351.0, 327.0, 329.0, 357.0, 330.0, 345.0, 337.0, 296.0, 255.0, 335.0, 372.0, 306.0, 268.0, 394.0, 340.0, 339.0, 359.0, 301.0, 261.0, 245.0, 401.0, 386.0, 362.0, 366.0, 404.0, 350.0, 394.0, 366.0, 393.0, 354.0, 386.0, 354.0, 389.0, 412.0, 421.0, 414.0, 421.0, 387.0, 441.0, 447.0, 420.0, 380.0, 443.0, 420.0, 428.0, 426.0, 392.0, 482.0, 339.0, 449.0, 372.0, 478.0, 430.0, 431.0, 349.0, 482.0, 454.0, 325.0, 429.0, 411.0, 350.0, 399.0, 370.0, 398.0, 451.0, 399.0, 418.0, 418.0, 444.0, 407.0, 382.0, 388.0, 417.0, 417.0, 413.0, 346.0, 388.0, 388.0, 391.0, 349.0, 435.0, 366.0, 354.0, 374.0, 391.0, 424.0, 457.0, 374.0, 348.0, 427.0, 379.0, 358.0, 428.0, 417.0, 342.0, 434.0, 386.0, 354.0, 388.0, 431.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11083915952784232, "mean_inference_ms": 0.7268210331078987, "mean_action_processing_ms": 0.0381296719503596, "mean_env_wait_ms": 0.11278548895501657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00965571403503418, "StateBufferConnector_ms": 0.0013942718505859375, "ViewRequirementAgentConnector_ms": 0.032628774642944336}, "num_episodes": 40, "episode_return_max": 482.0, "episode_return_min": 245.0, "episode_return_mean": 384.35, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.1057845890738, "num_env_steps_trained_throughput_per_sec": 487.1057845890738, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 8595.716, "restore_workers_time_ms": 0.008, "training_step_time_ms": 8595.192, "sample_time_ms": 3913.601, "load_time_ms": 1.353, "load_throughput": 2956337.621, "learn_time_ms": 4679.509, "learn_throughput": 854.79, "synch_weights_time_ms": 0.019}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 120, "training_iteration": 3, "trial_id": "default", "date": "2024-05-19_18-12-10", "timestamp": 1716167530, "time_this_iter_s": 8.213239192962646, "time_total_s": 25.790568113327026, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 25.790568113327026, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 29.272727272727273, "ram_util_percent": 84.82727272727271}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.049320078408846, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.003, "total_loss": 9.85059852497552, "policy_loss": -0.09946991413361042, "vf_loss": 9.863093861200475, "vf_explained_var": -0.012838692562554472, "kl": 0.12885122566759968, "entropy": 1.6911306254325373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 482.0, "episode_reward_min": 307.0, "episode_reward_mean": 394.6, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [420.0, 380.0, 443.0, 420.0, 428.0, 426.0, 392.0, 482.0, 339.0, 449.0, 372.0, 478.0, 430.0, 431.0, 349.0, 482.0, 454.0, 325.0, 429.0, 411.0, 350.0, 399.0, 370.0, 398.0, 451.0, 399.0, 418.0, 418.0, 444.0, 407.0, 382.0, 388.0, 417.0, 417.0, 413.0, 346.0, 388.0, 388.0, 391.0, 349.0, 435.0, 366.0, 354.0, 374.0, 391.0, 424.0, 457.0, 374.0, 348.0, 427.0, 379.0, 358.0, 428.0, 417.0, 342.0, 434.0, 386.0, 354.0, 388.0, 431.0, 388.0, 351.0, 419.0, 414.0, 377.0, 372.0, 430.0, 373.0, 368.0, 356.0, 349.0, 396.0, 393.0, 358.0, 417.0, 378.0, 410.0, 313.0, 429.0, 418.0, 371.0, 332.0, 404.0, 380.0, 395.0, 361.0, 423.0, 330.0, 323.0, 358.0, 406.0, 359.0, 307.0, 370.0, 446.0, 381.0, 398.0, 410.0, 425.0, 432.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.10842548585310272, "mean_inference_ms": 0.7142581626923794, "mean_action_processing_ms": 0.03730340367427806, "mean_env_wait_ms": 0.11190132695120811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009476661682128906, "StateBufferConnector_ms": 0.0013921260833740234, "ViewRequirementAgentConnector_ms": 0.032166242599487305}, "num_episodes": 40, "episode_return_max": 482.0, "episode_return_min": 307.0, "episode_return_mean": 394.6}, "env_runner_results": {"episode_reward_max": 482.0, "episode_reward_min": 307.0, "episode_reward_mean": 394.6, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [420.0, 380.0, 443.0, 420.0, 428.0, 426.0, 392.0, 482.0, 339.0, 449.0, 372.0, 478.0, 430.0, 431.0, 349.0, 482.0, 454.0, 325.0, 429.0, 411.0, 350.0, 399.0, 370.0, 398.0, 451.0, 399.0, 418.0, 418.0, 444.0, 407.0, 382.0, 388.0, 417.0, 417.0, 413.0, 346.0, 388.0, 388.0, 391.0, 349.0, 435.0, 366.0, 354.0, 374.0, 391.0, 424.0, 457.0, 374.0, 348.0, 427.0, 379.0, 358.0, 428.0, 417.0, 342.0, 434.0, 386.0, 354.0, 388.0, 431.0, 388.0, 351.0, 419.0, 414.0, 377.0, 372.0, 430.0, 373.0, 368.0, 356.0, 349.0, 396.0, 393.0, 358.0, 417.0, 378.0, 410.0, 313.0, 429.0, 418.0, 371.0, 332.0, 404.0, 380.0, 395.0, 361.0, 423.0, 330.0, 323.0, 358.0, 406.0, 359.0, 307.0, 370.0, 446.0, 381.0, 398.0, 410.0, 425.0, 432.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.10842548585310272, "mean_inference_ms": 0.7142581626923794, "mean_action_processing_ms": 0.03730340367427806, "mean_env_wait_ms": 0.11190132695120811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009476661682128906, "StateBufferConnector_ms": 0.0013921260833740234, "ViewRequirementAgentConnector_ms": 0.032166242599487305}, "num_episodes": 40, "episode_return_max": 482.0, "episode_return_min": 307.0, "episode_return_mean": 394.6}, "episode_reward_max": 482.0, "episode_reward_min": 307.0, "episode_reward_mean": 394.6, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [420.0, 380.0, 443.0, 420.0, 428.0, 426.0, 392.0, 482.0, 339.0, 449.0, 372.0, 478.0, 430.0, 431.0, 349.0, 482.0, 454.0, 325.0, 429.0, 411.0, 350.0, 399.0, 370.0, 398.0, 451.0, 399.0, 418.0, 418.0, 444.0, 407.0, 382.0, 388.0, 417.0, 417.0, 413.0, 346.0, 388.0, 388.0, 391.0, 349.0, 435.0, 366.0, 354.0, 374.0, 391.0, 424.0, 457.0, 374.0, 348.0, 427.0, 379.0, 358.0, 428.0, 417.0, 342.0, 434.0, 386.0, 354.0, 388.0, 431.0, 388.0, 351.0, 419.0, 414.0, 377.0, 372.0, 430.0, 373.0, 368.0, 356.0, 349.0, 396.0, 393.0, 358.0, 417.0, 378.0, 410.0, 313.0, 429.0, 418.0, 371.0, 332.0, 404.0, 380.0, 395.0, 361.0, 423.0, 330.0, 323.0, 358.0, 406.0, 359.0, 307.0, 370.0, 446.0, 381.0, 398.0, 410.0, 425.0, 432.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.10842548585310272, "mean_inference_ms": 0.7142581626923794, "mean_action_processing_ms": 0.03730340367427806, "mean_env_wait_ms": 0.11190132695120811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009476661682128906, "StateBufferConnector_ms": 0.0013921260833740234, "ViewRequirementAgentConnector_ms": 0.032166242599487305}, "num_episodes": 40, "episode_return_max": 482.0, "episode_return_min": 307.0, "episode_return_mean": 394.6, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 504.7868078703606, "num_env_steps_trained_throughput_per_sec": 504.7868078703606, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 8427.826, "restore_workers_time_ms": 0.009, "training_step_time_ms": 8427.416, "sample_time_ms": 3879.61, "load_time_ms": 1.37, "load_throughput": 2919172.822, "learn_time_ms": 4545.775, "learn_throughput": 879.938, "synch_weights_time_ms": 0.018}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 160, "training_iteration": 4, "trial_id": "default", "date": "2024-05-19_18-12-18", "timestamp": 1716167538, "time_this_iter_s": 7.924936294555664, "time_total_s": 33.71550440788269, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 33.71550440788269, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.38181818181818, "ram_util_percent": 85.06363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.6637338629332925, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.003, "total_loss": 9.895308265891126, "policy_loss": -0.08288254496461202, "vf_loss": 9.863624741954188, "vf_explained_var": -0.0015207129140054026, "kl": 0.11315165260059247, "entropy": 1.6805775355267267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 457.0, "episode_reward_min": 285.0, "episode_reward_mean": 376.57, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [435.0, 366.0, 354.0, 374.0, 391.0, 424.0, 457.0, 374.0, 348.0, 427.0, 379.0, 358.0, 428.0, 417.0, 342.0, 434.0, 386.0, 354.0, 388.0, 431.0, 388.0, 351.0, 419.0, 414.0, 377.0, 372.0, 430.0, 373.0, 368.0, 356.0, 349.0, 396.0, 393.0, 358.0, 417.0, 378.0, 410.0, 313.0, 429.0, 418.0, 371.0, 332.0, 404.0, 380.0, 395.0, 361.0, 423.0, 330.0, 323.0, 358.0, 406.0, 359.0, 307.0, 370.0, 446.0, 381.0, 398.0, 410.0, 425.0, 432.0, 369.0, 381.0, 335.0, 354.0, 405.0, 354.0, 344.0, 379.0, 379.0, 399.0, 375.0, 406.0, 340.0, 380.0, 298.0, 313.0, 391.0, 371.0, 285.0, 347.0, 433.0, 378.0, 331.0, 333.0, 338.0, 308.0, 337.0, 409.0, 323.0, 351.0, 409.0, 369.0, 416.0, 411.0, 328.0, 353.0, 331.0, 409.0, 343.0, 355.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1102477302905783, "mean_inference_ms": 0.727505273735661, "mean_action_processing_ms": 0.038014615482298814, "mean_env_wait_ms": 0.11400529976898552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00892949104309082, "StateBufferConnector_ms": 0.0015842914581298828, "ViewRequirementAgentConnector_ms": 0.03563094139099121}, "num_episodes": 40, "episode_return_max": 457.0, "episode_return_min": 285.0, "episode_return_mean": 376.57}, "env_runner_results": {"episode_reward_max": 457.0, "episode_reward_min": 285.0, "episode_reward_mean": 376.57, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [435.0, 366.0, 354.0, 374.0, 391.0, 424.0, 457.0, 374.0, 348.0, 427.0, 379.0, 358.0, 428.0, 417.0, 342.0, 434.0, 386.0, 354.0, 388.0, 431.0, 388.0, 351.0, 419.0, 414.0, 377.0, 372.0, 430.0, 373.0, 368.0, 356.0, 349.0, 396.0, 393.0, 358.0, 417.0, 378.0, 410.0, 313.0, 429.0, 418.0, 371.0, 332.0, 404.0, 380.0, 395.0, 361.0, 423.0, 330.0, 323.0, 358.0, 406.0, 359.0, 307.0, 370.0, 446.0, 381.0, 398.0, 410.0, 425.0, 432.0, 369.0, 381.0, 335.0, 354.0, 405.0, 354.0, 344.0, 379.0, 379.0, 399.0, 375.0, 406.0, 340.0, 380.0, 298.0, 313.0, 391.0, 371.0, 285.0, 347.0, 433.0, 378.0, 331.0, 333.0, 338.0, 308.0, 337.0, 409.0, 323.0, 351.0, 409.0, 369.0, 416.0, 411.0, 328.0, 353.0, 331.0, 409.0, 343.0, 355.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1102477302905783, "mean_inference_ms": 0.727505273735661, "mean_action_processing_ms": 0.038014615482298814, "mean_env_wait_ms": 0.11400529976898552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00892949104309082, "StateBufferConnector_ms": 0.0015842914581298828, "ViewRequirementAgentConnector_ms": 0.03563094139099121}, "num_episodes": 40, "episode_return_max": 457.0, "episode_return_min": 285.0, "episode_return_mean": 376.57}, "episode_reward_max": 457.0, "episode_reward_min": 285.0, "episode_reward_mean": 376.57, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [435.0, 366.0, 354.0, 374.0, 391.0, 424.0, 457.0, 374.0, 348.0, 427.0, 379.0, 358.0, 428.0, 417.0, 342.0, 434.0, 386.0, 354.0, 388.0, 431.0, 388.0, 351.0, 419.0, 414.0, 377.0, 372.0, 430.0, 373.0, 368.0, 356.0, 349.0, 396.0, 393.0, 358.0, 417.0, 378.0, 410.0, 313.0, 429.0, 418.0, 371.0, 332.0, 404.0, 380.0, 395.0, 361.0, 423.0, 330.0, 323.0, 358.0, 406.0, 359.0, 307.0, 370.0, 446.0, 381.0, 398.0, 410.0, 425.0, 432.0, 369.0, 381.0, 335.0, 354.0, 405.0, 354.0, 344.0, 379.0, 379.0, 399.0, 375.0, 406.0, 340.0, 380.0, 298.0, 313.0, 391.0, 371.0, 285.0, 347.0, 433.0, 378.0, 331.0, 333.0, 338.0, 308.0, 337.0, 409.0, 323.0, 351.0, 409.0, 369.0, 416.0, 411.0, 328.0, 353.0, 331.0, 409.0, 343.0, 355.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1102477302905783, "mean_inference_ms": 0.727505273735661, "mean_action_processing_ms": 0.038014615482298814, "mean_env_wait_ms": 0.11400529976898552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00892949104309082, "StateBufferConnector_ms": 0.0015842914581298828, "ViewRequirementAgentConnector_ms": 0.03563094139099121}, "num_episodes": 40, "episode_return_max": 457.0, "episode_return_min": 285.0, "episode_return_mean": 376.57, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 418.7093615439532, "num_env_steps_trained_throughput_per_sec": 418.7093615439532, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 8652.898, "restore_workers_time_ms": 0.008, "training_step_time_ms": 8652.55, "sample_time_ms": 4120.167, "load_time_ms": 1.709, "load_throughput": 2341093.994, "learn_time_ms": 4529.957, "learn_throughput": 883.011, "synch_weights_time_ms": 0.02}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 200, "training_iteration": 5, "trial_id": "default", "date": "2024-05-19_18-12-27", "timestamp": 1716167547, "time_this_iter_s": 9.55479097366333, "time_total_s": 43.27029538154602, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 43.27029538154602, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 49.00714285714286, "ram_util_percent": 85.95714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.38990190516236, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.003, "total_loss": 9.949869460444297, "policy_loss": -0.08571488070201569, "vf_loss": 9.908748000155214, "vf_explained_var": 0.05113952281654522, "kl": 0.08351364154236661, "entropy": 1.6230481124693348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 472.0, "episode_reward_min": 222.0, "episode_reward_mean": 363.99, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [371.0, 332.0, 404.0, 380.0, 395.0, 361.0, 423.0, 330.0, 323.0, 358.0, 406.0, 359.0, 307.0, 370.0, 446.0, 381.0, 398.0, 410.0, 425.0, 432.0, 369.0, 381.0, 335.0, 354.0, 405.0, 354.0, 344.0, 379.0, 379.0, 399.0, 375.0, 406.0, 340.0, 380.0, 298.0, 313.0, 391.0, 371.0, 285.0, 347.0, 433.0, 378.0, 331.0, 333.0, 338.0, 308.0, 337.0, 409.0, 323.0, 351.0, 409.0, 369.0, 416.0, 411.0, 328.0, 353.0, 331.0, 409.0, 343.0, 355.0, 343.0, 390.0, 426.0, 374.0, 407.0, 401.0, 316.0, 393.0, 222.0, 358.0, 408.0, 472.0, 297.0, 412.0, 360.0, 327.0, 353.0, 331.0, 327.0, 395.0, 267.0, 399.0, 367.0, 349.0, 396.0, 342.0, 318.0, 379.0, 351.0, 338.0, 369.0, 294.0, 392.0, 324.0, 433.0, 304.0, 285.0, 427.0, 409.0, 263.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11212988060246974, "mean_inference_ms": 0.7409597223380833, "mean_action_processing_ms": 0.03874191847903048, "mean_env_wait_ms": 0.11596226872595997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010242700576782227, "StateBufferConnector_ms": 0.0016083717346191406, "ViewRequirementAgentConnector_ms": 0.0355069637298584}, "num_episodes": 40, "episode_return_max": 472.0, "episode_return_min": 222.0, "episode_return_mean": 363.99}, "env_runner_results": {"episode_reward_max": 472.0, "episode_reward_min": 222.0, "episode_reward_mean": 363.99, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [371.0, 332.0, 404.0, 380.0, 395.0, 361.0, 423.0, 330.0, 323.0, 358.0, 406.0, 359.0, 307.0, 370.0, 446.0, 381.0, 398.0, 410.0, 425.0, 432.0, 369.0, 381.0, 335.0, 354.0, 405.0, 354.0, 344.0, 379.0, 379.0, 399.0, 375.0, 406.0, 340.0, 380.0, 298.0, 313.0, 391.0, 371.0, 285.0, 347.0, 433.0, 378.0, 331.0, 333.0, 338.0, 308.0, 337.0, 409.0, 323.0, 351.0, 409.0, 369.0, 416.0, 411.0, 328.0, 353.0, 331.0, 409.0, 343.0, 355.0, 343.0, 390.0, 426.0, 374.0, 407.0, 401.0, 316.0, 393.0, 222.0, 358.0, 408.0, 472.0, 297.0, 412.0, 360.0, 327.0, 353.0, 331.0, 327.0, 395.0, 267.0, 399.0, 367.0, 349.0, 396.0, 342.0, 318.0, 379.0, 351.0, 338.0, 369.0, 294.0, 392.0, 324.0, 433.0, 304.0, 285.0, 427.0, 409.0, 263.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11212988060246974, "mean_inference_ms": 0.7409597223380833, "mean_action_processing_ms": 0.03874191847903048, "mean_env_wait_ms": 0.11596226872595997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010242700576782227, "StateBufferConnector_ms": 0.0016083717346191406, "ViewRequirementAgentConnector_ms": 0.0355069637298584}, "num_episodes": 40, "episode_return_max": 472.0, "episode_return_min": 222.0, "episode_return_mean": 363.99}, "episode_reward_max": 472.0, "episode_reward_min": 222.0, "episode_reward_mean": 363.99, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [371.0, 332.0, 404.0, 380.0, 395.0, 361.0, 423.0, 330.0, 323.0, 358.0, 406.0, 359.0, 307.0, 370.0, 446.0, 381.0, 398.0, 410.0, 425.0, 432.0, 369.0, 381.0, 335.0, 354.0, 405.0, 354.0, 344.0, 379.0, 379.0, 399.0, 375.0, 406.0, 340.0, 380.0, 298.0, 313.0, 391.0, 371.0, 285.0, 347.0, 433.0, 378.0, 331.0, 333.0, 338.0, 308.0, 337.0, 409.0, 323.0, 351.0, 409.0, 369.0, 416.0, 411.0, 328.0, 353.0, 331.0, 409.0, 343.0, 355.0, 343.0, 390.0, 426.0, 374.0, 407.0, 401.0, 316.0, 393.0, 222.0, 358.0, 408.0, 472.0, 297.0, 412.0, 360.0, 327.0, 353.0, 331.0, 327.0, 395.0, 267.0, 399.0, 367.0, 349.0, 396.0, 342.0, 318.0, 379.0, 351.0, 338.0, 369.0, 294.0, 392.0, 324.0, 433.0, 304.0, 285.0, 427.0, 409.0, 263.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11212988060246974, "mean_inference_ms": 0.7409597223380833, "mean_action_processing_ms": 0.03874191847903048, "mean_env_wait_ms": 0.11596226872595997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010242700576782227, "StateBufferConnector_ms": 0.0016083717346191406, "ViewRequirementAgentConnector_ms": 0.0355069637298584}, "num_episodes": 40, "episode_return_max": 472.0, "episode_return_min": 222.0, "episode_return_mean": 363.99, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 484.18382540931793, "num_env_steps_trained_throughput_per_sec": 484.18382540931793, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 8587.646, "restore_workers_time_ms": 0.022, "training_step_time_ms": 8587.327, "sample_time_ms": 4076.129, "load_time_ms": 1.65, "load_throughput": 2424745.176, "learn_time_ms": 4508.858, "learn_throughput": 887.143, "synch_weights_time_ms": 0.017}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 240, "training_iteration": 6, "trial_id": "default", "date": "2024-05-19_18-12-36", "timestamp": 1716167556, "time_this_iter_s": 8.262230157852173, "time_total_s": 51.53252553939819, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 51.53252553939819, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 31.14166666666667, "ram_util_percent": 84.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.434263204759167, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.003, "total_loss": 9.926776374283657, "policy_loss": -0.07502209392065803, "vf_loss": 9.867865396315052, "vf_explained_var": 0.005217555069154309, "kl": 0.058790922234418355, "entropy": 1.5744522304945094, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 472.0, "episode_reward_min": 222.0, "episode_reward_mean": 366.05, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [433.0, 378.0, 331.0, 333.0, 338.0, 308.0, 337.0, 409.0, 323.0, 351.0, 409.0, 369.0, 416.0, 411.0, 328.0, 353.0, 331.0, 409.0, 343.0, 355.0, 343.0, 390.0, 426.0, 374.0, 407.0, 401.0, 316.0, 393.0, 222.0, 358.0, 408.0, 472.0, 297.0, 412.0, 360.0, 327.0, 353.0, 331.0, 327.0, 395.0, 267.0, 399.0, 367.0, 349.0, 396.0, 342.0, 318.0, 379.0, 351.0, 338.0, 369.0, 294.0, 392.0, 324.0, 433.0, 304.0, 285.0, 427.0, 409.0, 263.0, 302.0, 362.0, 346.0, 367.0, 380.0, 405.0, 407.0, 347.0, 386.0, 379.0, 396.0, 398.0, 394.0, 352.0, 446.0, 342.0, 401.0, 381.0, 341.0, 337.0, 415.0, 377.0, 317.0, 337.0, 404.0, 392.0, 399.0, 383.0, 403.0, 341.0, 397.0, 392.0, 365.0, 358.0, 363.0, 301.0, 427.0, 418.0, 416.0, 348.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11236988954856225, "mean_inference_ms": 0.7438218590429903, "mean_action_processing_ms": 0.03887727706372852, "mean_env_wait_ms": 0.11655406704101817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009907960891723633, "StateBufferConnector_ms": 0.0015807151794433594, "ViewRequirementAgentConnector_ms": 0.03356790542602539}, "num_episodes": 40, "episode_return_max": 472.0, "episode_return_min": 222.0, "episode_return_mean": 366.05}, "env_runner_results": {"episode_reward_max": 472.0, "episode_reward_min": 222.0, "episode_reward_mean": 366.05, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [433.0, 378.0, 331.0, 333.0, 338.0, 308.0, 337.0, 409.0, 323.0, 351.0, 409.0, 369.0, 416.0, 411.0, 328.0, 353.0, 331.0, 409.0, 343.0, 355.0, 343.0, 390.0, 426.0, 374.0, 407.0, 401.0, 316.0, 393.0, 222.0, 358.0, 408.0, 472.0, 297.0, 412.0, 360.0, 327.0, 353.0, 331.0, 327.0, 395.0, 267.0, 399.0, 367.0, 349.0, 396.0, 342.0, 318.0, 379.0, 351.0, 338.0, 369.0, 294.0, 392.0, 324.0, 433.0, 304.0, 285.0, 427.0, 409.0, 263.0, 302.0, 362.0, 346.0, 367.0, 380.0, 405.0, 407.0, 347.0, 386.0, 379.0, 396.0, 398.0, 394.0, 352.0, 446.0, 342.0, 401.0, 381.0, 341.0, 337.0, 415.0, 377.0, 317.0, 337.0, 404.0, 392.0, 399.0, 383.0, 403.0, 341.0, 397.0, 392.0, 365.0, 358.0, 363.0, 301.0, 427.0, 418.0, 416.0, 348.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11236988954856225, "mean_inference_ms": 0.7438218590429903, "mean_action_processing_ms": 0.03887727706372852, "mean_env_wait_ms": 0.11655406704101817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009907960891723633, "StateBufferConnector_ms": 0.0015807151794433594, "ViewRequirementAgentConnector_ms": 0.03356790542602539}, "num_episodes": 40, "episode_return_max": 472.0, "episode_return_min": 222.0, "episode_return_mean": 366.05}, "episode_reward_max": 472.0, "episode_reward_min": 222.0, "episode_reward_mean": 366.05, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [433.0, 378.0, 331.0, 333.0, 338.0, 308.0, 337.0, 409.0, 323.0, 351.0, 409.0, 369.0, 416.0, 411.0, 328.0, 353.0, 331.0, 409.0, 343.0, 355.0, 343.0, 390.0, 426.0, 374.0, 407.0, 401.0, 316.0, 393.0, 222.0, 358.0, 408.0, 472.0, 297.0, 412.0, 360.0, 327.0, 353.0, 331.0, 327.0, 395.0, 267.0, 399.0, 367.0, 349.0, 396.0, 342.0, 318.0, 379.0, 351.0, 338.0, 369.0, 294.0, 392.0, 324.0, 433.0, 304.0, 285.0, 427.0, 409.0, 263.0, 302.0, 362.0, 346.0, 367.0, 380.0, 405.0, 407.0, 347.0, 386.0, 379.0, 396.0, 398.0, 394.0, 352.0, 446.0, 342.0, 401.0, 381.0, 341.0, 337.0, 415.0, 377.0, 317.0, 337.0, 404.0, 392.0, 399.0, 383.0, 403.0, 341.0, 397.0, 392.0, 365.0, 358.0, 363.0, 301.0, 427.0, 418.0, 416.0, 348.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11236988954856225, "mean_inference_ms": 0.7438218590429903, "mean_action_processing_ms": 0.03887727706372852, "mean_env_wait_ms": 0.11655406704101817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009907960891723633, "StateBufferConnector_ms": 0.0015807151794433594, "ViewRequirementAgentConnector_ms": 0.03356790542602539}, "num_episodes": 40, "episode_return_max": 472.0, "episode_return_min": 222.0, "episode_return_mean": 366.05, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.4417083476653, "num_env_steps_trained_throughput_per_sec": 497.4417083476653, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 8509.577, "restore_workers_time_ms": 0.02, "training_step_time_ms": 8509.288, "sample_time_ms": 4036.924, "load_time_ms": 1.558, "load_throughput": 2567847.644, "learn_time_ms": 4470.122, "learn_throughput": 894.83, "synch_weights_time_ms": 0.019}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 280, "training_iteration": 7, "trial_id": "default", "date": "2024-05-19_18-12-44", "timestamp": 1716167564, "time_this_iter_s": 8.04282808303833, "time_total_s": 59.57535362243652, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 59.57535362243652, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 29.090909090909086, "ram_util_percent": 82.61818181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.80733025381642, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.003, "total_loss": 9.938254218973139, "policy_loss": -0.07548320451050355, "vf_loss": 9.873523221990114, "vf_explained_var": 0.02054134690633384, "kl": 0.04103204789550394, "entropy": 1.5329614998191916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 446.0, "episode_reward_min": 263.0, "episode_reward_mean": 374.6, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.0, 399.0, 367.0, 349.0, 396.0, 342.0, 318.0, 379.0, 351.0, 338.0, 369.0, 294.0, 392.0, 324.0, 433.0, 304.0, 285.0, 427.0, 409.0, 263.0, 302.0, 362.0, 346.0, 367.0, 380.0, 405.0, 407.0, 347.0, 386.0, 379.0, 396.0, 398.0, 394.0, 352.0, 446.0, 342.0, 401.0, 381.0, 341.0, 337.0, 415.0, 377.0, 317.0, 337.0, 404.0, 392.0, 399.0, 383.0, 403.0, 341.0, 397.0, 392.0, 365.0, 358.0, 363.0, 301.0, 427.0, 418.0, 416.0, 348.0, 418.0, 362.0, 397.0, 372.0, 373.0, 384.0, 428.0, 379.0, 398.0, 390.0, 410.0, 353.0, 332.0, 418.0, 400.0, 427.0, 412.0, 395.0, 404.0, 323.0, 381.0, 401.0, 440.0, 376.0, 369.0, 384.0, 380.0, 378.0, 353.0, 334.0, 368.0, 411.0, 419.0, 410.0, 347.0, 405.0, 319.0, 403.0, 424.0, 355.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11123421770361996, "mean_inference_ms": 0.7373262742403855, "mean_action_processing_ms": 0.038499931178091876, "mean_env_wait_ms": 0.11594521049977559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00800180435180664, "StateBufferConnector_ms": 0.0013930797576904297, "ViewRequirementAgentConnector_ms": 0.03201150894165039}, "num_episodes": 40, "episode_return_max": 446.0, "episode_return_min": 263.0, "episode_return_mean": 374.6}, "env_runner_results": {"episode_reward_max": 446.0, "episode_reward_min": 263.0, "episode_reward_mean": 374.6, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.0, 399.0, 367.0, 349.0, 396.0, 342.0, 318.0, 379.0, 351.0, 338.0, 369.0, 294.0, 392.0, 324.0, 433.0, 304.0, 285.0, 427.0, 409.0, 263.0, 302.0, 362.0, 346.0, 367.0, 380.0, 405.0, 407.0, 347.0, 386.0, 379.0, 396.0, 398.0, 394.0, 352.0, 446.0, 342.0, 401.0, 381.0, 341.0, 337.0, 415.0, 377.0, 317.0, 337.0, 404.0, 392.0, 399.0, 383.0, 403.0, 341.0, 397.0, 392.0, 365.0, 358.0, 363.0, 301.0, 427.0, 418.0, 416.0, 348.0, 418.0, 362.0, 397.0, 372.0, 373.0, 384.0, 428.0, 379.0, 398.0, 390.0, 410.0, 353.0, 332.0, 418.0, 400.0, 427.0, 412.0, 395.0, 404.0, 323.0, 381.0, 401.0, 440.0, 376.0, 369.0, 384.0, 380.0, 378.0, 353.0, 334.0, 368.0, 411.0, 419.0, 410.0, 347.0, 405.0, 319.0, 403.0, 424.0, 355.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11123421770361996, "mean_inference_ms": 0.7373262742403855, "mean_action_processing_ms": 0.038499931178091876, "mean_env_wait_ms": 0.11594521049977559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00800180435180664, "StateBufferConnector_ms": 0.0013930797576904297, "ViewRequirementAgentConnector_ms": 0.03201150894165039}, "num_episodes": 40, "episode_return_max": 446.0, "episode_return_min": 263.0, "episode_return_mean": 374.6}, "episode_reward_max": 446.0, "episode_reward_min": 263.0, "episode_reward_mean": 374.6, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [267.0, 399.0, 367.0, 349.0, 396.0, 342.0, 318.0, 379.0, 351.0, 338.0, 369.0, 294.0, 392.0, 324.0, 433.0, 304.0, 285.0, 427.0, 409.0, 263.0, 302.0, 362.0, 346.0, 367.0, 380.0, 405.0, 407.0, 347.0, 386.0, 379.0, 396.0, 398.0, 394.0, 352.0, 446.0, 342.0, 401.0, 381.0, 341.0, 337.0, 415.0, 377.0, 317.0, 337.0, 404.0, 392.0, 399.0, 383.0, 403.0, 341.0, 397.0, 392.0, 365.0, 358.0, 363.0, 301.0, 427.0, 418.0, 416.0, 348.0, 418.0, 362.0, 397.0, 372.0, 373.0, 384.0, 428.0, 379.0, 398.0, 390.0, 410.0, 353.0, 332.0, 418.0, 400.0, 427.0, 412.0, 395.0, 404.0, 323.0, 381.0, 401.0, 440.0, 376.0, 369.0, 384.0, 380.0, 378.0, 353.0, 334.0, 368.0, 411.0, 419.0, 410.0, 347.0, 405.0, 319.0, 403.0, 424.0, 355.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11123421770361996, "mean_inference_ms": 0.7373262742403855, "mean_action_processing_ms": 0.038499931178091876, "mean_env_wait_ms": 0.11594521049977559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00800180435180664, "StateBufferConnector_ms": 0.0013930797576904297, "ViewRequirementAgentConnector_ms": 0.03201150894165039}, "num_episodes": 40, "episode_return_max": 446.0, "episode_return_min": 263.0, "episode_return_mean": 374.6, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.7731412254131, "num_env_steps_trained_throughput_per_sec": 501.7731412254131, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 8442.348, "restore_workers_time_ms": 0.019, "training_step_time_ms": 8442.086, "sample_time_ms": 4010.031, "load_time_ms": 1.878, "load_throughput": 2130473.944, "learn_time_ms": 4429.523, "learn_throughput": 903.032, "synch_weights_time_ms": 0.019}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 320, "training_iteration": 8, "trial_id": "default", "date": "2024-05-19_18-12-52", "timestamp": 1716167572, "time_this_iter_s": 7.972588062286377, "time_total_s": 67.5479416847229, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 67.5479416847229, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 30.918181818181814, "ram_util_percent": 84.02727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.450129844296363, "cur_kl_coeff": 5.12578125, "cur_lr": 0.003, "total_loss": 9.971323546542916, "policy_loss": -0.07222399890262593, "vf_loss": 9.871854771849929, "vf_explained_var": 0.018618228550880186, "kl": 0.03349592405665861, "entropy": 1.5942392104415484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 440.0, "episode_reward_min": 301.0, "episode_reward_mean": 382.92, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [415.0, 377.0, 317.0, 337.0, 404.0, 392.0, 399.0, 383.0, 403.0, 341.0, 397.0, 392.0, 365.0, 358.0, 363.0, 301.0, 427.0, 418.0, 416.0, 348.0, 418.0, 362.0, 397.0, 372.0, 373.0, 384.0, 428.0, 379.0, 398.0, 390.0, 410.0, 353.0, 332.0, 418.0, 400.0, 427.0, 412.0, 395.0, 404.0, 323.0, 381.0, 401.0, 440.0, 376.0, 369.0, 384.0, 380.0, 378.0, 353.0, 334.0, 368.0, 411.0, 419.0, 410.0, 347.0, 405.0, 319.0, 403.0, 424.0, 355.0, 391.0, 391.0, 398.0, 431.0, 313.0, 433.0, 421.0, 375.0, 412.0, 400.0, 344.0, 356.0, 380.0, 406.0, 387.0, 383.0, 405.0, 350.0, 346.0, 410.0, 391.0, 361.0, 359.0, 409.0, 393.0, 420.0, 371.0, 332.0, 360.0, 381.0, 329.0, 355.0, 405.0, 366.0, 408.0, 431.0, 397.0, 365.0, 365.0, 377.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11098041637983108, "mean_inference_ms": 0.7364753065909091, "mean_action_processing_ms": 0.03841257133436729, "mean_env_wait_ms": 0.11595360724900029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008303403854370117, "StateBufferConnector_ms": 0.0014317035675048828, "ViewRequirementAgentConnector_ms": 0.036458492279052734}, "num_episodes": 40, "episode_return_max": 440.0, "episode_return_min": 301.0, "episode_return_mean": 382.92}, "env_runner_results": {"episode_reward_max": 440.0, "episode_reward_min": 301.0, "episode_reward_mean": 382.92, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [415.0, 377.0, 317.0, 337.0, 404.0, 392.0, 399.0, 383.0, 403.0, 341.0, 397.0, 392.0, 365.0, 358.0, 363.0, 301.0, 427.0, 418.0, 416.0, 348.0, 418.0, 362.0, 397.0, 372.0, 373.0, 384.0, 428.0, 379.0, 398.0, 390.0, 410.0, 353.0, 332.0, 418.0, 400.0, 427.0, 412.0, 395.0, 404.0, 323.0, 381.0, 401.0, 440.0, 376.0, 369.0, 384.0, 380.0, 378.0, 353.0, 334.0, 368.0, 411.0, 419.0, 410.0, 347.0, 405.0, 319.0, 403.0, 424.0, 355.0, 391.0, 391.0, 398.0, 431.0, 313.0, 433.0, 421.0, 375.0, 412.0, 400.0, 344.0, 356.0, 380.0, 406.0, 387.0, 383.0, 405.0, 350.0, 346.0, 410.0, 391.0, 361.0, 359.0, 409.0, 393.0, 420.0, 371.0, 332.0, 360.0, 381.0, 329.0, 355.0, 405.0, 366.0, 408.0, 431.0, 397.0, 365.0, 365.0, 377.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11098041637983108, "mean_inference_ms": 0.7364753065909091, "mean_action_processing_ms": 0.03841257133436729, "mean_env_wait_ms": 0.11595360724900029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008303403854370117, "StateBufferConnector_ms": 0.0014317035675048828, "ViewRequirementAgentConnector_ms": 0.036458492279052734}, "num_episodes": 40, "episode_return_max": 440.0, "episode_return_min": 301.0, "episode_return_mean": 382.92}, "episode_reward_max": 440.0, "episode_reward_min": 301.0, "episode_reward_mean": 382.92, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [415.0, 377.0, 317.0, 337.0, 404.0, 392.0, 399.0, 383.0, 403.0, 341.0, 397.0, 392.0, 365.0, 358.0, 363.0, 301.0, 427.0, 418.0, 416.0, 348.0, 418.0, 362.0, 397.0, 372.0, 373.0, 384.0, 428.0, 379.0, 398.0, 390.0, 410.0, 353.0, 332.0, 418.0, 400.0, 427.0, 412.0, 395.0, 404.0, 323.0, 381.0, 401.0, 440.0, 376.0, 369.0, 384.0, 380.0, 378.0, 353.0, 334.0, 368.0, 411.0, 419.0, 410.0, 347.0, 405.0, 319.0, 403.0, 424.0, 355.0, 391.0, 391.0, 398.0, 431.0, 313.0, 433.0, 421.0, 375.0, 412.0, 400.0, 344.0, 356.0, 380.0, 406.0, 387.0, 383.0, 405.0, 350.0, 346.0, 410.0, 391.0, 361.0, 359.0, 409.0, 393.0, 420.0, 371.0, 332.0, 360.0, 381.0, 329.0, 355.0, 405.0, 366.0, 408.0, 431.0, 397.0, 365.0, 365.0, 377.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11098041637983108, "mean_inference_ms": 0.7364753065909091, "mean_action_processing_ms": 0.03841257133436729, "mean_env_wait_ms": 0.11595360724900029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008303403854370117, "StateBufferConnector_ms": 0.0014317035675048828, "ViewRequirementAgentConnector_ms": 0.036458492279052734}, "num_episodes": 40, "episode_return_max": 440.0, "episode_return_min": 301.0, "episode_return_mean": 382.92, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 468.38450855143185, "num_env_steps_trained_throughput_per_sec": 468.38450855143185, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 8453.2, "restore_workers_time_ms": 0.018, "training_step_time_ms": 8452.956, "sample_time_ms": 4043.477, "load_time_ms": 1.869, "load_throughput": 2140163.338, "learn_time_ms": 4406.94, "learn_throughput": 907.659, "synch_weights_time_ms": 0.02}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 360, "training_iteration": 9, "trial_id": "default", "date": "2024-05-19_18-13-00", "timestamp": 1716167580, "time_this_iter_s": 8.541635751724243, "time_total_s": 76.08957743644714, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 76.08957743644714, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 36.09166666666667, "ram_util_percent": 85.65000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.17218242358136, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.003, "total_loss": 10.007274828674973, "policy_loss": -0.05940996565685798, "vf_loss": 9.87658500568841, "vf_explained_var": 0.009315811562281782, "kl": 0.024724662269755882, "entropy": 1.615376070878839, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 453.0, "episode_reward_min": 313.0, "episode_reward_mean": 386.51, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [381.0, 401.0, 440.0, 376.0, 369.0, 384.0, 380.0, 378.0, 353.0, 334.0, 368.0, 411.0, 419.0, 410.0, 347.0, 405.0, 319.0, 403.0, 424.0, 355.0, 391.0, 391.0, 398.0, 431.0, 313.0, 433.0, 421.0, 375.0, 412.0, 400.0, 344.0, 356.0, 380.0, 406.0, 387.0, 383.0, 405.0, 350.0, 346.0, 410.0, 391.0, 361.0, 359.0, 409.0, 393.0, 420.0, 371.0, 332.0, 360.0, 381.0, 329.0, 355.0, 405.0, 366.0, 408.0, 431.0, 397.0, 365.0, 365.0, 377.0, 363.0, 398.0, 397.0, 434.0, 371.0, 387.0, 378.0, 373.0, 439.0, 393.0, 413.0, 396.0, 410.0, 406.0, 441.0, 362.0, 374.0, 402.0, 338.0, 368.0, 393.0, 398.0, 371.0, 373.0, 367.0, 346.0, 347.0, 428.0, 337.0, 404.0, 410.0, 453.0, 416.0, 336.0, 377.0, 441.0, 421.0, 427.0, 411.0, 388.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11092193942660349, "mean_inference_ms": 0.7365887794565384, "mean_action_processing_ms": 0.038385819845058684, "mean_env_wait_ms": 0.11601981245101702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008395671844482422, "StateBufferConnector_ms": 0.0015435218811035156, "ViewRequirementAgentConnector_ms": 0.03671836853027344}, "num_episodes": 40, "episode_return_max": 453.0, "episode_return_min": 313.0, "episode_return_mean": 386.51}, "env_runner_results": {"episode_reward_max": 453.0, "episode_reward_min": 313.0, "episode_reward_mean": 386.51, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [381.0, 401.0, 440.0, 376.0, 369.0, 384.0, 380.0, 378.0, 353.0, 334.0, 368.0, 411.0, 419.0, 410.0, 347.0, 405.0, 319.0, 403.0, 424.0, 355.0, 391.0, 391.0, 398.0, 431.0, 313.0, 433.0, 421.0, 375.0, 412.0, 400.0, 344.0, 356.0, 380.0, 406.0, 387.0, 383.0, 405.0, 350.0, 346.0, 410.0, 391.0, 361.0, 359.0, 409.0, 393.0, 420.0, 371.0, 332.0, 360.0, 381.0, 329.0, 355.0, 405.0, 366.0, 408.0, 431.0, 397.0, 365.0, 365.0, 377.0, 363.0, 398.0, 397.0, 434.0, 371.0, 387.0, 378.0, 373.0, 439.0, 393.0, 413.0, 396.0, 410.0, 406.0, 441.0, 362.0, 374.0, 402.0, 338.0, 368.0, 393.0, 398.0, 371.0, 373.0, 367.0, 346.0, 347.0, 428.0, 337.0, 404.0, 410.0, 453.0, 416.0, 336.0, 377.0, 441.0, 421.0, 427.0, 411.0, 388.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11092193942660349, "mean_inference_ms": 0.7365887794565384, "mean_action_processing_ms": 0.038385819845058684, "mean_env_wait_ms": 0.11601981245101702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008395671844482422, "StateBufferConnector_ms": 0.0015435218811035156, "ViewRequirementAgentConnector_ms": 0.03671836853027344}, "num_episodes": 40, "episode_return_max": 453.0, "episode_return_min": 313.0, "episode_return_mean": 386.51}, "episode_reward_max": 453.0, "episode_reward_min": 313.0, "episode_reward_mean": 386.51, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [381.0, 401.0, 440.0, 376.0, 369.0, 384.0, 380.0, 378.0, 353.0, 334.0, 368.0, 411.0, 419.0, 410.0, 347.0, 405.0, 319.0, 403.0, 424.0, 355.0, 391.0, 391.0, 398.0, 431.0, 313.0, 433.0, 421.0, 375.0, 412.0, 400.0, 344.0, 356.0, 380.0, 406.0, 387.0, 383.0, 405.0, 350.0, 346.0, 410.0, 391.0, 361.0, 359.0, 409.0, 393.0, 420.0, 371.0, 332.0, 360.0, 381.0, 329.0, 355.0, 405.0, 366.0, 408.0, 431.0, 397.0, 365.0, 365.0, 377.0, 363.0, 398.0, 397.0, 434.0, 371.0, 387.0, 378.0, 373.0, 439.0, 393.0, 413.0, 396.0, 410.0, 406.0, 441.0, 362.0, 374.0, 402.0, 338.0, 368.0, 393.0, 398.0, 371.0, 373.0, 367.0, 346.0, 347.0, 428.0, 337.0, 404.0, 410.0, 453.0, 416.0, 336.0, 377.0, 441.0, 421.0, 427.0, 411.0, 388.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11092193942660349, "mean_inference_ms": 0.7365887794565384, "mean_action_processing_ms": 0.038385819845058684, "mean_env_wait_ms": 0.11601981245101702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008395671844482422, "StateBufferConnector_ms": 0.0015435218811035156, "ViewRequirementAgentConnector_ms": 0.03671836853027344}, "num_episodes": 40, "episode_return_max": 453.0, "episode_return_min": 313.0, "episode_return_mean": 386.51, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 454.70419131750316, "num_env_steps_trained_throughput_per_sec": 454.70419131750316, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 8487.577, "restore_workers_time_ms": 0.036, "training_step_time_ms": 8487.327, "sample_time_ms": 4023.629, "load_time_ms": 1.814, "load_throughput": 2205178.165, "learn_time_ms": 4461.217, "learn_throughput": 896.616, "synch_weights_time_ms": 0.02}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 400, "training_iteration": 10, "trial_id": "default", "date": "2024-05-19_18-13-09", "timestamp": 1716167589, "time_this_iter_s": 8.798458814620972, "time_total_s": 84.88803625106812, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 84.88803625106812, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 30.553846153846152, "ram_util_percent": 85.83076923076922}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.7070920864741, "cur_kl_coeff": 11.533007812499998, "cur_lr": 0.003, "total_loss": 10.038406110578968, "policy_loss": -0.05010702574465384, "vf_loss": 9.874949829552763, "vf_explained_var": -0.04005811522083898, "kl": 0.018517570957100736, "entropy": 1.580462880544765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 453.0, "episode_reward_min": 329.0, "episode_reward_mean": 388.03, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [391.0, 361.0, 359.0, 409.0, 393.0, 420.0, 371.0, 332.0, 360.0, 381.0, 329.0, 355.0, 405.0, 366.0, 408.0, 431.0, 397.0, 365.0, 365.0, 377.0, 363.0, 398.0, 397.0, 434.0, 371.0, 387.0, 378.0, 373.0, 439.0, 393.0, 413.0, 396.0, 410.0, 406.0, 441.0, 362.0, 374.0, 402.0, 338.0, 368.0, 393.0, 398.0, 371.0, 373.0, 367.0, 346.0, 347.0, 428.0, 337.0, 404.0, 410.0, 453.0, 416.0, 336.0, 377.0, 441.0, 421.0, 427.0, 411.0, 388.0, 367.0, 409.0, 400.0, 367.0, 386.0, 381.0, 392.0, 424.0, 403.0, 369.0, 388.0, 369.0, 419.0, 405.0, 422.0, 347.0, 362.0, 396.0, 355.0, 425.0, 343.0, 363.0, 380.0, 362.0, 414.0, 372.0, 344.0, 405.0, 373.0, 441.0, 402.0, 344.0, 347.0, 405.0, 372.0, 409.0, 447.0, 391.0, 447.0, 394.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11063121938161402, "mean_inference_ms": 0.7350221160872801, "mean_action_processing_ms": 0.038284776009978434, "mean_env_wait_ms": 0.11588517677740696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008345842361450195, "StateBufferConnector_ms": 0.0015439987182617188, "ViewRequirementAgentConnector_ms": 0.03579998016357422}, "num_episodes": 40, "episode_return_max": 453.0, "episode_return_min": 329.0, "episode_return_mean": 388.03}, "env_runner_results": {"episode_reward_max": 453.0, "episode_reward_min": 329.0, "episode_reward_mean": 388.03, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [391.0, 361.0, 359.0, 409.0, 393.0, 420.0, 371.0, 332.0, 360.0, 381.0, 329.0, 355.0, 405.0, 366.0, 408.0, 431.0, 397.0, 365.0, 365.0, 377.0, 363.0, 398.0, 397.0, 434.0, 371.0, 387.0, 378.0, 373.0, 439.0, 393.0, 413.0, 396.0, 410.0, 406.0, 441.0, 362.0, 374.0, 402.0, 338.0, 368.0, 393.0, 398.0, 371.0, 373.0, 367.0, 346.0, 347.0, 428.0, 337.0, 404.0, 410.0, 453.0, 416.0, 336.0, 377.0, 441.0, 421.0, 427.0, 411.0, 388.0, 367.0, 409.0, 400.0, 367.0, 386.0, 381.0, 392.0, 424.0, 403.0, 369.0, 388.0, 369.0, 419.0, 405.0, 422.0, 347.0, 362.0, 396.0, 355.0, 425.0, 343.0, 363.0, 380.0, 362.0, 414.0, 372.0, 344.0, 405.0, 373.0, 441.0, 402.0, 344.0, 347.0, 405.0, 372.0, 409.0, 447.0, 391.0, 447.0, 394.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11063121938161402, "mean_inference_ms": 0.7350221160872801, "mean_action_processing_ms": 0.038284776009978434, "mean_env_wait_ms": 0.11588517677740696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008345842361450195, "StateBufferConnector_ms": 0.0015439987182617188, "ViewRequirementAgentConnector_ms": 0.03579998016357422}, "num_episodes": 40, "episode_return_max": 453.0, "episode_return_min": 329.0, "episode_return_mean": 388.03}, "episode_reward_max": 453.0, "episode_reward_min": 329.0, "episode_reward_mean": 388.03, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [391.0, 361.0, 359.0, 409.0, 393.0, 420.0, 371.0, 332.0, 360.0, 381.0, 329.0, 355.0, 405.0, 366.0, 408.0, 431.0, 397.0, 365.0, 365.0, 377.0, 363.0, 398.0, 397.0, 434.0, 371.0, 387.0, 378.0, 373.0, 439.0, 393.0, 413.0, 396.0, 410.0, 406.0, 441.0, 362.0, 374.0, 402.0, 338.0, 368.0, 393.0, 398.0, 371.0, 373.0, 367.0, 346.0, 347.0, 428.0, 337.0, 404.0, 410.0, 453.0, 416.0, 336.0, 377.0, 441.0, 421.0, 427.0, 411.0, 388.0, 367.0, 409.0, 400.0, 367.0, 386.0, 381.0, 392.0, 424.0, 403.0, 369.0, 388.0, 369.0, 419.0, 405.0, 422.0, 347.0, 362.0, 396.0, 355.0, 425.0, 343.0, 363.0, 380.0, 362.0, 414.0, 372.0, 344.0, 405.0, 373.0, 441.0, 402.0, 344.0, 347.0, 405.0, 372.0, 409.0, 447.0, 391.0, 447.0, 394.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11063121938161402, "mean_inference_ms": 0.7350221160872801, "mean_action_processing_ms": 0.038284776009978434, "mean_env_wait_ms": 0.11588517677740696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008345842361450195, "StateBufferConnector_ms": 0.0015439987182617188, "ViewRequirementAgentConnector_ms": 0.03579998016357422}, "num_episodes": 40, "episode_return_max": 453.0, "episode_return_min": 329.0, "episode_return_mean": 388.03, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 450.4961529487919, "num_env_steps_trained_throughput_per_sec": 450.4961529487919, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 8458.854, "restore_workers_time_ms": 0.035, "training_step_time_ms": 8458.743, "sample_time_ms": 3994.58, "load_time_ms": 2.079, "load_throughput": 1924367.824, "learn_time_ms": 4461.331, "learn_throughput": 896.593, "synch_weights_time_ms": 0.021}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 440, "training_iteration": 11, "trial_id": "default", "date": "2024-05-19_18-13-18", "timestamp": 1716167598, "time_this_iter_s": 8.88008427619934, "time_total_s": 93.76812052726746, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 93.76812052726746, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 38.53076923076924, "ram_util_percent": 85.76153846153845}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.275751586883299, "cur_kl_coeff": 11.533007812499998, "cur_lr": 0.003, "total_loss": 9.981834859745478, "policy_loss": -0.05041115590000665, "vf_loss": 9.868241522389074, "vf_explained_var": -0.04842041397607455, "kl": 0.014220446945786152, "entropy": 1.6128427895166542, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 457.0, "episode_reward_min": 336.0, "episode_reward_mean": 389.85, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [393.0, 398.0, 371.0, 373.0, 367.0, 346.0, 347.0, 428.0, 337.0, 404.0, 410.0, 453.0, 416.0, 336.0, 377.0, 441.0, 421.0, 427.0, 411.0, 388.0, 367.0, 409.0, 400.0, 367.0, 386.0, 381.0, 392.0, 424.0, 403.0, 369.0, 388.0, 369.0, 419.0, 405.0, 422.0, 347.0, 362.0, 396.0, 355.0, 425.0, 343.0, 363.0, 380.0, 362.0, 414.0, 372.0, 344.0, 405.0, 373.0, 441.0, 402.0, 344.0, 347.0, 405.0, 372.0, 409.0, 447.0, 391.0, 447.0, 394.0, 371.0, 336.0, 405.0, 425.0, 359.0, 355.0, 428.0, 457.0, 407.0, 346.0, 368.0, 388.0, 413.0, 422.0, 394.0, 422.0, 405.0, 403.0, 391.0, 359.0, 369.0, 435.0, 374.0, 416.0, 380.0, 348.0, 408.0, 386.0, 383.0, 384.0, 358.0, 385.0, 374.0, 350.0, 430.0, 418.0, 370.0, 400.0, 421.0, 357.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11118765382648654, "mean_inference_ms": 0.7355980080628903, "mean_action_processing_ms": 0.03834366284962848, "mean_env_wait_ms": 0.11597797547411483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009602785110473633, "StateBufferConnector_ms": 0.0014955997467041016, "ViewRequirementAgentConnector_ms": 0.03693222999572754}, "num_episodes": 40, "episode_return_max": 457.0, "episode_return_min": 336.0, "episode_return_mean": 389.85}, "env_runner_results": {"episode_reward_max": 457.0, "episode_reward_min": 336.0, "episode_reward_mean": 389.85, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [393.0, 398.0, 371.0, 373.0, 367.0, 346.0, 347.0, 428.0, 337.0, 404.0, 410.0, 453.0, 416.0, 336.0, 377.0, 441.0, 421.0, 427.0, 411.0, 388.0, 367.0, 409.0, 400.0, 367.0, 386.0, 381.0, 392.0, 424.0, 403.0, 369.0, 388.0, 369.0, 419.0, 405.0, 422.0, 347.0, 362.0, 396.0, 355.0, 425.0, 343.0, 363.0, 380.0, 362.0, 414.0, 372.0, 344.0, 405.0, 373.0, 441.0, 402.0, 344.0, 347.0, 405.0, 372.0, 409.0, 447.0, 391.0, 447.0, 394.0, 371.0, 336.0, 405.0, 425.0, 359.0, 355.0, 428.0, 457.0, 407.0, 346.0, 368.0, 388.0, 413.0, 422.0, 394.0, 422.0, 405.0, 403.0, 391.0, 359.0, 369.0, 435.0, 374.0, 416.0, 380.0, 348.0, 408.0, 386.0, 383.0, 384.0, 358.0, 385.0, 374.0, 350.0, 430.0, 418.0, 370.0, 400.0, 421.0, 357.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11118765382648654, "mean_inference_ms": 0.7355980080628903, "mean_action_processing_ms": 0.03834366284962848, "mean_env_wait_ms": 0.11597797547411483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009602785110473633, "StateBufferConnector_ms": 0.0014955997467041016, "ViewRequirementAgentConnector_ms": 0.03693222999572754}, "num_episodes": 40, "episode_return_max": 457.0, "episode_return_min": 336.0, "episode_return_mean": 389.85}, "episode_reward_max": 457.0, "episode_reward_min": 336.0, "episode_reward_mean": 389.85, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [393.0, 398.0, 371.0, 373.0, 367.0, 346.0, 347.0, 428.0, 337.0, 404.0, 410.0, 453.0, 416.0, 336.0, 377.0, 441.0, 421.0, 427.0, 411.0, 388.0, 367.0, 409.0, 400.0, 367.0, 386.0, 381.0, 392.0, 424.0, 403.0, 369.0, 388.0, 369.0, 419.0, 405.0, 422.0, 347.0, 362.0, 396.0, 355.0, 425.0, 343.0, 363.0, 380.0, 362.0, 414.0, 372.0, 344.0, 405.0, 373.0, 441.0, 402.0, 344.0, 347.0, 405.0, 372.0, 409.0, 447.0, 391.0, 447.0, 394.0, 371.0, 336.0, 405.0, 425.0, 359.0, 355.0, 428.0, 457.0, 407.0, 346.0, 368.0, 388.0, 413.0, 422.0, 394.0, 422.0, 405.0, 403.0, 391.0, 359.0, 369.0, 435.0, 374.0, 416.0, 380.0, 348.0, 408.0, 386.0, 383.0, 384.0, 358.0, 385.0, 374.0, 350.0, 430.0, 418.0, 370.0, 400.0, 421.0, 357.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11118765382648654, "mean_inference_ms": 0.7355980080628903, "mean_action_processing_ms": 0.03834366284962848, "mean_env_wait_ms": 0.11597797547411483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009602785110473633, "StateBufferConnector_ms": 0.0014955997467041016, "ViewRequirementAgentConnector_ms": 0.03693222999572754}, "num_episodes": 40, "episode_return_max": 457.0, "episode_return_min": 336.0, "episode_return_mean": 389.85, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 451.34669309877273, "num_env_steps_trained_throughput_per_sec": 451.34669309877273, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 8504.192, "restore_workers_time_ms": 0.035, "training_step_time_ms": 8504.081, "sample_time_ms": 4062.811, "load_time_ms": 2.015, "load_throughput": 1984929.073, "learn_time_ms": 4438.528, "learn_throughput": 901.2, "synch_weights_time_ms": 0.021}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 480, "training_iteration": 12, "trial_id": "default", "date": "2024-05-19_18-13-27", "timestamp": 1716167607, "time_this_iter_s": 8.863504886627197, "time_total_s": 102.63162541389465, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 102.63162541389465, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 46.791666666666664, "ram_util_percent": 84.875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.142361597861013, "cur_kl_coeff": 11.533007812499998, "cur_lr": 0.003, "total_loss": 9.96961453653151, "policy_loss": -0.04537153019599857, "vf_loss": 9.860597517157114, "vf_explained_var": -0.08868408779944142, "kl": 0.013386666632816896, "entropy": 1.6508493587534914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 460.0, "episode_reward_min": 309.0, "episode_reward_mean": 390.35, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [343.0, 363.0, 380.0, 362.0, 414.0, 372.0, 344.0, 405.0, 373.0, 441.0, 402.0, 344.0, 347.0, 405.0, 372.0, 409.0, 447.0, 391.0, 447.0, 394.0, 371.0, 336.0, 405.0, 425.0, 359.0, 355.0, 428.0, 457.0, 407.0, 346.0, 368.0, 388.0, 413.0, 422.0, 394.0, 422.0, 405.0, 403.0, 391.0, 359.0, 369.0, 435.0, 374.0, 416.0, 380.0, 348.0, 408.0, 386.0, 383.0, 384.0, 358.0, 385.0, 374.0, 350.0, 430.0, 418.0, 370.0, 400.0, 421.0, 357.0, 410.0, 334.0, 431.0, 384.0, 432.0, 377.0, 351.0, 352.0, 378.0, 403.0, 316.0, 394.0, 378.0, 398.0, 426.0, 427.0, 375.0, 393.0, 410.0, 309.0, 399.0, 378.0, 448.0, 400.0, 394.0, 460.0, 402.0, 385.0, 369.0, 384.0, 411.0, 382.0, 419.0, 427.0, 409.0, 352.0, 385.0, 364.0, 431.0, 403.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11184503391362766, "mean_inference_ms": 0.7369524241374168, "mean_action_processing_ms": 0.03844473857060422, "mean_env_wait_ms": 0.11615532105288626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010081052780151367, "StateBufferConnector_ms": 0.0014874935150146484, "ViewRequirementAgentConnector_ms": 0.03775382041931152}, "num_episodes": 40, "episode_return_max": 460.0, "episode_return_min": 309.0, "episode_return_mean": 390.35}, "env_runner_results": {"episode_reward_max": 460.0, "episode_reward_min": 309.0, "episode_reward_mean": 390.35, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [343.0, 363.0, 380.0, 362.0, 414.0, 372.0, 344.0, 405.0, 373.0, 441.0, 402.0, 344.0, 347.0, 405.0, 372.0, 409.0, 447.0, 391.0, 447.0, 394.0, 371.0, 336.0, 405.0, 425.0, 359.0, 355.0, 428.0, 457.0, 407.0, 346.0, 368.0, 388.0, 413.0, 422.0, 394.0, 422.0, 405.0, 403.0, 391.0, 359.0, 369.0, 435.0, 374.0, 416.0, 380.0, 348.0, 408.0, 386.0, 383.0, 384.0, 358.0, 385.0, 374.0, 350.0, 430.0, 418.0, 370.0, 400.0, 421.0, 357.0, 410.0, 334.0, 431.0, 384.0, 432.0, 377.0, 351.0, 352.0, 378.0, 403.0, 316.0, 394.0, 378.0, 398.0, 426.0, 427.0, 375.0, 393.0, 410.0, 309.0, 399.0, 378.0, 448.0, 400.0, 394.0, 460.0, 402.0, 385.0, 369.0, 384.0, 411.0, 382.0, 419.0, 427.0, 409.0, 352.0, 385.0, 364.0, 431.0, 403.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11184503391362766, "mean_inference_ms": 0.7369524241374168, "mean_action_processing_ms": 0.03844473857060422, "mean_env_wait_ms": 0.11615532105288626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010081052780151367, "StateBufferConnector_ms": 0.0014874935150146484, "ViewRequirementAgentConnector_ms": 0.03775382041931152}, "num_episodes": 40, "episode_return_max": 460.0, "episode_return_min": 309.0, "episode_return_mean": 390.35}, "episode_reward_max": 460.0, "episode_reward_min": 309.0, "episode_reward_mean": 390.35, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [343.0, 363.0, 380.0, 362.0, 414.0, 372.0, 344.0, 405.0, 373.0, 441.0, 402.0, 344.0, 347.0, 405.0, 372.0, 409.0, 447.0, 391.0, 447.0, 394.0, 371.0, 336.0, 405.0, 425.0, 359.0, 355.0, 428.0, 457.0, 407.0, 346.0, 368.0, 388.0, 413.0, 422.0, 394.0, 422.0, 405.0, 403.0, 391.0, 359.0, 369.0, 435.0, 374.0, 416.0, 380.0, 348.0, 408.0, 386.0, 383.0, 384.0, 358.0, 385.0, 374.0, 350.0, 430.0, 418.0, 370.0, 400.0, 421.0, 357.0, 410.0, 334.0, 431.0, 384.0, 432.0, 377.0, 351.0, 352.0, 378.0, 403.0, 316.0, 394.0, 378.0, 398.0, 426.0, 427.0, 375.0, 393.0, 410.0, 309.0, 399.0, 378.0, 448.0, 400.0, 394.0, 460.0, 402.0, 385.0, 369.0, 384.0, 411.0, 382.0, 419.0, 427.0, 409.0, 352.0, 385.0, 364.0, 431.0, 403.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11184503391362766, "mean_inference_ms": 0.7369524241374168, "mean_action_processing_ms": 0.03844473857060422, "mean_env_wait_ms": 0.11615532105288626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010081052780151367, "StateBufferConnector_ms": 0.0014874935150146484, "ViewRequirementAgentConnector_ms": 0.03775382041931152}, "num_episodes": 40, "episode_return_max": 460.0, "episode_return_min": 309.0, "episode_return_mean": 390.35, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 469.49612914841936, "num_env_steps_trained_throughput_per_sec": 469.49612914841936, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 8534.992, "restore_workers_time_ms": 0.035, "training_step_time_ms": 8534.879, "sample_time_ms": 4075.688, "load_time_ms": 2.072, "load_throughput": 1930701.405, "learn_time_ms": 4456.373, "learn_throughput": 897.591, "synch_weights_time_ms": 0.021}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 520, "training_iteration": 13, "trial_id": "default", "date": "2024-05-19_18-13-35", "timestamp": 1716167615, "time_this_iter_s": 8.521471977233887, "time_total_s": 111.15309739112854, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 111.15309739112854, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 42.1, "ram_util_percent": 83.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.12429102877135, "cur_kl_coeff": 11.533007812499998, "cur_lr": 0.003, "total_loss": 9.95116768396029, "policy_loss": -0.04470564958198817, "vf_loss": 9.86608951322494, "vf_explained_var": -0.06386653569436843, "kl": 0.011253250441472162, "entropy": 1.6441567558114247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 460.0, "episode_reward_min": 309.0, "episode_reward_mean": 388.09, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [369.0, 435.0, 374.0, 416.0, 380.0, 348.0, 408.0, 386.0, 383.0, 384.0, 358.0, 385.0, 374.0, 350.0, 430.0, 418.0, 370.0, 400.0, 421.0, 357.0, 410.0, 334.0, 431.0, 384.0, 432.0, 377.0, 351.0, 352.0, 378.0, 403.0, 316.0, 394.0, 378.0, 398.0, 426.0, 427.0, 375.0, 393.0, 410.0, 309.0, 399.0, 378.0, 448.0, 400.0, 394.0, 460.0, 402.0, 385.0, 369.0, 384.0, 411.0, 382.0, 419.0, 427.0, 409.0, 352.0, 385.0, 364.0, 431.0, 403.0, 376.0, 382.0, 368.0, 357.0, 377.0, 388.0, 403.0, 420.0, 371.0, 402.0, 419.0, 361.0, 386.0, 339.0, 411.0, 372.0, 374.0, 424.0, 377.0, 364.0, 359.0, 360.0, 421.0, 398.0, 395.0, 423.0, 386.0, 311.0, 328.0, 415.0, 412.0, 362.0, 340.0, 373.0, 413.0, 380.0, 422.0, 447.0, 388.0, 379.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11292442184391195, "mean_inference_ms": 0.740284126103204, "mean_action_processing_ms": 0.03865644861819605, "mean_env_wait_ms": 0.1167057132188176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01030588150024414, "StateBufferConnector_ms": 0.0015528202056884766, "ViewRequirementAgentConnector_ms": 0.039608001708984375}, "num_episodes": 40, "episode_return_max": 460.0, "episode_return_min": 309.0, "episode_return_mean": 388.09}, "env_runner_results": {"episode_reward_max": 460.0, "episode_reward_min": 309.0, "episode_reward_mean": 388.09, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [369.0, 435.0, 374.0, 416.0, 380.0, 348.0, 408.0, 386.0, 383.0, 384.0, 358.0, 385.0, 374.0, 350.0, 430.0, 418.0, 370.0, 400.0, 421.0, 357.0, 410.0, 334.0, 431.0, 384.0, 432.0, 377.0, 351.0, 352.0, 378.0, 403.0, 316.0, 394.0, 378.0, 398.0, 426.0, 427.0, 375.0, 393.0, 410.0, 309.0, 399.0, 378.0, 448.0, 400.0, 394.0, 460.0, 402.0, 385.0, 369.0, 384.0, 411.0, 382.0, 419.0, 427.0, 409.0, 352.0, 385.0, 364.0, 431.0, 403.0, 376.0, 382.0, 368.0, 357.0, 377.0, 388.0, 403.0, 420.0, 371.0, 402.0, 419.0, 361.0, 386.0, 339.0, 411.0, 372.0, 374.0, 424.0, 377.0, 364.0, 359.0, 360.0, 421.0, 398.0, 395.0, 423.0, 386.0, 311.0, 328.0, 415.0, 412.0, 362.0, 340.0, 373.0, 413.0, 380.0, 422.0, 447.0, 388.0, 379.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11292442184391195, "mean_inference_ms": 0.740284126103204, "mean_action_processing_ms": 0.03865644861819605, "mean_env_wait_ms": 0.1167057132188176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01030588150024414, "StateBufferConnector_ms": 0.0015528202056884766, "ViewRequirementAgentConnector_ms": 0.039608001708984375}, "num_episodes": 40, "episode_return_max": 460.0, "episode_return_min": 309.0, "episode_return_mean": 388.09}, "episode_reward_max": 460.0, "episode_reward_min": 309.0, "episode_reward_mean": 388.09, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [369.0, 435.0, 374.0, 416.0, 380.0, 348.0, 408.0, 386.0, 383.0, 384.0, 358.0, 385.0, 374.0, 350.0, 430.0, 418.0, 370.0, 400.0, 421.0, 357.0, 410.0, 334.0, 431.0, 384.0, 432.0, 377.0, 351.0, 352.0, 378.0, 403.0, 316.0, 394.0, 378.0, 398.0, 426.0, 427.0, 375.0, 393.0, 410.0, 309.0, 399.0, 378.0, 448.0, 400.0, 394.0, 460.0, 402.0, 385.0, 369.0, 384.0, 411.0, 382.0, 419.0, 427.0, 409.0, 352.0, 385.0, 364.0, 431.0, 403.0, 376.0, 382.0, 368.0, 357.0, 377.0, 388.0, 403.0, 420.0, 371.0, 402.0, 419.0, 361.0, 386.0, 339.0, 411.0, 372.0, 374.0, 424.0, 377.0, 364.0, 359.0, 360.0, 421.0, 398.0, 395.0, 423.0, 386.0, 311.0, 328.0, 415.0, 412.0, 362.0, 340.0, 373.0, 413.0, 380.0, 422.0, 447.0, 388.0, 379.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11292442184391195, "mean_inference_ms": 0.740284126103204, "mean_action_processing_ms": 0.03865644861819605, "mean_env_wait_ms": 0.1167057132188176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01030588150024414, "StateBufferConnector_ms": 0.0015528202056884766, "ViewRequirementAgentConnector_ms": 0.039608001708984375}, "num_episodes": 40, "episode_return_max": 460.0, "episode_return_min": 309.0, "episode_return_mean": 388.09, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 432.4567876785144, "num_env_steps_trained_throughput_per_sec": 432.4567876785144, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 8667.527, "restore_workers_time_ms": 0.036, "training_step_time_ms": 8667.409, "sample_time_ms": 4158.204, "load_time_ms": 2.102, "load_throughput": 1902502.24, "learn_time_ms": 4506.318, "learn_throughput": 887.643, "synch_weights_time_ms": 0.023}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 560, "training_iteration": 14, "trial_id": "default", "date": "2024-05-19_18-13-44", "timestamp": 1716167624, "time_this_iter_s": 9.251466989517212, "time_total_s": 120.40456438064575, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 120.40456438064575, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 45.06923076923077, "ram_util_percent": 85.25384615384613}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.995612948171553, "cur_kl_coeff": 11.533007812499998, "cur_lr": 0.003, "total_loss": 9.98070773565641, "policy_loss": -0.04114055202132271, "vf_loss": 9.870494053953438, "vf_explained_var": -0.10990246816348004, "kl": 0.013123575125710238, "entropy": 1.6232972347608177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 464.0, "episode_reward_min": 311.0, "episode_reward_mean": 393.32, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [399.0, 378.0, 448.0, 400.0, 394.0, 460.0, 402.0, 385.0, 369.0, 384.0, 411.0, 382.0, 419.0, 427.0, 409.0, 352.0, 385.0, 364.0, 431.0, 403.0, 376.0, 382.0, 368.0, 357.0, 377.0, 388.0, 403.0, 420.0, 371.0, 402.0, 419.0, 361.0, 386.0, 339.0, 411.0, 372.0, 374.0, 424.0, 377.0, 364.0, 359.0, 360.0, 421.0, 398.0, 395.0, 423.0, 386.0, 311.0, 328.0, 415.0, 412.0, 362.0, 340.0, 373.0, 413.0, 380.0, 422.0, 447.0, 388.0, 379.0, 414.0, 403.0, 407.0, 317.0, 427.0, 412.0, 406.0, 363.0, 413.0, 464.0, 400.0, 376.0, 414.0, 404.0, 371.0, 401.0, 416.0, 395.0, 388.0, 420.0, 379.0, 392.0, 431.0, 348.0, 404.0, 457.0, 367.0, 371.0, 401.0, 442.0, 389.0, 386.0, 364.0, 416.0, 361.0, 416.0, 424.0, 434.0, 383.0, 371.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.113701400666573, "mean_inference_ms": 0.7436625578485043, "mean_action_processing_ms": 0.03883664266955012, "mean_env_wait_ms": 0.11718881011734952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00921320915222168, "StateBufferConnector_ms": 0.0015239715576171875, "ViewRequirementAgentConnector_ms": 0.03496885299682617}, "num_episodes": 40, "episode_return_max": 464.0, "episode_return_min": 311.0, "episode_return_mean": 393.32}, "env_runner_results": {"episode_reward_max": 464.0, "episode_reward_min": 311.0, "episode_reward_mean": 393.32, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [399.0, 378.0, 448.0, 400.0, 394.0, 460.0, 402.0, 385.0, 369.0, 384.0, 411.0, 382.0, 419.0, 427.0, 409.0, 352.0, 385.0, 364.0, 431.0, 403.0, 376.0, 382.0, 368.0, 357.0, 377.0, 388.0, 403.0, 420.0, 371.0, 402.0, 419.0, 361.0, 386.0, 339.0, 411.0, 372.0, 374.0, 424.0, 377.0, 364.0, 359.0, 360.0, 421.0, 398.0, 395.0, 423.0, 386.0, 311.0, 328.0, 415.0, 412.0, 362.0, 340.0, 373.0, 413.0, 380.0, 422.0, 447.0, 388.0, 379.0, 414.0, 403.0, 407.0, 317.0, 427.0, 412.0, 406.0, 363.0, 413.0, 464.0, 400.0, 376.0, 414.0, 404.0, 371.0, 401.0, 416.0, 395.0, 388.0, 420.0, 379.0, 392.0, 431.0, 348.0, 404.0, 457.0, 367.0, 371.0, 401.0, 442.0, 389.0, 386.0, 364.0, 416.0, 361.0, 416.0, 424.0, 434.0, 383.0, 371.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.113701400666573, "mean_inference_ms": 0.7436625578485043, "mean_action_processing_ms": 0.03883664266955012, "mean_env_wait_ms": 0.11718881011734952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00921320915222168, "StateBufferConnector_ms": 0.0015239715576171875, "ViewRequirementAgentConnector_ms": 0.03496885299682617}, "num_episodes": 40, "episode_return_max": 464.0, "episode_return_min": 311.0, "episode_return_mean": 393.32}, "episode_reward_max": 464.0, "episode_reward_min": 311.0, "episode_reward_mean": 393.32, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [399.0, 378.0, 448.0, 400.0, 394.0, 460.0, 402.0, 385.0, 369.0, 384.0, 411.0, 382.0, 419.0, 427.0, 409.0, 352.0, 385.0, 364.0, 431.0, 403.0, 376.0, 382.0, 368.0, 357.0, 377.0, 388.0, 403.0, 420.0, 371.0, 402.0, 419.0, 361.0, 386.0, 339.0, 411.0, 372.0, 374.0, 424.0, 377.0, 364.0, 359.0, 360.0, 421.0, 398.0, 395.0, 423.0, 386.0, 311.0, 328.0, 415.0, 412.0, 362.0, 340.0, 373.0, 413.0, 380.0, 422.0, 447.0, 388.0, 379.0, 414.0, 403.0, 407.0, 317.0, 427.0, 412.0, 406.0, 363.0, 413.0, 464.0, 400.0, 376.0, 414.0, 404.0, 371.0, 401.0, 416.0, 395.0, 388.0, 420.0, 379.0, 392.0, 431.0, 348.0, 404.0, 457.0, 367.0, 371.0, 401.0, 442.0, 389.0, 386.0, 364.0, 416.0, 361.0, 416.0, 424.0, 434.0, 383.0, 371.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.113701400666573, "mean_inference_ms": 0.7436625578485043, "mean_action_processing_ms": 0.03883664266955012, "mean_env_wait_ms": 0.11718881011734952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00921320915222168, "StateBufferConnector_ms": 0.0015239715576171875, "ViewRequirementAgentConnector_ms": 0.03496885299682617}, "num_episodes": 40, "episode_return_max": 464.0, "episode_return_min": 311.0, "episode_return_mean": 393.32, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 465.1398693926686, "num_env_steps_trained_throughput_per_sec": 465.1398693926686, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 8572.167, "restore_workers_time_ms": 0.036, "training_step_time_ms": 8572.052, "sample_time_ms": 4076.347, "load_time_ms": 1.94, "load_throughput": 2062071.017, "learn_time_ms": 4493.005, "learn_throughput": 890.273, "synch_weights_time_ms": 0.023}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 600, "training_iteration": 15, "trial_id": "default", "date": "2024-05-19_18-13-53", "timestamp": 1716167633, "time_this_iter_s": 8.60107970237732, "time_total_s": 129.00564408302307, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 129.00564408302307, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 34.5076923076923, "ram_util_percent": 83.47692307692309}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.44819660468768, "cur_kl_coeff": 11.533007812499998, "cur_lr": 0.003, "total_loss": 9.945941030850975, "policy_loss": -0.03937569523821034, "vf_loss": 9.862094109032745, "vf_explained_var": -0.09624677345316897, "kl": 0.01068434294443279, "entropy": 1.5968210576682962, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 464.0, "episode_reward_min": 309.0, "episode_reward_mean": 390.1, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [359.0, 360.0, 421.0, 398.0, 395.0, 423.0, 386.0, 311.0, 328.0, 415.0, 412.0, 362.0, 340.0, 373.0, 413.0, 380.0, 422.0, 447.0, 388.0, 379.0, 414.0, 403.0, 407.0, 317.0, 427.0, 412.0, 406.0, 363.0, 413.0, 464.0, 400.0, 376.0, 414.0, 404.0, 371.0, 401.0, 416.0, 395.0, 388.0, 420.0, 379.0, 392.0, 431.0, 348.0, 404.0, 457.0, 367.0, 371.0, 401.0, 442.0, 389.0, 386.0, 364.0, 416.0, 361.0, 416.0, 424.0, 434.0, 383.0, 371.0, 404.0, 416.0, 372.0, 377.0, 391.0, 368.0, 428.0, 407.0, 313.0, 369.0, 388.0, 385.0, 341.0, 399.0, 393.0, 409.0, 330.0, 372.0, 346.0, 412.0, 389.0, 383.0, 384.0, 372.0, 410.0, 371.0, 456.0, 353.0, 382.0, 384.0, 309.0, 433.0, 427.0, 411.0, 426.0, 369.0, 377.0, 326.0, 385.0, 384.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11384708304817204, "mean_inference_ms": 0.7444036249137583, "mean_action_processing_ms": 0.03885900014600804, "mean_env_wait_ms": 0.11726441236566634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008477926254272461, "StateBufferConnector_ms": 0.0014379024505615234, "ViewRequirementAgentConnector_ms": 0.03284502029418945}, "num_episodes": 40, "episode_return_max": 464.0, "episode_return_min": 309.0, "episode_return_mean": 390.1}, "env_runner_results": {"episode_reward_max": 464.0, "episode_reward_min": 309.0, "episode_reward_mean": 390.1, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [359.0, 360.0, 421.0, 398.0, 395.0, 423.0, 386.0, 311.0, 328.0, 415.0, 412.0, 362.0, 340.0, 373.0, 413.0, 380.0, 422.0, 447.0, 388.0, 379.0, 414.0, 403.0, 407.0, 317.0, 427.0, 412.0, 406.0, 363.0, 413.0, 464.0, 400.0, 376.0, 414.0, 404.0, 371.0, 401.0, 416.0, 395.0, 388.0, 420.0, 379.0, 392.0, 431.0, 348.0, 404.0, 457.0, 367.0, 371.0, 401.0, 442.0, 389.0, 386.0, 364.0, 416.0, 361.0, 416.0, 424.0, 434.0, 383.0, 371.0, 404.0, 416.0, 372.0, 377.0, 391.0, 368.0, 428.0, 407.0, 313.0, 369.0, 388.0, 385.0, 341.0, 399.0, 393.0, 409.0, 330.0, 372.0, 346.0, 412.0, 389.0, 383.0, 384.0, 372.0, 410.0, 371.0, 456.0, 353.0, 382.0, 384.0, 309.0, 433.0, 427.0, 411.0, 426.0, 369.0, 377.0, 326.0, 385.0, 384.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11384708304817204, "mean_inference_ms": 0.7444036249137583, "mean_action_processing_ms": 0.03885900014600804, "mean_env_wait_ms": 0.11726441236566634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008477926254272461, "StateBufferConnector_ms": 0.0014379024505615234, "ViewRequirementAgentConnector_ms": 0.03284502029418945}, "num_episodes": 40, "episode_return_max": 464.0, "episode_return_min": 309.0, "episode_return_mean": 390.1}, "episode_reward_max": 464.0, "episode_reward_min": 309.0, "episode_reward_mean": 390.1, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [359.0, 360.0, 421.0, 398.0, 395.0, 423.0, 386.0, 311.0, 328.0, 415.0, 412.0, 362.0, 340.0, 373.0, 413.0, 380.0, 422.0, 447.0, 388.0, 379.0, 414.0, 403.0, 407.0, 317.0, 427.0, 412.0, 406.0, 363.0, 413.0, 464.0, 400.0, 376.0, 414.0, 404.0, 371.0, 401.0, 416.0, 395.0, 388.0, 420.0, 379.0, 392.0, 431.0, 348.0, 404.0, 457.0, 367.0, 371.0, 401.0, 442.0, 389.0, 386.0, 364.0, 416.0, 361.0, 416.0, 424.0, 434.0, 383.0, 371.0, 404.0, 416.0, 372.0, 377.0, 391.0, 368.0, 428.0, 407.0, 313.0, 369.0, 388.0, 385.0, 341.0, 399.0, 393.0, 409.0, 330.0, 372.0, 346.0, 412.0, 389.0, 383.0, 384.0, 372.0, 410.0, 371.0, 456.0, 353.0, 382.0, 384.0, 309.0, 433.0, 427.0, 411.0, 426.0, 369.0, 377.0, 326.0, 385.0, 384.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11384708304817204, "mean_inference_ms": 0.7444036249137583, "mean_action_processing_ms": 0.03885900014600804, "mean_env_wait_ms": 0.11726441236566634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008477926254272461, "StateBufferConnector_ms": 0.0014379024505615234, "ViewRequirementAgentConnector_ms": 0.03284502029418945}, "num_episodes": 40, "episode_return_max": 464.0, "episode_return_min": 309.0, "episode_return_mean": 390.1, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.25088038070777, "num_env_steps_trained_throughput_per_sec": 499.25088038070777, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 8547.231, "restore_workers_time_ms": 0.028, "training_step_time_ms": 8547.128, "sample_time_ms": 4063.073, "load_time_ms": 1.917, "load_throughput": 2086900.103, "learn_time_ms": 4481.4, "learn_throughput": 892.578, "synch_weights_time_ms": 0.023}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 640, "training_iteration": 16, "trial_id": "default", "date": "2024-05-19_18-14-01", "timestamp": 1716167641, "time_this_iter_s": 8.012552976608276, "time_total_s": 137.01819705963135, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 137.01819705963135, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 24.318181818181813, "ram_util_percent": 81.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.768128327785, "cur_kl_coeff": 11.533007812499998, "cur_lr": 0.003, "total_loss": 9.913577697097613, "policy_loss": -0.0424003174728764, "vf_loss": 9.859570243794431, "vf_explained_var": -0.05763889435798891, "kl": 0.008359292774170008, "entropy": 1.550152894245681, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 457.0, "episode_reward_min": 301.0, "episode_reward_mean": 385.95, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 392.0, 431.0, 348.0, 404.0, 457.0, 367.0, 371.0, 401.0, 442.0, 389.0, 386.0, 364.0, 416.0, 361.0, 416.0, 424.0, 434.0, 383.0, 371.0, 404.0, 416.0, 372.0, 377.0, 391.0, 368.0, 428.0, 407.0, 313.0, 369.0, 388.0, 385.0, 341.0, 399.0, 393.0, 409.0, 330.0, 372.0, 346.0, 412.0, 389.0, 383.0, 384.0, 372.0, 410.0, 371.0, 456.0, 353.0, 382.0, 384.0, 309.0, 433.0, 427.0, 411.0, 426.0, 369.0, 377.0, 326.0, 385.0, 384.0, 370.0, 366.0, 325.0, 380.0, 356.0, 381.0, 425.0, 419.0, 433.0, 405.0, 359.0, 393.0, 389.0, 407.0, 381.0, 412.0, 356.0, 416.0, 388.0, 366.0, 388.0, 395.0, 374.0, 389.0, 411.0, 407.0, 351.0, 393.0, 372.0, 369.0, 348.0, 380.0, 403.0, 340.0, 367.0, 301.0, 412.0, 387.0, 395.0, 399.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11327809740386943, "mean_inference_ms": 0.7416483434177789, "mean_action_processing_ms": 0.03869695154159405, "mean_env_wait_ms": 0.11687632931833351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007782459259033203, "StateBufferConnector_ms": 0.001363992691040039, "ViewRequirementAgentConnector_ms": 0.030403614044189453}, "num_episodes": 40, "episode_return_max": 457.0, "episode_return_min": 301.0, "episode_return_mean": 385.95}, "env_runner_results": {"episode_reward_max": 457.0, "episode_reward_min": 301.0, "episode_reward_mean": 385.95, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 392.0, 431.0, 348.0, 404.0, 457.0, 367.0, 371.0, 401.0, 442.0, 389.0, 386.0, 364.0, 416.0, 361.0, 416.0, 424.0, 434.0, 383.0, 371.0, 404.0, 416.0, 372.0, 377.0, 391.0, 368.0, 428.0, 407.0, 313.0, 369.0, 388.0, 385.0, 341.0, 399.0, 393.0, 409.0, 330.0, 372.0, 346.0, 412.0, 389.0, 383.0, 384.0, 372.0, 410.0, 371.0, 456.0, 353.0, 382.0, 384.0, 309.0, 433.0, 427.0, 411.0, 426.0, 369.0, 377.0, 326.0, 385.0, 384.0, 370.0, 366.0, 325.0, 380.0, 356.0, 381.0, 425.0, 419.0, 433.0, 405.0, 359.0, 393.0, 389.0, 407.0, 381.0, 412.0, 356.0, 416.0, 388.0, 366.0, 388.0, 395.0, 374.0, 389.0, 411.0, 407.0, 351.0, 393.0, 372.0, 369.0, 348.0, 380.0, 403.0, 340.0, 367.0, 301.0, 412.0, 387.0, 395.0, 399.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11327809740386943, "mean_inference_ms": 0.7416483434177789, "mean_action_processing_ms": 0.03869695154159405, "mean_env_wait_ms": 0.11687632931833351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007782459259033203, "StateBufferConnector_ms": 0.001363992691040039, "ViewRequirementAgentConnector_ms": 0.030403614044189453}, "num_episodes": 40, "episode_return_max": 457.0, "episode_return_min": 301.0, "episode_return_mean": 385.95}, "episode_reward_max": 457.0, "episode_reward_min": 301.0, "episode_reward_mean": 385.95, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [379.0, 392.0, 431.0, 348.0, 404.0, 457.0, 367.0, 371.0, 401.0, 442.0, 389.0, 386.0, 364.0, 416.0, 361.0, 416.0, 424.0, 434.0, 383.0, 371.0, 404.0, 416.0, 372.0, 377.0, 391.0, 368.0, 428.0, 407.0, 313.0, 369.0, 388.0, 385.0, 341.0, 399.0, 393.0, 409.0, 330.0, 372.0, 346.0, 412.0, 389.0, 383.0, 384.0, 372.0, 410.0, 371.0, 456.0, 353.0, 382.0, 384.0, 309.0, 433.0, 427.0, 411.0, 426.0, 369.0, 377.0, 326.0, 385.0, 384.0, 370.0, 366.0, 325.0, 380.0, 356.0, 381.0, 425.0, 419.0, 433.0, 405.0, 359.0, 393.0, 389.0, 407.0, 381.0, 412.0, 356.0, 416.0, 388.0, 366.0, 388.0, 395.0, 374.0, 389.0, 411.0, 407.0, 351.0, 393.0, 372.0, 369.0, 348.0, 380.0, 403.0, 340.0, 367.0, 301.0, 412.0, 387.0, 395.0, 399.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11327809740386943, "mean_inference_ms": 0.7416483434177789, "mean_action_processing_ms": 0.03869695154159405, "mean_env_wait_ms": 0.11687632931833351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007782459259033203, "StateBufferConnector_ms": 0.001363992691040039, "ViewRequirementAgentConnector_ms": 0.030403614044189453}, "num_episodes": 40, "episode_return_max": 457.0, "episode_return_min": 301.0, "episode_return_mean": 385.95, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 514.7311476353383, "num_env_steps_trained_throughput_per_sec": 514.7311476353383, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 8520.22, "restore_workers_time_ms": 0.027, "training_step_time_ms": 8520.125, "sample_time_ms": 4051.273, "load_time_ms": 1.92, "load_throughput": 2083427.422, "learn_time_ms": 4466.225, "learn_throughput": 895.611, "synch_weights_time_ms": 0.021}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 680, "training_iteration": 17, "trial_id": "default", "date": "2024-05-19_18-14-09", "timestamp": 1716167649, "time_this_iter_s": 7.7717719078063965, "time_total_s": 144.78996896743774, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 144.78996896743774, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 25.572727272727274, "ram_util_percent": 81.50000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.97756395980876, "cur_kl_coeff": 11.533007812499998, "cur_lr": 0.003, "total_loss": 9.926394760993219, "policy_loss": -0.03446844110242842, "vf_loss": 9.841606453926332, "vf_explained_var": -0.06779989452772243, "kl": 0.010340470850754862, "entropy": 1.5545235995323428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 456.0, "episode_reward_min": 301.0, "episode_reward_mean": 385.83, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [389.0, 383.0, 384.0, 372.0, 410.0, 371.0, 456.0, 353.0, 382.0, 384.0, 309.0, 433.0, 427.0, 411.0, 426.0, 369.0, 377.0, 326.0, 385.0, 384.0, 370.0, 366.0, 325.0, 380.0, 356.0, 381.0, 425.0, 419.0, 433.0, 405.0, 359.0, 393.0, 389.0, 407.0, 381.0, 412.0, 356.0, 416.0, 388.0, 366.0, 388.0, 395.0, 374.0, 389.0, 411.0, 407.0, 351.0, 393.0, 372.0, 369.0, 348.0, 380.0, 403.0, 340.0, 367.0, 301.0, 412.0, 387.0, 395.0, 399.0, 419.0, 340.0, 366.0, 401.0, 414.0, 402.0, 341.0, 453.0, 439.0, 417.0, 369.0, 373.0, 367.0, 360.0, 369.0, 432.0, 380.0, 350.0, 372.0, 355.0, 382.0, 373.0, 379.0, 441.0, 317.0, 395.0, 411.0, 378.0, 398.0, 357.0, 455.0, 428.0, 369.0, 399.0, 397.0, 383.0, 368.0, 433.0, 366.0, 396.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11261185718880103, "mean_inference_ms": 0.7382135337602245, "mean_action_processing_ms": 0.03850244549644448, "mean_env_wait_ms": 0.11644550883838865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007802486419677734, "StateBufferConnector_ms": 0.0013527870178222656, "ViewRequirementAgentConnector_ms": 0.03077077865600586}, "num_episodes": 40, "episode_return_max": 456.0, "episode_return_min": 301.0, "episode_return_mean": 385.83}, "env_runner_results": {"episode_reward_max": 456.0, "episode_reward_min": 301.0, "episode_reward_mean": 385.83, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [389.0, 383.0, 384.0, 372.0, 410.0, 371.0, 456.0, 353.0, 382.0, 384.0, 309.0, 433.0, 427.0, 411.0, 426.0, 369.0, 377.0, 326.0, 385.0, 384.0, 370.0, 366.0, 325.0, 380.0, 356.0, 381.0, 425.0, 419.0, 433.0, 405.0, 359.0, 393.0, 389.0, 407.0, 381.0, 412.0, 356.0, 416.0, 388.0, 366.0, 388.0, 395.0, 374.0, 389.0, 411.0, 407.0, 351.0, 393.0, 372.0, 369.0, 348.0, 380.0, 403.0, 340.0, 367.0, 301.0, 412.0, 387.0, 395.0, 399.0, 419.0, 340.0, 366.0, 401.0, 414.0, 402.0, 341.0, 453.0, 439.0, 417.0, 369.0, 373.0, 367.0, 360.0, 369.0, 432.0, 380.0, 350.0, 372.0, 355.0, 382.0, 373.0, 379.0, 441.0, 317.0, 395.0, 411.0, 378.0, 398.0, 357.0, 455.0, 428.0, 369.0, 399.0, 397.0, 383.0, 368.0, 433.0, 366.0, 396.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11261185718880103, "mean_inference_ms": 0.7382135337602245, "mean_action_processing_ms": 0.03850244549644448, "mean_env_wait_ms": 0.11644550883838865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007802486419677734, "StateBufferConnector_ms": 0.0013527870178222656, "ViewRequirementAgentConnector_ms": 0.03077077865600586}, "num_episodes": 40, "episode_return_max": 456.0, "episode_return_min": 301.0, "episode_return_mean": 385.83}, "episode_reward_max": 456.0, "episode_reward_min": 301.0, "episode_reward_mean": 385.83, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [389.0, 383.0, 384.0, 372.0, 410.0, 371.0, 456.0, 353.0, 382.0, 384.0, 309.0, 433.0, 427.0, 411.0, 426.0, 369.0, 377.0, 326.0, 385.0, 384.0, 370.0, 366.0, 325.0, 380.0, 356.0, 381.0, 425.0, 419.0, 433.0, 405.0, 359.0, 393.0, 389.0, 407.0, 381.0, 412.0, 356.0, 416.0, 388.0, 366.0, 388.0, 395.0, 374.0, 389.0, 411.0, 407.0, 351.0, 393.0, 372.0, 369.0, 348.0, 380.0, 403.0, 340.0, 367.0, 301.0, 412.0, 387.0, 395.0, 399.0, 419.0, 340.0, 366.0, 401.0, 414.0, 402.0, 341.0, 453.0, 439.0, 417.0, 369.0, 373.0, 367.0, 360.0, 369.0, 432.0, 380.0, 350.0, 372.0, 355.0, 382.0, 373.0, 379.0, 441.0, 317.0, 395.0, 411.0, 378.0, 398.0, 357.0, 455.0, 428.0, 369.0, 399.0, 397.0, 383.0, 368.0, 433.0, 366.0, 396.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11261185718880103, "mean_inference_ms": 0.7382135337602245, "mean_action_processing_ms": 0.03850244549644448, "mean_env_wait_ms": 0.11644550883838865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007802486419677734, "StateBufferConnector_ms": 0.0013527870178222656, "ViewRequirementAgentConnector_ms": 0.03077077865600586}, "num_episodes": 40, "episode_return_max": 456.0, "episode_return_min": 301.0, "episode_return_mean": 385.83, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 449.69386392755695, "num_env_steps_trained_throughput_per_sec": 449.69386392755695, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 8612.541, "restore_workers_time_ms": 0.026, "training_step_time_ms": 8612.445, "sample_time_ms": 4048.689, "load_time_ms": 1.624, "load_throughput": 2463469.987, "learn_time_ms": 4561.398, "learn_throughput": 876.924, "synch_weights_time_ms": 0.021}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 720, "training_iteration": 18, "trial_id": "default", "date": "2024-05-19_18-14-18", "timestamp": 1716167658, "time_this_iter_s": 8.896545171737671, "time_total_s": 153.68651413917542, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 153.68651413917542, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 37.45384615384615, "ram_util_percent": 83.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.26854226281566, "cur_kl_coeff": 11.533007812499998, "cur_lr": 0.003, "total_loss": 9.952798555230581, "policy_loss": -0.0343634534982704, "vf_loss": 9.869002193532964, "vf_explained_var": -0.1094370363861002, "kl": 0.010245358755538827, "entropy": 1.5554042634143623, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 455.0, "episode_reward_min": 301.0, "episode_reward_mean": 381.25, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [388.0, 395.0, 374.0, 389.0, 411.0, 407.0, 351.0, 393.0, 372.0, 369.0, 348.0, 380.0, 403.0, 340.0, 367.0, 301.0, 412.0, 387.0, 395.0, 399.0, 419.0, 340.0, 366.0, 401.0, 414.0, 402.0, 341.0, 453.0, 439.0, 417.0, 369.0, 373.0, 367.0, 360.0, 369.0, 432.0, 380.0, 350.0, 372.0, 355.0, 382.0, 373.0, 379.0, 441.0, 317.0, 395.0, 411.0, 378.0, 398.0, 357.0, 455.0, 428.0, 369.0, 399.0, 397.0, 383.0, 368.0, 433.0, 366.0, 396.0, 350.0, 354.0, 359.0, 370.0, 396.0, 342.0, 415.0, 361.0, 377.0, 333.0, 390.0, 341.0, 401.0, 331.0, 399.0, 373.0, 434.0, 351.0, 367.0, 390.0, 355.0, 417.0, 453.0, 371.0, 404.0, 314.0, 424.0, 346.0, 388.0, 327.0, 360.0, 418.0, 364.0, 348.0, 430.0, 369.0, 396.0, 346.0, 352.0, 384.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11259812568418581, "mean_inference_ms": 0.7377365140396396, "mean_action_processing_ms": 0.03850035402562717, "mean_env_wait_ms": 0.11650495134646235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008031368255615234, "StateBufferConnector_ms": 0.001397848129272461, "ViewRequirementAgentConnector_ms": 0.03196454048156738}, "num_episodes": 40, "episode_return_max": 455.0, "episode_return_min": 301.0, "episode_return_mean": 381.25}, "env_runner_results": {"episode_reward_max": 455.0, "episode_reward_min": 301.0, "episode_reward_mean": 381.25, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [388.0, 395.0, 374.0, 389.0, 411.0, 407.0, 351.0, 393.0, 372.0, 369.0, 348.0, 380.0, 403.0, 340.0, 367.0, 301.0, 412.0, 387.0, 395.0, 399.0, 419.0, 340.0, 366.0, 401.0, 414.0, 402.0, 341.0, 453.0, 439.0, 417.0, 369.0, 373.0, 367.0, 360.0, 369.0, 432.0, 380.0, 350.0, 372.0, 355.0, 382.0, 373.0, 379.0, 441.0, 317.0, 395.0, 411.0, 378.0, 398.0, 357.0, 455.0, 428.0, 369.0, 399.0, 397.0, 383.0, 368.0, 433.0, 366.0, 396.0, 350.0, 354.0, 359.0, 370.0, 396.0, 342.0, 415.0, 361.0, 377.0, 333.0, 390.0, 341.0, 401.0, 331.0, 399.0, 373.0, 434.0, 351.0, 367.0, 390.0, 355.0, 417.0, 453.0, 371.0, 404.0, 314.0, 424.0, 346.0, 388.0, 327.0, 360.0, 418.0, 364.0, 348.0, 430.0, 369.0, 396.0, 346.0, 352.0, 384.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11259812568418581, "mean_inference_ms": 0.7377365140396396, "mean_action_processing_ms": 0.03850035402562717, "mean_env_wait_ms": 0.11650495134646235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008031368255615234, "StateBufferConnector_ms": 0.001397848129272461, "ViewRequirementAgentConnector_ms": 0.03196454048156738}, "num_episodes": 40, "episode_return_max": 455.0, "episode_return_min": 301.0, "episode_return_mean": 381.25}, "episode_reward_max": 455.0, "episode_reward_min": 301.0, "episode_reward_mean": 381.25, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [388.0, 395.0, 374.0, 389.0, 411.0, 407.0, 351.0, 393.0, 372.0, 369.0, 348.0, 380.0, 403.0, 340.0, 367.0, 301.0, 412.0, 387.0, 395.0, 399.0, 419.0, 340.0, 366.0, 401.0, 414.0, 402.0, 341.0, 453.0, 439.0, 417.0, 369.0, 373.0, 367.0, 360.0, 369.0, 432.0, 380.0, 350.0, 372.0, 355.0, 382.0, 373.0, 379.0, 441.0, 317.0, 395.0, 411.0, 378.0, 398.0, 357.0, 455.0, 428.0, 369.0, 399.0, 397.0, 383.0, 368.0, 433.0, 366.0, 396.0, 350.0, 354.0, 359.0, 370.0, 396.0, 342.0, 415.0, 361.0, 377.0, 333.0, 390.0, 341.0, 401.0, 331.0, 399.0, 373.0, 434.0, 351.0, 367.0, 390.0, 355.0, 417.0, 453.0, 371.0, 404.0, 314.0, 424.0, 346.0, 388.0, 327.0, 360.0, 418.0, 364.0, 348.0, 430.0, 369.0, 396.0, 346.0, 352.0, 384.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11259812568418581, "mean_inference_ms": 0.7377365140396396, "mean_action_processing_ms": 0.03850035402562717, "mean_env_wait_ms": 0.11650495134646235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008031368255615234, "StateBufferConnector_ms": 0.001397848129272461, "ViewRequirementAgentConnector_ms": 0.03196454048156738}, "num_episodes": 40, "episode_return_max": 455.0, "episode_return_min": 301.0, "episode_return_mean": 381.25, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 404.47764025907935, "num_env_steps_trained_throughput_per_sec": 404.47764025907935, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 8747.472, "restore_workers_time_ms": 0.027, "training_step_time_ms": 8747.373, "sample_time_ms": 4059.657, "load_time_ms": 1.601, "load_throughput": 2498542.92, "learn_time_ms": 4685.359, "learn_throughput": 853.723, "synch_weights_time_ms": 0.022}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 760, "training_iteration": 19, "trial_id": "default", "date": "2024-05-19_18-14-28", "timestamp": 1716167668, "time_this_iter_s": 9.891142845153809, "time_total_s": 163.57765698432922, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 163.57765698432922, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 43.60714285714287, "ram_util_percent": 85.46428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.612849744930061, "cur_kl_coeff": 11.533007812499998, "cur_lr": 0.003, "total_loss": 9.974163300503967, "policy_loss": -0.025732518382050016, "vf_loss": 9.885249278365924, "vf_explained_var": -0.12121158261452952, "kl": 0.009940734418621908, "entropy": 1.5438976321169124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 455.0, "episode_reward_min": 314.0, "episode_reward_mean": 378.78, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [382.0, 373.0, 379.0, 441.0, 317.0, 395.0, 411.0, 378.0, 398.0, 357.0, 455.0, 428.0, 369.0, 399.0, 397.0, 383.0, 368.0, 433.0, 366.0, 396.0, 350.0, 354.0, 359.0, 370.0, 396.0, 342.0, 415.0, 361.0, 377.0, 333.0, 390.0, 341.0, 401.0, 331.0, 399.0, 373.0, 434.0, 351.0, 367.0, 390.0, 355.0, 417.0, 453.0, 371.0, 404.0, 314.0, 424.0, 346.0, 388.0, 327.0, 360.0, 418.0, 364.0, 348.0, 430.0, 369.0, 396.0, 346.0, 352.0, 384.0, 388.0, 349.0, 422.0, 411.0, 373.0, 386.0, 329.0, 329.0, 406.0, 386.0, 396.0, 424.0, 352.0, 372.0, 386.0, 396.0, 378.0, 376.0, 334.0, 393.0, 361.0, 425.0, 356.0, 350.0, 341.0, 406.0, 364.0, 393.0, 376.0, 414.0, 375.0, 333.0, 357.0, 419.0, 383.0, 373.0, 373.0, 397.0, 347.0, 324.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11314797015770424, "mean_inference_ms": 0.7399856737537334, "mean_action_processing_ms": 0.03867664186239467, "mean_env_wait_ms": 0.11692282255997175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009141206741333008, "StateBufferConnector_ms": 0.0015435218811035156, "ViewRequirementAgentConnector_ms": 0.034438133239746094}, "num_episodes": 40, "episode_return_max": 455.0, "episode_return_min": 314.0, "episode_return_mean": 378.78}, "env_runner_results": {"episode_reward_max": 455.0, "episode_reward_min": 314.0, "episode_reward_mean": 378.78, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [382.0, 373.0, 379.0, 441.0, 317.0, 395.0, 411.0, 378.0, 398.0, 357.0, 455.0, 428.0, 369.0, 399.0, 397.0, 383.0, 368.0, 433.0, 366.0, 396.0, 350.0, 354.0, 359.0, 370.0, 396.0, 342.0, 415.0, 361.0, 377.0, 333.0, 390.0, 341.0, 401.0, 331.0, 399.0, 373.0, 434.0, 351.0, 367.0, 390.0, 355.0, 417.0, 453.0, 371.0, 404.0, 314.0, 424.0, 346.0, 388.0, 327.0, 360.0, 418.0, 364.0, 348.0, 430.0, 369.0, 396.0, 346.0, 352.0, 384.0, 388.0, 349.0, 422.0, 411.0, 373.0, 386.0, 329.0, 329.0, 406.0, 386.0, 396.0, 424.0, 352.0, 372.0, 386.0, 396.0, 378.0, 376.0, 334.0, 393.0, 361.0, 425.0, 356.0, 350.0, 341.0, 406.0, 364.0, 393.0, 376.0, 414.0, 375.0, 333.0, 357.0, 419.0, 383.0, 373.0, 373.0, 397.0, 347.0, 324.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11314797015770424, "mean_inference_ms": 0.7399856737537334, "mean_action_processing_ms": 0.03867664186239467, "mean_env_wait_ms": 0.11692282255997175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009141206741333008, "StateBufferConnector_ms": 0.0015435218811035156, "ViewRequirementAgentConnector_ms": 0.034438133239746094}, "num_episodes": 40, "episode_return_max": 455.0, "episode_return_min": 314.0, "episode_return_mean": 378.78}, "episode_reward_max": 455.0, "episode_reward_min": 314.0, "episode_reward_mean": 378.78, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [382.0, 373.0, 379.0, 441.0, 317.0, 395.0, 411.0, 378.0, 398.0, 357.0, 455.0, 428.0, 369.0, 399.0, 397.0, 383.0, 368.0, 433.0, 366.0, 396.0, 350.0, 354.0, 359.0, 370.0, 396.0, 342.0, 415.0, 361.0, 377.0, 333.0, 390.0, 341.0, 401.0, 331.0, 399.0, 373.0, 434.0, 351.0, 367.0, 390.0, 355.0, 417.0, 453.0, 371.0, 404.0, 314.0, 424.0, 346.0, 388.0, 327.0, 360.0, 418.0, 364.0, 348.0, 430.0, 369.0, 396.0, 346.0, 352.0, 384.0, 388.0, 349.0, 422.0, 411.0, 373.0, 386.0, 329.0, 329.0, 406.0, 386.0, 396.0, 424.0, 352.0, 372.0, 386.0, 396.0, 378.0, 376.0, 334.0, 393.0, 361.0, 425.0, 356.0, 350.0, 341.0, 406.0, 364.0, 393.0, 376.0, 414.0, 375.0, 333.0, 357.0, 419.0, 383.0, 373.0, 373.0, 397.0, 347.0, 324.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11314797015770424, "mean_inference_ms": 0.7399856737537334, "mean_action_processing_ms": 0.03867664186239467, "mean_env_wait_ms": 0.11692282255997175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009141206741333008, "StateBufferConnector_ms": 0.0015435218811035156, "ViewRequirementAgentConnector_ms": 0.034438133239746094}, "num_episodes": 40, "episode_return_max": 455.0, "episode_return_min": 314.0, "episode_return_mean": 378.78, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 399.8037729151432, "num_env_steps_trained_throughput_per_sec": 399.8037729151432, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 8868.269, "restore_workers_time_ms": 0.008, "training_step_time_ms": 8868.189, "sample_time_ms": 4121.187, "load_time_ms": 1.654, "load_throughput": 2418755.821, "learn_time_ms": 4744.574, "learn_throughput": 843.068, "synch_weights_time_ms": 0.023}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 800, "training_iteration": 20, "trial_id": "default", "date": "2024-05-19_18-14-38", "timestamp": 1716167678, "time_this_iter_s": 10.0068678855896, "time_total_s": 173.58452486991882, "pid": 85097, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29b5d1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 173.58452486991882, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 43.964285714285715, "ram_util_percent": 86.05000000000003}}
