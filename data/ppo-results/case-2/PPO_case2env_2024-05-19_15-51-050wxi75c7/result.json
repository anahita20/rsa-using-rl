{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.865447111283579, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.008000000000000004, "total_loss": 10.379537016345608, "policy_loss": 0.21447528655320325, "vf_loss": 9.788395088975147, "vf_explained_var": -0.3685080911523552, "kl": 1.8833332159016745, "entropy": 1.4307716234076409, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 189.0, "episode_reward_min": -107.0, "episode_reward_mean": 63.275, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, -107.0, 36.0, 97.0, 56.0, 96.0, 159.0, 118.0, 160.0, 32.0, 101.0, 51.0, -77.0, 90.0, 59.0, 168.0, 180.0, 18.0, 189.0, 0.0, 71.0, 76.0, 148.0, 20.0, -42.0, 107.0, 23.0, 20.0, 69.0, 107.0, 81.0, 34.0, 5.0, 23.0, 34.0, 63.0, 57.0, 143.0, -17.0, 103.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11328112271629968, "mean_inference_ms": 0.6829350926047175, "mean_action_processing_ms": 0.03574282429987596, "mean_env_wait_ms": 0.16145275938782028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00874340534210205, "StateBufferConnector_ms": 0.0013828277587890625, "ViewRequirementAgentConnector_ms": 0.031173229217529297}, "num_episodes": 40, "episode_return_max": 189.0, "episode_return_min": -107.0, "episode_return_mean": 63.275}, "env_runner_results": {"episode_reward_max": 189.0, "episode_reward_min": -107.0, "episode_reward_mean": 63.275, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, -107.0, 36.0, 97.0, 56.0, 96.0, 159.0, 118.0, 160.0, 32.0, 101.0, 51.0, -77.0, 90.0, 59.0, 168.0, 180.0, 18.0, 189.0, 0.0, 71.0, 76.0, 148.0, 20.0, -42.0, 107.0, 23.0, 20.0, 69.0, 107.0, 81.0, 34.0, 5.0, 23.0, 34.0, 63.0, 57.0, 143.0, -17.0, 103.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11328112271629968, "mean_inference_ms": 0.6829350926047175, "mean_action_processing_ms": 0.03574282429987596, "mean_env_wait_ms": 0.16145275938782028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00874340534210205, "StateBufferConnector_ms": 0.0013828277587890625, "ViewRequirementAgentConnector_ms": 0.031173229217529297}, "num_episodes": 40, "episode_return_max": 189.0, "episode_return_min": -107.0, "episode_return_mean": 63.275}, "episode_reward_max": 189.0, "episode_reward_min": -107.0, "episode_reward_mean": 63.275, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-20.0, -107.0, 36.0, 97.0, 56.0, 96.0, 159.0, 118.0, 160.0, 32.0, 101.0, 51.0, -77.0, 90.0, 59.0, 168.0, 180.0, 18.0, 189.0, 0.0, 71.0, 76.0, 148.0, 20.0, -42.0, 107.0, 23.0, 20.0, 69.0, 107.0, 81.0, 34.0, 5.0, 23.0, 34.0, 63.0, 57.0, 143.0, -17.0, 103.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11328112271629968, "mean_inference_ms": 0.6829350926047175, "mean_action_processing_ms": 0.03574282429987596, "mean_env_wait_ms": 0.16145275938782028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00874340534210205, "StateBufferConnector_ms": 0.0013828277587890625, "ViewRequirementAgentConnector_ms": 0.031173229217529297}, "num_episodes": 40, "episode_return_max": 189.0, "episode_return_min": -107.0, "episode_return_mean": 63.275, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 480.126655420452, "num_env_steps_trained_throughput_per_sec": 480.126655420452, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 8331.15, "restore_workers_time_ms": 0.005, "training_step_time_ms": 8331.111, "sample_time_ms": 3997.704, "load_time_ms": 0.442, "load_throughput": 9049199.569, "learn_time_ms": 4332.055, "learn_throughput": 923.349, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 40, "training_iteration": 1, "trial_id": "default", "date": "2024-05-19_15-51-14", "timestamp": 1716159074, "time_this_iter_s": 8.331544876098633, "time_total_s": 8.331544876098633, "pid": 80385, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case2env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.008, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29d3e9750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 8.331544876098633, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 26.233333333333334, "ram_util_percent": 85.61666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.605169656199793, "cur_kl_coeff": 0.3, "cur_lr": 0.008000000000000004, "total_loss": 10.161391105446764, "policy_loss": 0.1322672585035444, "vf_loss": 9.781701390461254, "vf_explained_var": -0.7174717617932186, "kl": 0.824741359661736, "entropy": 0.9848475325812576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 208.0, "episode_reward_min": -107.0, "episode_reward_mean": 84.2625, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, -107.0, 36.0, 97.0, 56.0, 96.0, 159.0, 118.0, 160.0, 32.0, 101.0, 51.0, -77.0, 90.0, 59.0, 168.0, 180.0, 18.0, 189.0, 0.0, 71.0, 76.0, 148.0, 20.0, -42.0, 107.0, 23.0, 20.0, 69.0, 107.0, 81.0, 34.0, 5.0, 23.0, 34.0, 63.0, 57.0, 143.0, -17.0, 103.0, 183.0, 133.0, 103.0, 67.0, 83.0, 111.0, 145.0, 114.0, 63.0, 60.0, 112.0, 104.0, 118.0, 161.0, 83.0, 89.0, 158.0, 108.0, 138.0, 126.0, 112.0, 46.0, 113.0, 15.0, 36.0, 66.0, 103.0, 130.0, 120.0, 96.0, 112.0, 43.0, 156.0, 85.0, 104.0, 101.0, 114.0, 208.0, 111.0, 80.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11335661948157594, "mean_inference_ms": 0.6832087247436537, "mean_action_processing_ms": 0.03565786725071945, "mean_env_wait_ms": 0.1624453682829372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008023083209991455, "StateBufferConnector_ms": 0.0013563036918640137, "ViewRequirementAgentConnector_ms": 0.031220614910125732}, "num_episodes": 40, "episode_return_max": 208.0, "episode_return_min": -107.0, "episode_return_mean": 84.2625}, "env_runner_results": {"episode_reward_max": 208.0, "episode_reward_min": -107.0, "episode_reward_mean": 84.2625, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, -107.0, 36.0, 97.0, 56.0, 96.0, 159.0, 118.0, 160.0, 32.0, 101.0, 51.0, -77.0, 90.0, 59.0, 168.0, 180.0, 18.0, 189.0, 0.0, 71.0, 76.0, 148.0, 20.0, -42.0, 107.0, 23.0, 20.0, 69.0, 107.0, 81.0, 34.0, 5.0, 23.0, 34.0, 63.0, 57.0, 143.0, -17.0, 103.0, 183.0, 133.0, 103.0, 67.0, 83.0, 111.0, 145.0, 114.0, 63.0, 60.0, 112.0, 104.0, 118.0, 161.0, 83.0, 89.0, 158.0, 108.0, 138.0, 126.0, 112.0, 46.0, 113.0, 15.0, 36.0, 66.0, 103.0, 130.0, 120.0, 96.0, 112.0, 43.0, 156.0, 85.0, 104.0, 101.0, 114.0, 208.0, 111.0, 80.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11335661948157594, "mean_inference_ms": 0.6832087247436537, "mean_action_processing_ms": 0.03565786725071945, "mean_env_wait_ms": 0.1624453682829372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008023083209991455, "StateBufferConnector_ms": 0.0013563036918640137, "ViewRequirementAgentConnector_ms": 0.031220614910125732}, "num_episodes": 40, "episode_return_max": 208.0, "episode_return_min": -107.0, "episode_return_mean": 84.2625}, "episode_reward_max": 208.0, "episode_reward_min": -107.0, "episode_reward_mean": 84.2625, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-20.0, -107.0, 36.0, 97.0, 56.0, 96.0, 159.0, 118.0, 160.0, 32.0, 101.0, 51.0, -77.0, 90.0, 59.0, 168.0, 180.0, 18.0, 189.0, 0.0, 71.0, 76.0, 148.0, 20.0, -42.0, 107.0, 23.0, 20.0, 69.0, 107.0, 81.0, 34.0, 5.0, 23.0, 34.0, 63.0, 57.0, 143.0, -17.0, 103.0, 183.0, 133.0, 103.0, 67.0, 83.0, 111.0, 145.0, 114.0, 63.0, 60.0, 112.0, 104.0, 118.0, 161.0, 83.0, 89.0, 158.0, 108.0, 138.0, 126.0, 112.0, 46.0, 113.0, 15.0, 36.0, 66.0, 103.0, 130.0, 120.0, 96.0, 112.0, 43.0, 156.0, 85.0, 104.0, 101.0, 114.0, 208.0, 111.0, 80.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11335661948157594, "mean_inference_ms": 0.6832087247436537, "mean_action_processing_ms": 0.03565786725071945, "mean_env_wait_ms": 0.1624453682829372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008023083209991455, "StateBufferConnector_ms": 0.0013563036918640137, "ViewRequirementAgentConnector_ms": 0.031220614910125732}, "num_episodes": 40, "episode_return_max": 208.0, "episode_return_min": -107.0, "episode_return_mean": 84.2625, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.03992157839014, "num_env_steps_trained_throughput_per_sec": 496.03992157839014, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 8197.513, "restore_workers_time_ms": 0.006, "training_step_time_ms": 8197.467, "sample_time_ms": 4004.413, "load_time_ms": 0.933, "load_throughput": 4289202.608, "learn_time_ms": 4191.384, "learn_throughput": 954.339, "synch_weights_time_ms": 0.021}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 80, "training_iteration": 2, "trial_id": "default", "date": "2024-05-19_15-51-22", "timestamp": 1716159082, "time_this_iter_s": 8.064905881881714, "time_total_s": 16.396450757980347, "pid": 80385, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case2env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.008, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29d3e9750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 16.396450757980347, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 26.650000000000006, "ram_util_percent": 85.65833333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.674154555477122, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.008000000000000004, "total_loss": 10.044133708297565, "policy_loss": 0.04767990830124066, "vf_loss": 9.812553172983149, "vf_explained_var": -0.8323930956984079, "kl": 0.40866798773171203, "entropy": 0.7563401968248429, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 223.0, "episode_reward_min": -42.0, "episode_reward_mean": 105.74, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.0, 76.0, 148.0, 20.0, -42.0, 107.0, 23.0, 20.0, 69.0, 107.0, 81.0, 34.0, 5.0, 23.0, 34.0, 63.0, 57.0, 143.0, -17.0, 103.0, 183.0, 133.0, 103.0, 67.0, 83.0, 111.0, 145.0, 114.0, 63.0, 60.0, 112.0, 104.0, 118.0, 161.0, 83.0, 89.0, 158.0, 108.0, 138.0, 126.0, 112.0, 46.0, 113.0, 15.0, 36.0, 66.0, 103.0, 130.0, 120.0, 96.0, 112.0, 43.0, 156.0, 85.0, 104.0, 101.0, 114.0, 208.0, 111.0, 80.0, 60.0, 198.0, 163.0, 85.0, 119.0, 54.0, -2.0, 23.0, 151.0, 151.0, 148.0, 96.0, 106.0, 135.0, 159.0, 135.0, 184.0, 139.0, 120.0, 198.0, 210.0, 101.0, 189.0, 141.0, 95.0, 104.0, 91.0, 87.0, 82.0, 142.0, 203.0, 223.0, 204.0, 13.0, 165.0, 115.0, 161.0, 182.0, 106.0, 203.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11343022249583071, "mean_inference_ms": 0.6837578453664225, "mean_action_processing_ms": 0.03558018125444971, "mean_env_wait_ms": 0.16322244050047455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007829904556274414, "StateBufferConnector_ms": 0.001336812973022461, "ViewRequirementAgentConnector_ms": 0.031358957290649414}, "num_episodes": 40, "episode_return_max": 223.0, "episode_return_min": -42.0, "episode_return_mean": 105.74}, "env_runner_results": {"episode_reward_max": 223.0, "episode_reward_min": -42.0, "episode_reward_mean": 105.74, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.0, 76.0, 148.0, 20.0, -42.0, 107.0, 23.0, 20.0, 69.0, 107.0, 81.0, 34.0, 5.0, 23.0, 34.0, 63.0, 57.0, 143.0, -17.0, 103.0, 183.0, 133.0, 103.0, 67.0, 83.0, 111.0, 145.0, 114.0, 63.0, 60.0, 112.0, 104.0, 118.0, 161.0, 83.0, 89.0, 158.0, 108.0, 138.0, 126.0, 112.0, 46.0, 113.0, 15.0, 36.0, 66.0, 103.0, 130.0, 120.0, 96.0, 112.0, 43.0, 156.0, 85.0, 104.0, 101.0, 114.0, 208.0, 111.0, 80.0, 60.0, 198.0, 163.0, 85.0, 119.0, 54.0, -2.0, 23.0, 151.0, 151.0, 148.0, 96.0, 106.0, 135.0, 159.0, 135.0, 184.0, 139.0, 120.0, 198.0, 210.0, 101.0, 189.0, 141.0, 95.0, 104.0, 91.0, 87.0, 82.0, 142.0, 203.0, 223.0, 204.0, 13.0, 165.0, 115.0, 161.0, 182.0, 106.0, 203.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11343022249583071, "mean_inference_ms": 0.6837578453664225, "mean_action_processing_ms": 0.03558018125444971, "mean_env_wait_ms": 0.16322244050047455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007829904556274414, "StateBufferConnector_ms": 0.001336812973022461, "ViewRequirementAgentConnector_ms": 0.031358957290649414}, "num_episodes": 40, "episode_return_max": 223.0, "episode_return_min": -42.0, "episode_return_mean": 105.74}, "episode_reward_max": 223.0, "episode_reward_min": -42.0, "episode_reward_mean": 105.74, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [71.0, 76.0, 148.0, 20.0, -42.0, 107.0, 23.0, 20.0, 69.0, 107.0, 81.0, 34.0, 5.0, 23.0, 34.0, 63.0, 57.0, 143.0, -17.0, 103.0, 183.0, 133.0, 103.0, 67.0, 83.0, 111.0, 145.0, 114.0, 63.0, 60.0, 112.0, 104.0, 118.0, 161.0, 83.0, 89.0, 158.0, 108.0, 138.0, 126.0, 112.0, 46.0, 113.0, 15.0, 36.0, 66.0, 103.0, 130.0, 120.0, 96.0, 112.0, 43.0, 156.0, 85.0, 104.0, 101.0, 114.0, 208.0, 111.0, 80.0, 60.0, 198.0, 163.0, 85.0, 119.0, 54.0, -2.0, 23.0, 151.0, 151.0, 148.0, 96.0, 106.0, 135.0, 159.0, 135.0, 184.0, 139.0, 120.0, 198.0, 210.0, 101.0, 189.0, 141.0, 95.0, 104.0, 91.0, 87.0, 82.0, 142.0, 203.0, 223.0, 204.0, 13.0, 165.0, 115.0, 161.0, 182.0, 106.0, 203.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11343022249583071, "mean_inference_ms": 0.6837578453664225, "mean_action_processing_ms": 0.03558018125444971, "mean_env_wait_ms": 0.16322244050047455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007829904556274414, "StateBufferConnector_ms": 0.001336812973022461, "ViewRequirementAgentConnector_ms": 0.031358957290649414}, "num_episodes": 40, "episode_return_max": 223.0, "episode_return_min": -42.0, "episode_return_mean": 105.74, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.84089950576424, "num_env_steps_trained_throughput_per_sec": 494.84089950576424, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 8159.483, "restore_workers_time_ms": 0.009, "training_step_time_ms": 8159.43, "sample_time_ms": 4009.156, "load_time_ms": 1.242, "load_throughput": 3220401.049, "learn_time_ms": 4148.358, "learn_throughput": 964.237, "synch_weights_time_ms": 0.024}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 120, "training_iteration": 3, "trial_id": "default", "date": "2024-05-19_15-51-30", "timestamp": 1716159090, "time_this_iter_s": 8.084471940994263, "time_total_s": 24.48092269897461, "pid": 80385, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case2env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.008, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29d3e9750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 24.48092269897461, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 27.60909090909091, "ram_util_percent": 85.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.057406742662512, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.008000000000000004, "total_loss": Infinity, "policy_loss": 0.023569272735947243, "vf_loss": 9.836344737391318, "vf_explained_var": -0.5899243842529994, "kl": Infinity, "entropy": 0.6778484252511814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 253.0, "episode_reward_min": -2.0, "episode_reward_mean": 127.21, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [112.0, 46.0, 113.0, 15.0, 36.0, 66.0, 103.0, 130.0, 120.0, 96.0, 112.0, 43.0, 156.0, 85.0, 104.0, 101.0, 114.0, 208.0, 111.0, 80.0, 60.0, 198.0, 163.0, 85.0, 119.0, 54.0, -2.0, 23.0, 151.0, 151.0, 148.0, 96.0, 106.0, 135.0, 159.0, 135.0, 184.0, 139.0, 120.0, 198.0, 210.0, 101.0, 189.0, 141.0, 95.0, 104.0, 91.0, 87.0, 82.0, 142.0, 203.0, 223.0, 204.0, 13.0, 165.0, 115.0, 161.0, 182.0, 106.0, 203.0, 120.0, 172.0, 140.0, 160.0, 131.0, 69.0, 179.0, 152.0, -2.0, 215.0, 140.0, 122.0, 180.0, 148.0, 144.0, 135.0, 108.0, 91.0, 149.0, 151.0, 193.0, 201.0, 215.0, 141.0, 103.0, 199.0, 154.0, 41.0, 53.0, 253.0, 81.0, 162.0, 163.0, 208.0, 14.0, 132.0, 122.0, 135.0, 140.0, 117.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11564590806870222, "mean_inference_ms": 0.6899363152420287, "mean_action_processing_ms": 0.03581625737559295, "mean_env_wait_ms": 0.1648337962279269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008805513381958008, "StateBufferConnector_ms": 0.0013780593872070312, "ViewRequirementAgentConnector_ms": 0.03359794616699219}, "num_episodes": 40, "episode_return_max": 253.0, "episode_return_min": -2.0, "episode_return_mean": 127.21}, "env_runner_results": {"episode_reward_max": 253.0, "episode_reward_min": -2.0, "episode_reward_mean": 127.21, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [112.0, 46.0, 113.0, 15.0, 36.0, 66.0, 103.0, 130.0, 120.0, 96.0, 112.0, 43.0, 156.0, 85.0, 104.0, 101.0, 114.0, 208.0, 111.0, 80.0, 60.0, 198.0, 163.0, 85.0, 119.0, 54.0, -2.0, 23.0, 151.0, 151.0, 148.0, 96.0, 106.0, 135.0, 159.0, 135.0, 184.0, 139.0, 120.0, 198.0, 210.0, 101.0, 189.0, 141.0, 95.0, 104.0, 91.0, 87.0, 82.0, 142.0, 203.0, 223.0, 204.0, 13.0, 165.0, 115.0, 161.0, 182.0, 106.0, 203.0, 120.0, 172.0, 140.0, 160.0, 131.0, 69.0, 179.0, 152.0, -2.0, 215.0, 140.0, 122.0, 180.0, 148.0, 144.0, 135.0, 108.0, 91.0, 149.0, 151.0, 193.0, 201.0, 215.0, 141.0, 103.0, 199.0, 154.0, 41.0, 53.0, 253.0, 81.0, 162.0, 163.0, 208.0, 14.0, 132.0, 122.0, 135.0, 140.0, 117.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11564590806870222, "mean_inference_ms": 0.6899363152420287, "mean_action_processing_ms": 0.03581625737559295, "mean_env_wait_ms": 0.1648337962279269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008805513381958008, "StateBufferConnector_ms": 0.0013780593872070312, "ViewRequirementAgentConnector_ms": 0.03359794616699219}, "num_episodes": 40, "episode_return_max": 253.0, "episode_return_min": -2.0, "episode_return_mean": 127.21}, "episode_reward_max": 253.0, "episode_reward_min": -2.0, "episode_reward_mean": 127.21, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [112.0, 46.0, 113.0, 15.0, 36.0, 66.0, 103.0, 130.0, 120.0, 96.0, 112.0, 43.0, 156.0, 85.0, 104.0, 101.0, 114.0, 208.0, 111.0, 80.0, 60.0, 198.0, 163.0, 85.0, 119.0, 54.0, -2.0, 23.0, 151.0, 151.0, 148.0, 96.0, 106.0, 135.0, 159.0, 135.0, 184.0, 139.0, 120.0, 198.0, 210.0, 101.0, 189.0, 141.0, 95.0, 104.0, 91.0, 87.0, 82.0, 142.0, 203.0, 223.0, 204.0, 13.0, 165.0, 115.0, 161.0, 182.0, 106.0, 203.0, 120.0, 172.0, 140.0, 160.0, 131.0, 69.0, 179.0, 152.0, -2.0, 215.0, 140.0, 122.0, 180.0, 148.0, 144.0, 135.0, 108.0, 91.0, 149.0, 151.0, 193.0, 201.0, 215.0, 141.0, 103.0, 199.0, 154.0, 41.0, 53.0, 253.0, 81.0, 162.0, 163.0, 208.0, 14.0, 132.0, 122.0, 135.0, 140.0, 117.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11564590806870222, "mean_inference_ms": 0.6899363152420287, "mean_action_processing_ms": 0.03581625737559295, "mean_env_wait_ms": 0.1648337962279269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008805513381958008, "StateBufferConnector_ms": 0.0013780593872070312, "ViewRequirementAgentConnector_ms": 0.03359794616699219}, "num_episodes": 40, "episode_return_max": 253.0, "episode_return_min": -2.0, "episode_return_mean": 127.21, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 474.44305691911444, "num_env_steps_trained_throughput_per_sec": 474.44305691911444, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 8227.353, "restore_workers_time_ms": 0.01, "training_step_time_ms": 8227.295, "sample_time_ms": 4100.832, "load_time_ms": 1.306, "load_throughput": 3063911.976, "learn_time_ms": 4124.51, "learn_throughput": 969.812, "synch_weights_time_ms": 0.026}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 160, "training_iteration": 4, "trial_id": "default", "date": "2024-05-19_15-51-38", "timestamp": 1716159098, "time_this_iter_s": 8.432009935379028, "time_total_s": 32.91293263435364, "pid": 80385, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case2env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.008, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29d3e9750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 32.91293263435364, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 28.650000000000002, "ram_util_percent": 85.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.110555023403577, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.008000000000000004, "total_loss": 10.222530291157383, "policy_loss": 0.010844714795639839, "vf_loss": 9.995092909823182, "vf_explained_var": -0.17101376107943955, "kl": 0.21391865664290752, "entropy": 0.7434547825205711, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 261.0, "episode_reward_min": -2.0, "episode_reward_mean": 156.58, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.0, 101.0, 189.0, 141.0, 95.0, 104.0, 91.0, 87.0, 82.0, 142.0, 203.0, 223.0, 204.0, 13.0, 165.0, 115.0, 161.0, 182.0, 106.0, 203.0, 120.0, 172.0, 140.0, 160.0, 131.0, 69.0, 179.0, 152.0, -2.0, 215.0, 140.0, 122.0, 180.0, 148.0, 144.0, 135.0, 108.0, 91.0, 149.0, 151.0, 193.0, 201.0, 215.0, 141.0, 103.0, 199.0, 154.0, 41.0, 53.0, 253.0, 81.0, 162.0, 163.0, 208.0, 14.0, 132.0, 122.0, 135.0, 140.0, 117.0, 173.0, 155.0, 127.0, 139.0, 191.0, 183.0, 252.0, 242.0, 181.0, 183.0, 150.0, 130.0, 181.0, 261.0, 171.0, 207.0, 252.0, 150.0, 127.0, 181.0, 256.0, 176.0, 224.0, 183.0, 135.0, 202.0, 142.0, 187.0, 199.0, 216.0, 152.0, 157.0, 184.0, 201.0, 169.0, 202.0, 151.0, 179.0, 102.0, 257.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11712627759990704, "mean_inference_ms": 0.6934262576080795, "mean_action_processing_ms": 0.035972575268096135, "mean_env_wait_ms": 0.16591022582469275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008803129196166992, "StateBufferConnector_ms": 0.0013976097106933594, "ViewRequirementAgentConnector_ms": 0.033522605895996094}, "num_episodes": 40, "episode_return_max": 261.0, "episode_return_min": -2.0, "episode_return_mean": 156.58}, "env_runner_results": {"episode_reward_max": 261.0, "episode_reward_min": -2.0, "episode_reward_mean": 156.58, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.0, 101.0, 189.0, 141.0, 95.0, 104.0, 91.0, 87.0, 82.0, 142.0, 203.0, 223.0, 204.0, 13.0, 165.0, 115.0, 161.0, 182.0, 106.0, 203.0, 120.0, 172.0, 140.0, 160.0, 131.0, 69.0, 179.0, 152.0, -2.0, 215.0, 140.0, 122.0, 180.0, 148.0, 144.0, 135.0, 108.0, 91.0, 149.0, 151.0, 193.0, 201.0, 215.0, 141.0, 103.0, 199.0, 154.0, 41.0, 53.0, 253.0, 81.0, 162.0, 163.0, 208.0, 14.0, 132.0, 122.0, 135.0, 140.0, 117.0, 173.0, 155.0, 127.0, 139.0, 191.0, 183.0, 252.0, 242.0, 181.0, 183.0, 150.0, 130.0, 181.0, 261.0, 171.0, 207.0, 252.0, 150.0, 127.0, 181.0, 256.0, 176.0, 224.0, 183.0, 135.0, 202.0, 142.0, 187.0, 199.0, 216.0, 152.0, 157.0, 184.0, 201.0, 169.0, 202.0, 151.0, 179.0, 102.0, 257.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11712627759990704, "mean_inference_ms": 0.6934262576080795, "mean_action_processing_ms": 0.035972575268096135, "mean_env_wait_ms": 0.16591022582469275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008803129196166992, "StateBufferConnector_ms": 0.0013976097106933594, "ViewRequirementAgentConnector_ms": 0.033522605895996094}, "num_episodes": 40, "episode_return_max": 261.0, "episode_return_min": -2.0, "episode_return_mean": 156.58}, "episode_reward_max": 261.0, "episode_reward_min": -2.0, "episode_reward_mean": 156.58, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [210.0, 101.0, 189.0, 141.0, 95.0, 104.0, 91.0, 87.0, 82.0, 142.0, 203.0, 223.0, 204.0, 13.0, 165.0, 115.0, 161.0, 182.0, 106.0, 203.0, 120.0, 172.0, 140.0, 160.0, 131.0, 69.0, 179.0, 152.0, -2.0, 215.0, 140.0, 122.0, 180.0, 148.0, 144.0, 135.0, 108.0, 91.0, 149.0, 151.0, 193.0, 201.0, 215.0, 141.0, 103.0, 199.0, 154.0, 41.0, 53.0, 253.0, 81.0, 162.0, 163.0, 208.0, 14.0, 132.0, 122.0, 135.0, 140.0, 117.0, 173.0, 155.0, 127.0, 139.0, 191.0, 183.0, 252.0, 242.0, 181.0, 183.0, 150.0, 130.0, 181.0, 261.0, 171.0, 207.0, 252.0, 150.0, 127.0, 181.0, 256.0, 176.0, 224.0, 183.0, 135.0, 202.0, 142.0, 187.0, 199.0, 216.0, 152.0, 157.0, 184.0, 201.0, 169.0, 202.0, 151.0, 179.0, 102.0, 257.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11712627759990704, "mean_inference_ms": 0.6934262576080795, "mean_action_processing_ms": 0.035972575268096135, "mean_env_wait_ms": 0.16591022582469275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008803129196166992, "StateBufferConnector_ms": 0.0013976097106933594, "ViewRequirementAgentConnector_ms": 0.033522605895996094}, "num_episodes": 40, "episode_return_max": 261.0, "episode_return_min": -2.0, "episode_return_mean": 156.58, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.7884844689838, "num_env_steps_trained_throughput_per_sec": 503.7884844689838, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 8169.853, "restore_workers_time_ms": 0.01, "training_step_time_ms": 8169.8, "sample_time_ms": 4067.73, "load_time_ms": 1.249, "load_throughput": 3202003.206, "learn_time_ms": 4100.212, "learn_throughput": 975.559, "synch_weights_time_ms": 0.021}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 200, "training_iteration": 5, "trial_id": "default", "date": "2024-05-19_15-51-46", "timestamp": 1716159106, "time_this_iter_s": 7.940590143203735, "time_total_s": 40.85352277755737, "pid": 80385, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case2env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.008, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29d3e9750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 40.85352277755737, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 21.891666666666666, "ram_util_percent": 83.59166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.383504542099532, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.008000000000000004, "total_loss": 10.216465938732188, "policy_loss": -0.020986801427939246, "vf_loss": 9.999818973131077, "vf_explained_var": -0.1641749745415103, "kl": 0.1564667104306977, "entropy": 0.6810090115474117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 261.0, "episode_reward_min": 14.0, "episode_reward_mean": 175.64, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193.0, 201.0, 215.0, 141.0, 103.0, 199.0, 154.0, 41.0, 53.0, 253.0, 81.0, 162.0, 163.0, 208.0, 14.0, 132.0, 122.0, 135.0, 140.0, 117.0, 173.0, 155.0, 127.0, 139.0, 191.0, 183.0, 252.0, 242.0, 181.0, 183.0, 150.0, 130.0, 181.0, 261.0, 171.0, 207.0, 252.0, 150.0, 127.0, 181.0, 256.0, 176.0, 224.0, 183.0, 135.0, 202.0, 142.0, 187.0, 199.0, 216.0, 152.0, 157.0, 184.0, 201.0, 169.0, 202.0, 151.0, 179.0, 102.0, 257.0, 182.0, 226.0, 234.0, 136.0, 191.0, 226.0, 206.0, 241.0, 236.0, 189.0, 190.0, 205.0, 219.0, 145.0, 142.0, 162.0, 185.0, 144.0, 230.0, 86.0, 135.0, 114.0, 184.0, 145.0, 188.0, 224.0, 152.0, 200.0, 235.0, 156.0, 213.0, 151.0, 157.0, 159.0, 211.0, 252.0, 139.0, 226.0, 191.0, 220.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11751442457292229, "mean_inference_ms": 0.6954857655019887, "mean_action_processing_ms": 0.036054448653572074, "mean_env_wait_ms": 0.16689892640930032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008863687515258789, "StateBufferConnector_ms": 0.0013930797576904297, "ViewRequirementAgentConnector_ms": 0.03329062461853027}, "num_episodes": 40, "episode_return_max": 261.0, "episode_return_min": 14.0, "episode_return_mean": 175.64}, "env_runner_results": {"episode_reward_max": 261.0, "episode_reward_min": 14.0, "episode_reward_mean": 175.64, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193.0, 201.0, 215.0, 141.0, 103.0, 199.0, 154.0, 41.0, 53.0, 253.0, 81.0, 162.0, 163.0, 208.0, 14.0, 132.0, 122.0, 135.0, 140.0, 117.0, 173.0, 155.0, 127.0, 139.0, 191.0, 183.0, 252.0, 242.0, 181.0, 183.0, 150.0, 130.0, 181.0, 261.0, 171.0, 207.0, 252.0, 150.0, 127.0, 181.0, 256.0, 176.0, 224.0, 183.0, 135.0, 202.0, 142.0, 187.0, 199.0, 216.0, 152.0, 157.0, 184.0, 201.0, 169.0, 202.0, 151.0, 179.0, 102.0, 257.0, 182.0, 226.0, 234.0, 136.0, 191.0, 226.0, 206.0, 241.0, 236.0, 189.0, 190.0, 205.0, 219.0, 145.0, 142.0, 162.0, 185.0, 144.0, 230.0, 86.0, 135.0, 114.0, 184.0, 145.0, 188.0, 224.0, 152.0, 200.0, 235.0, 156.0, 213.0, 151.0, 157.0, 159.0, 211.0, 252.0, 139.0, 226.0, 191.0, 220.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11751442457292229, "mean_inference_ms": 0.6954857655019887, "mean_action_processing_ms": 0.036054448653572074, "mean_env_wait_ms": 0.16689892640930032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008863687515258789, "StateBufferConnector_ms": 0.0013930797576904297, "ViewRequirementAgentConnector_ms": 0.03329062461853027}, "num_episodes": 40, "episode_return_max": 261.0, "episode_return_min": 14.0, "episode_return_mean": 175.64}, "episode_reward_max": 261.0, "episode_reward_min": 14.0, "episode_reward_mean": 175.64, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [193.0, 201.0, 215.0, 141.0, 103.0, 199.0, 154.0, 41.0, 53.0, 253.0, 81.0, 162.0, 163.0, 208.0, 14.0, 132.0, 122.0, 135.0, 140.0, 117.0, 173.0, 155.0, 127.0, 139.0, 191.0, 183.0, 252.0, 242.0, 181.0, 183.0, 150.0, 130.0, 181.0, 261.0, 171.0, 207.0, 252.0, 150.0, 127.0, 181.0, 256.0, 176.0, 224.0, 183.0, 135.0, 202.0, 142.0, 187.0, 199.0, 216.0, 152.0, 157.0, 184.0, 201.0, 169.0, 202.0, 151.0, 179.0, 102.0, 257.0, 182.0, 226.0, 234.0, 136.0, 191.0, 226.0, 206.0, 241.0, 236.0, 189.0, 190.0, 205.0, 219.0, 145.0, 142.0, 162.0, 185.0, 144.0, 230.0, 86.0, 135.0, 114.0, 184.0, 145.0, 188.0, 224.0, 152.0, 200.0, 235.0, 156.0, 213.0, 151.0, 157.0, 159.0, 211.0, 252.0, 139.0, 226.0, 191.0, 220.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11751442457292229, "mean_inference_ms": 0.6954857655019887, "mean_action_processing_ms": 0.036054448653572074, "mean_env_wait_ms": 0.16689892640930032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008863687515258789, "StateBufferConnector_ms": 0.0013930797576904297, "ViewRequirementAgentConnector_ms": 0.03329062461853027}, "num_episodes": 40, "episode_return_max": 261.0, "episode_return_min": 14.0, "episode_return_mean": 175.64, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 427.8717316383877, "num_env_steps_trained_throughput_per_sec": 427.8717316383877, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 8366.315, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8366.255, "sample_time_ms": 4089.479, "load_time_ms": 1.291, "load_throughput": 3099143.992, "learn_time_ms": 4274.901, "learn_throughput": 935.694, "synch_weights_time_ms": 0.018}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 240, "training_iteration": 6, "trial_id": "default", "date": "2024-05-19_15-51-56", "timestamp": 1716159116, "time_this_iter_s": 9.349414825439453, "time_total_s": 50.202937602996826, "pid": 80385, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case2env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.008, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29d3e9750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 50.202937602996826, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 30.26923076923077, "ram_util_percent": 85.29230769230769}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.627200088577887, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.008000000000000004, "total_loss": 10.524775627095213, "policy_loss": 0.020751731123484832, "vf_loss": 9.984184812730359, "vf_explained_var": -0.5721609267496294, "kl": 0.2281872443688878, "entropy": 0.7183740566174189, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 267.0, "episode_reward_min": 11.0, "episode_reward_mean": 179.01, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [256.0, 176.0, 224.0, 183.0, 135.0, 202.0, 142.0, 187.0, 199.0, 216.0, 152.0, 157.0, 184.0, 201.0, 169.0, 202.0, 151.0, 179.0, 102.0, 257.0, 182.0, 226.0, 234.0, 136.0, 191.0, 226.0, 206.0, 241.0, 236.0, 189.0, 190.0, 205.0, 219.0, 145.0, 142.0, 162.0, 185.0, 144.0, 230.0, 86.0, 135.0, 114.0, 184.0, 145.0, 188.0, 224.0, 152.0, 200.0, 235.0, 156.0, 213.0, 151.0, 157.0, 159.0, 211.0, 252.0, 139.0, 226.0, 191.0, 220.0, 213.0, 52.0, 158.0, 212.0, 128.0, 99.0, 223.0, 157.0, 221.0, 213.0, 129.0, 170.0, 141.0, 219.0, 223.0, 246.0, 267.0, 161.0, 153.0, 137.0, 174.0, 235.0, 185.0, 179.0, 212.0, 165.0, 11.0, 155.0, 216.0, 156.0, 209.0, 236.0, 168.0, 209.0, 182.0, 138.0, 103.0, 84.0, 178.0, 83.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11691024057651773, "mean_inference_ms": 0.6947339190419112, "mean_action_processing_ms": 0.03597872315890507, "mean_env_wait_ms": 0.16725281980585358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007993936538696289, "StateBufferConnector_ms": 0.0013315677642822266, "ViewRequirementAgentConnector_ms": 0.031157493591308594}, "num_episodes": 40, "episode_return_max": 267.0, "episode_return_min": 11.0, "episode_return_mean": 179.01}, "env_runner_results": {"episode_reward_max": 267.0, "episode_reward_min": 11.0, "episode_reward_mean": 179.01, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [256.0, 176.0, 224.0, 183.0, 135.0, 202.0, 142.0, 187.0, 199.0, 216.0, 152.0, 157.0, 184.0, 201.0, 169.0, 202.0, 151.0, 179.0, 102.0, 257.0, 182.0, 226.0, 234.0, 136.0, 191.0, 226.0, 206.0, 241.0, 236.0, 189.0, 190.0, 205.0, 219.0, 145.0, 142.0, 162.0, 185.0, 144.0, 230.0, 86.0, 135.0, 114.0, 184.0, 145.0, 188.0, 224.0, 152.0, 200.0, 235.0, 156.0, 213.0, 151.0, 157.0, 159.0, 211.0, 252.0, 139.0, 226.0, 191.0, 220.0, 213.0, 52.0, 158.0, 212.0, 128.0, 99.0, 223.0, 157.0, 221.0, 213.0, 129.0, 170.0, 141.0, 219.0, 223.0, 246.0, 267.0, 161.0, 153.0, 137.0, 174.0, 235.0, 185.0, 179.0, 212.0, 165.0, 11.0, 155.0, 216.0, 156.0, 209.0, 236.0, 168.0, 209.0, 182.0, 138.0, 103.0, 84.0, 178.0, 83.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11691024057651773, "mean_inference_ms": 0.6947339190419112, "mean_action_processing_ms": 0.03597872315890507, "mean_env_wait_ms": 0.16725281980585358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007993936538696289, "StateBufferConnector_ms": 0.0013315677642822266, "ViewRequirementAgentConnector_ms": 0.031157493591308594}, "num_episodes": 40, "episode_return_max": 267.0, "episode_return_min": 11.0, "episode_return_mean": 179.01}, "episode_reward_max": 267.0, "episode_reward_min": 11.0, "episode_reward_mean": 179.01, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [256.0, 176.0, 224.0, 183.0, 135.0, 202.0, 142.0, 187.0, 199.0, 216.0, 152.0, 157.0, 184.0, 201.0, 169.0, 202.0, 151.0, 179.0, 102.0, 257.0, 182.0, 226.0, 234.0, 136.0, 191.0, 226.0, 206.0, 241.0, 236.0, 189.0, 190.0, 205.0, 219.0, 145.0, 142.0, 162.0, 185.0, 144.0, 230.0, 86.0, 135.0, 114.0, 184.0, 145.0, 188.0, 224.0, 152.0, 200.0, 235.0, 156.0, 213.0, 151.0, 157.0, 159.0, 211.0, 252.0, 139.0, 226.0, 191.0, 220.0, 213.0, 52.0, 158.0, 212.0, 128.0, 99.0, 223.0, 157.0, 221.0, 213.0, 129.0, 170.0, 141.0, 219.0, 223.0, 246.0, 267.0, 161.0, 153.0, 137.0, 174.0, 235.0, 185.0, 179.0, 212.0, 165.0, 11.0, 155.0, 216.0, 156.0, 209.0, 236.0, 168.0, 209.0, 182.0, 138.0, 103.0, 84.0, 178.0, 83.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11691024057651773, "mean_inference_ms": 0.6947339190419112, "mean_action_processing_ms": 0.03597872315890507, "mean_env_wait_ms": 0.16725281980585358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007993936538696289, "StateBufferConnector_ms": 0.0013315677642822266, "ViewRequirementAgentConnector_ms": 0.031157493591308594}, "num_episodes": 40, "episode_return_max": 267.0, "episode_return_min": 11.0, "episode_return_mean": 179.01, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.71541579940924, "num_env_steps_trained_throughput_per_sec": 501.71541579940924, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 8310.078, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8310.02, "sample_time_ms": 4072.927, "load_time_ms": 1.288, "load_throughput": 3105577.322, "learn_time_ms": 4235.253, "learn_throughput": 944.454, "synch_weights_time_ms": 0.017}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 280, "training_iteration": 7, "trial_id": "default", "date": "2024-05-19_15-52-04", "timestamp": 1716159124, "time_this_iter_s": 7.973206996917725, "time_total_s": 58.17614459991455, "pid": 80385, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case2env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.008, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29d3e9750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 58.17614459991455, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 20.79090909090909, "ram_util_percent": 82.53636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.900232214056036, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.008000000000000004, "total_loss": Infinity, "policy_loss": 0.009966171203902172, "vf_loss": 9.995300295019662, "vf_explained_var": -0.41321621268026293, "kl": Infinity, "entropy": 0.5234801447359464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 290.0, "episode_reward_min": 11.0, "episode_reward_mean": 189.65, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.0, 114.0, 184.0, 145.0, 188.0, 224.0, 152.0, 200.0, 235.0, 156.0, 213.0, 151.0, 157.0, 159.0, 211.0, 252.0, 139.0, 226.0, 191.0, 220.0, 213.0, 52.0, 158.0, 212.0, 128.0, 99.0, 223.0, 157.0, 221.0, 213.0, 129.0, 170.0, 141.0, 219.0, 223.0, 246.0, 267.0, 161.0, 153.0, 137.0, 174.0, 235.0, 185.0, 179.0, 212.0, 165.0, 11.0, 155.0, 216.0, 156.0, 209.0, 236.0, 168.0, 209.0, 182.0, 138.0, 103.0, 84.0, 178.0, 83.0, 250.0, 290.0, 219.0, 228.0, 254.0, 227.0, 212.0, 187.0, 195.0, 200.0, 261.0, 235.0, 211.0, 127.0, 172.0, 187.0, 256.0, 275.0, 198.0, 191.0, 210.0, 287.0, 229.0, 237.0, 197.0, 195.0, 126.0, 198.0, 237.0, 188.0, 182.0, 145.0, 235.0, 231.0, 266.0, 203.0, 217.0, 174.0, 227.0, 154.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11875448140477353, "mean_inference_ms": 0.6971662264244837, "mean_action_processing_ms": 0.036117109595317415, "mean_env_wait_ms": 0.16821008972923607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008595466613769531, "StateBufferConnector_ms": 0.0013484954833984375, "ViewRequirementAgentConnector_ms": 0.03252434730529785}, "num_episodes": 40, "episode_return_max": 290.0, "episode_return_min": 11.0, "episode_return_mean": 189.65}, "env_runner_results": {"episode_reward_max": 290.0, "episode_reward_min": 11.0, "episode_reward_mean": 189.65, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.0, 114.0, 184.0, 145.0, 188.0, 224.0, 152.0, 200.0, 235.0, 156.0, 213.0, 151.0, 157.0, 159.0, 211.0, 252.0, 139.0, 226.0, 191.0, 220.0, 213.0, 52.0, 158.0, 212.0, 128.0, 99.0, 223.0, 157.0, 221.0, 213.0, 129.0, 170.0, 141.0, 219.0, 223.0, 246.0, 267.0, 161.0, 153.0, 137.0, 174.0, 235.0, 185.0, 179.0, 212.0, 165.0, 11.0, 155.0, 216.0, 156.0, 209.0, 236.0, 168.0, 209.0, 182.0, 138.0, 103.0, 84.0, 178.0, 83.0, 250.0, 290.0, 219.0, 228.0, 254.0, 227.0, 212.0, 187.0, 195.0, 200.0, 261.0, 235.0, 211.0, 127.0, 172.0, 187.0, 256.0, 275.0, 198.0, 191.0, 210.0, 287.0, 229.0, 237.0, 197.0, 195.0, 126.0, 198.0, 237.0, 188.0, 182.0, 145.0, 235.0, 231.0, 266.0, 203.0, 217.0, 174.0, 227.0, 154.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11875448140477353, "mean_inference_ms": 0.6971662264244837, "mean_action_processing_ms": 0.036117109595317415, "mean_env_wait_ms": 0.16821008972923607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008595466613769531, "StateBufferConnector_ms": 0.0013484954833984375, "ViewRequirementAgentConnector_ms": 0.03252434730529785}, "num_episodes": 40, "episode_return_max": 290.0, "episode_return_min": 11.0, "episode_return_mean": 189.65}, "episode_reward_max": 290.0, "episode_reward_min": 11.0, "episode_reward_mean": 189.65, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [135.0, 114.0, 184.0, 145.0, 188.0, 224.0, 152.0, 200.0, 235.0, 156.0, 213.0, 151.0, 157.0, 159.0, 211.0, 252.0, 139.0, 226.0, 191.0, 220.0, 213.0, 52.0, 158.0, 212.0, 128.0, 99.0, 223.0, 157.0, 221.0, 213.0, 129.0, 170.0, 141.0, 219.0, 223.0, 246.0, 267.0, 161.0, 153.0, 137.0, 174.0, 235.0, 185.0, 179.0, 212.0, 165.0, 11.0, 155.0, 216.0, 156.0, 209.0, 236.0, 168.0, 209.0, 182.0, 138.0, 103.0, 84.0, 178.0, 83.0, 250.0, 290.0, 219.0, 228.0, 254.0, 227.0, 212.0, 187.0, 195.0, 200.0, 261.0, 235.0, 211.0, 127.0, 172.0, 187.0, 256.0, 275.0, 198.0, 191.0, 210.0, 287.0, 229.0, 237.0, 197.0, 195.0, 126.0, 198.0, 237.0, 188.0, 182.0, 145.0, 235.0, 231.0, 266.0, 203.0, 217.0, 174.0, 227.0, 154.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11875448140477353, "mean_inference_ms": 0.6971662264244837, "mean_action_processing_ms": 0.036117109595317415, "mean_env_wait_ms": 0.16821008972923607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008595466613769531, "StateBufferConnector_ms": 0.0013484954833984375, "ViewRequirementAgentConnector_ms": 0.03252434730529785}, "num_episodes": 40, "episode_return_max": 290.0, "episode_return_min": 11.0, "episode_return_mean": 189.65, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 463.86014203719543, "num_env_steps_trained_throughput_per_sec": 463.86014203719543, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 8349.231, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8349.172, "sample_time_ms": 4132.68, "load_time_ms": 2.715, "load_throughput": 1473155.539, "learn_time_ms": 4213.232, "learn_throughput": 949.39, "synch_weights_time_ms": 0.016}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 320, "training_iteration": 8, "trial_id": "default", "date": "2024-05-19_15-52-12", "timestamp": 1716159132, "time_this_iter_s": 8.624090909957886, "time_total_s": 66.80023550987244, "pid": 80385, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case2env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.008, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29d3e9750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 66.80023550987244, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 32.86923076923077, "ram_util_percent": 85.06923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.4178082234116, "cur_kl_coeff": 5.12578125, "cur_lr": 0.008000000000000004, "total_loss": Infinity, "policy_loss": 0.02939198989050603, "vf_loss": 10.0, "vf_explained_var": -0.5159232202396598, "kl": Infinity, "entropy": 0.5969700740550155, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 290.0, "episode_reward_min": 3.0, "episode_reward_mean": 176.37, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.0, 235.0, 185.0, 179.0, 212.0, 165.0, 11.0, 155.0, 216.0, 156.0, 209.0, 236.0, 168.0, 209.0, 182.0, 138.0, 103.0, 84.0, 178.0, 83.0, 250.0, 290.0, 219.0, 228.0, 254.0, 227.0, 212.0, 187.0, 195.0, 200.0, 261.0, 235.0, 211.0, 127.0, 172.0, 187.0, 256.0, 275.0, 198.0, 191.0, 210.0, 287.0, 229.0, 237.0, 197.0, 195.0, 126.0, 198.0, 237.0, 188.0, 182.0, 145.0, 235.0, 231.0, 266.0, 203.0, 217.0, 174.0, 227.0, 154.0, 200.0, 162.0, 151.0, 179.0, 162.0, 166.0, 146.0, 114.0, 157.0, 216.0, 100.0, 238.0, 164.0, 154.0, 184.0, 71.0, 94.0, 157.0, 141.0, 233.0, 184.0, 184.0, 205.0, 3.0, 108.0, 199.0, 126.0, 133.0, 112.0, 44.0, 139.0, 102.0, 103.0, 213.0, 127.0, 137.0, 159.0, 171.0, 78.0, 130.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12040629395562302, "mean_inference_ms": 0.6987355375613703, "mean_action_processing_ms": 0.03622739212300223, "mean_env_wait_ms": 0.16882485380308837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0086669921875, "StateBufferConnector_ms": 0.0013551712036132812, "ViewRequirementAgentConnector_ms": 0.03269171714782715}, "num_episodes": 40, "episode_return_max": 290.0, "episode_return_min": 3.0, "episode_return_mean": 176.37}, "env_runner_results": {"episode_reward_max": 290.0, "episode_reward_min": 3.0, "episode_reward_mean": 176.37, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.0, 235.0, 185.0, 179.0, 212.0, 165.0, 11.0, 155.0, 216.0, 156.0, 209.0, 236.0, 168.0, 209.0, 182.0, 138.0, 103.0, 84.0, 178.0, 83.0, 250.0, 290.0, 219.0, 228.0, 254.0, 227.0, 212.0, 187.0, 195.0, 200.0, 261.0, 235.0, 211.0, 127.0, 172.0, 187.0, 256.0, 275.0, 198.0, 191.0, 210.0, 287.0, 229.0, 237.0, 197.0, 195.0, 126.0, 198.0, 237.0, 188.0, 182.0, 145.0, 235.0, 231.0, 266.0, 203.0, 217.0, 174.0, 227.0, 154.0, 200.0, 162.0, 151.0, 179.0, 162.0, 166.0, 146.0, 114.0, 157.0, 216.0, 100.0, 238.0, 164.0, 154.0, 184.0, 71.0, 94.0, 157.0, 141.0, 233.0, 184.0, 184.0, 205.0, 3.0, 108.0, 199.0, 126.0, 133.0, 112.0, 44.0, 139.0, 102.0, 103.0, 213.0, 127.0, 137.0, 159.0, 171.0, 78.0, 130.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12040629395562302, "mean_inference_ms": 0.6987355375613703, "mean_action_processing_ms": 0.03622739212300223, "mean_env_wait_ms": 0.16882485380308837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0086669921875, "StateBufferConnector_ms": 0.0013551712036132812, "ViewRequirementAgentConnector_ms": 0.03269171714782715}, "num_episodes": 40, "episode_return_max": 290.0, "episode_return_min": 3.0, "episode_return_mean": 176.37}, "episode_reward_max": 290.0, "episode_reward_min": 3.0, "episode_reward_mean": 176.37, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [174.0, 235.0, 185.0, 179.0, 212.0, 165.0, 11.0, 155.0, 216.0, 156.0, 209.0, 236.0, 168.0, 209.0, 182.0, 138.0, 103.0, 84.0, 178.0, 83.0, 250.0, 290.0, 219.0, 228.0, 254.0, 227.0, 212.0, 187.0, 195.0, 200.0, 261.0, 235.0, 211.0, 127.0, 172.0, 187.0, 256.0, 275.0, 198.0, 191.0, 210.0, 287.0, 229.0, 237.0, 197.0, 195.0, 126.0, 198.0, 237.0, 188.0, 182.0, 145.0, 235.0, 231.0, 266.0, 203.0, 217.0, 174.0, 227.0, 154.0, 200.0, 162.0, 151.0, 179.0, 162.0, 166.0, 146.0, 114.0, 157.0, 216.0, 100.0, 238.0, 164.0, 154.0, 184.0, 71.0, 94.0, 157.0, 141.0, 233.0, 184.0, 184.0, 205.0, 3.0, 108.0, 199.0, 126.0, 133.0, 112.0, 44.0, 139.0, 102.0, 103.0, 213.0, 127.0, 137.0, 159.0, 171.0, 78.0, 130.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12040629395562302, "mean_inference_ms": 0.6987355375613703, "mean_action_processing_ms": 0.03622739212300223, "mean_env_wait_ms": 0.16882485380308837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0086669921875, "StateBufferConnector_ms": 0.0013551712036132812, "ViewRequirementAgentConnector_ms": 0.03269171714782715}, "num_episodes": 40, "episode_return_max": 290.0, "episode_return_min": 3.0, "episode_return_mean": 176.37, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 466.6535844761591, "num_env_steps_trained_throughput_per_sec": 466.6535844761591, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 8373.948, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8373.885, "sample_time_ms": 4121.015, "load_time_ms": 2.552, "load_throughput": 1567443.259, "learn_time_ms": 4249.745, "learn_throughput": 941.233, "synch_weights_time_ms": 0.02}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 360, "training_iteration": 9, "trial_id": "default", "date": "2024-05-19_15-52-21", "timestamp": 1716159141, "time_this_iter_s": 8.573602199554443, "time_total_s": 75.37383770942688, "pid": 80385, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case2env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.008, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29d3e9750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 75.37383770942688, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 32.083333333333336, "ram_util_percent": 85.91666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.12805747037293, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.008000000000000004, "total_loss": Infinity, "policy_loss": 0.018930733219910692, "vf_loss": 10.0, "vf_explained_var": -0.43719399193281766, "kl": Infinity, "entropy": 0.6514793648354469, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 287.0, "episode_reward_min": 3.0, "episode_reward_mean": 163.41, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.0, 287.0, 229.0, 237.0, 197.0, 195.0, 126.0, 198.0, 237.0, 188.0, 182.0, 145.0, 235.0, 231.0, 266.0, 203.0, 217.0, 174.0, 227.0, 154.0, 200.0, 162.0, 151.0, 179.0, 162.0, 166.0, 146.0, 114.0, 157.0, 216.0, 100.0, 238.0, 164.0, 154.0, 184.0, 71.0, 94.0, 157.0, 141.0, 233.0, 184.0, 184.0, 205.0, 3.0, 108.0, 199.0, 126.0, 133.0, 112.0, 44.0, 139.0, 102.0, 103.0, 213.0, 127.0, 137.0, 159.0, 171.0, 78.0, 130.0, 182.0, 235.0, 262.0, 79.0, 180.0, 222.0, 136.0, 205.0, 203.0, 159.0, 81.0, 191.0, 159.0, 50.0, 219.0, 140.0, 56.0, 229.0, 98.0, 208.0, 211.0, 144.0, 169.0, 188.0, 224.0, 70.0, 199.0, 131.0, 161.0, 135.0, 233.0, 103.0, 123.0, 81.0, 115.0, 136.0, 190.0, 101.0, 163.0, 186.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12103618444524664, "mean_inference_ms": 0.6991263458045356, "mean_action_processing_ms": 0.0362553175292549, "mean_env_wait_ms": 0.16899168967551786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008505105972290039, "StateBufferConnector_ms": 0.0013723373413085938, "ViewRequirementAgentConnector_ms": 0.03279590606689453}, "num_episodes": 40, "episode_return_max": 287.0, "episode_return_min": 3.0, "episode_return_mean": 163.41}, "env_runner_results": {"episode_reward_max": 287.0, "episode_reward_min": 3.0, "episode_reward_mean": 163.41, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.0, 287.0, 229.0, 237.0, 197.0, 195.0, 126.0, 198.0, 237.0, 188.0, 182.0, 145.0, 235.0, 231.0, 266.0, 203.0, 217.0, 174.0, 227.0, 154.0, 200.0, 162.0, 151.0, 179.0, 162.0, 166.0, 146.0, 114.0, 157.0, 216.0, 100.0, 238.0, 164.0, 154.0, 184.0, 71.0, 94.0, 157.0, 141.0, 233.0, 184.0, 184.0, 205.0, 3.0, 108.0, 199.0, 126.0, 133.0, 112.0, 44.0, 139.0, 102.0, 103.0, 213.0, 127.0, 137.0, 159.0, 171.0, 78.0, 130.0, 182.0, 235.0, 262.0, 79.0, 180.0, 222.0, 136.0, 205.0, 203.0, 159.0, 81.0, 191.0, 159.0, 50.0, 219.0, 140.0, 56.0, 229.0, 98.0, 208.0, 211.0, 144.0, 169.0, 188.0, 224.0, 70.0, 199.0, 131.0, 161.0, 135.0, 233.0, 103.0, 123.0, 81.0, 115.0, 136.0, 190.0, 101.0, 163.0, 186.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12103618444524664, "mean_inference_ms": 0.6991263458045356, "mean_action_processing_ms": 0.0362553175292549, "mean_env_wait_ms": 0.16899168967551786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008505105972290039, "StateBufferConnector_ms": 0.0013723373413085938, "ViewRequirementAgentConnector_ms": 0.03279590606689453}, "num_episodes": 40, "episode_return_max": 287.0, "episode_return_min": 3.0, "episode_return_mean": 163.41}, "episode_reward_max": 287.0, "episode_reward_min": 3.0, "episode_reward_mean": 163.41, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [210.0, 287.0, 229.0, 237.0, 197.0, 195.0, 126.0, 198.0, 237.0, 188.0, 182.0, 145.0, 235.0, 231.0, 266.0, 203.0, 217.0, 174.0, 227.0, 154.0, 200.0, 162.0, 151.0, 179.0, 162.0, 166.0, 146.0, 114.0, 157.0, 216.0, 100.0, 238.0, 164.0, 154.0, 184.0, 71.0, 94.0, 157.0, 141.0, 233.0, 184.0, 184.0, 205.0, 3.0, 108.0, 199.0, 126.0, 133.0, 112.0, 44.0, 139.0, 102.0, 103.0, 213.0, 127.0, 137.0, 159.0, 171.0, 78.0, 130.0, 182.0, 235.0, 262.0, 79.0, 180.0, 222.0, 136.0, 205.0, 203.0, 159.0, 81.0, 191.0, 159.0, 50.0, 219.0, 140.0, 56.0, 229.0, 98.0, 208.0, 211.0, 144.0, 169.0, 188.0, 224.0, 70.0, 199.0, 131.0, 161.0, 135.0, 233.0, 103.0, 123.0, 81.0, 115.0, 136.0, 190.0, 101.0, 163.0, 186.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12103618444524664, "mean_inference_ms": 0.6991263458045356, "mean_action_processing_ms": 0.0362553175292549, "mean_env_wait_ms": 0.16899168967551786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008505105972290039, "StateBufferConnector_ms": 0.0013723373413085938, "ViewRequirementAgentConnector_ms": 0.03279590606689453}, "num_episodes": 40, "episode_return_max": 287.0, "episode_return_min": 3.0, "episode_return_mean": 163.41, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.4161842053275, "num_env_steps_trained_throughput_per_sec": 487.4161842053275, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 8357.21, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8357.143, "sample_time_ms": 4114.991, "load_time_ms": 2.446, "load_throughput": 1635110.617, "learn_time_ms": 4239.121, "learn_throughput": 943.592, "synch_weights_time_ms": 0.021}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 400, "training_iteration": 10, "trial_id": "default", "date": "2024-05-19_15-52-29", "timestamp": 1716159149, "time_this_iter_s": 8.20809292793274, "time_total_s": 83.58193063735962, "pid": 80385, "hostname": "Mrunals-MacBook-Air.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "case2env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.008, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x29d3e9750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 83.58193063735962, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 27.54166666666666, "ram_util_percent": 85.92500000000001}}
