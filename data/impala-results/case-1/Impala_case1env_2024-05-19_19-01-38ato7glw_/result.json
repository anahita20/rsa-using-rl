{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0003, "total_loss": 1427171.25, "policy_loss": 88010.359375, "entropy": 2.0446975231170654, "entropy_coeff": 0.01, "var_gnorm": 64.00450134277344, "vf_loss": 2678342.25, "vf_explained_var": -0.0003007650375366211}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2150, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 2150, "num_agent_steps_trained": 2000, "num_training_step_calls_since_last_synch_worker_weights": 43, "num_samples_added_to_queue": 2000, "learner_queue": {"size_count": 4, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 103.352, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2216.4, "learner_dequeue_time_ms": 1512.806}}, "sampler_results": {"episode_reward_max": 421.0, "episode_reward_min": 267.0, "episode_reward_mean": 364.42857142857144, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 2100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.0, 356.0, 421.0, 319.0, 317.0, 333.0, 348.0, 378.0, 344.0, 361.0, 363.0, 400.0, 352.0, 372.0, 397.0, 401.0, 378.0, 380.0, 394.0, 386.0, 386.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4338547552756962, "mean_inference_ms": 3.779583673375199, "mean_action_processing_ms": 0.12145902544107619, "mean_env_wait_ms": 0.26921458933753567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014695667085193452, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.15111650739397323}, "num_episodes": 21, "episode_return_max": 421.0, "episode_return_min": 267.0, "episode_return_mean": 364.42857142857144}, "env_runner_results": {"episode_reward_max": 421.0, "episode_reward_min": 267.0, "episode_reward_mean": 364.42857142857144, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 2100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.0, 356.0, 421.0, 319.0, 317.0, 333.0, 348.0, 378.0, 344.0, 361.0, 363.0, 400.0, 352.0, 372.0, 397.0, 401.0, 378.0, 380.0, 394.0, 386.0, 386.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4338547552756962, "mean_inference_ms": 3.779583673375199, "mean_action_processing_ms": 0.12145902544107619, "mean_env_wait_ms": 0.26921458933753567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014695667085193452, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.15111650739397323}, "num_episodes": 21, "episode_return_max": 421.0, "episode_return_min": 267.0, "episode_return_mean": 364.42857142857144}, "episode_reward_max": 421.0, "episode_reward_min": 267.0, "episode_reward_mean": 364.42857142857144, "episode_len_mean": 100.0, "episodes_this_iter": 21, "episodes_timesteps_total": 2100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [267.0, 356.0, 421.0, 319.0, 317.0, 333.0, 348.0, 378.0, 344.0, 361.0, 363.0, 400.0, 352.0, 372.0, 397.0, 401.0, 378.0, 380.0, 394.0, 386.0, 386.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4338547552756962, "mean_inference_ms": 3.779583673375199, "mean_action_processing_ms": 0.12145902544107619, "mean_env_wait_ms": 0.26921458933753567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014695667085193452, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.15111650739397323}, "num_episodes": 21, "episode_return_max": 421.0, "episode_return_min": 267.0, "episode_return_mean": 364.42857142857144, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2150, "num_agent_steps_trained": 2000, "num_env_steps_sampled": 2150, "num_env_steps_trained": 2000, "num_env_steps_sampled_this_iter": 2150, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 214.69229667848276, "num_env_steps_trained_throughput_per_sec": 199.713764352077, "timesteps_total": 2150, "num_env_steps_sampled_lifetime": 2150, "num_agent_steps_sampled_lifetime": 2150, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 2150, "timers": {"training_iteration_time_ms": 10014.332, "restore_workers_time_ms": 0.0, "training_step_time_ms": 280.786, "sample_time_ms": 280.786, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 2150, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 2150, "num_agent_steps_trained": 2000, "num_training_step_calls_since_last_synch_worker_weights": 43, "num_samples_added_to_queue": 2000}, "done": false, "episodes_total": 21, "training_iteration": 1, "trial_id": "default", "date": "2024-05-19_19-01-50", "timestamp": 1716170510, "time_this_iter_s": 10.014332294464111, "time_total_s": 10.014332294464111, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 10.014332294464111, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 4.993333333333333, "ram_util_percent": 88.11333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0003, "total_loss": 1492554.125, "policy_loss": 89244.359375, "entropy": 1.9798672199249268, "entropy_coeff": 0.01, "var_gnorm": 64.01665496826172, "vf_loss": 2806639.25, "vf_explained_var": -0.0005151033401489258}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 3500, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 3500, "num_training_step_calls_since_last_synch_worker_weights": 80, "num_samples_added_to_queue": 4000, "learner_queue": {"size_count": 7, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 100.886, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2433.585, "learner_dequeue_time_ms": 1512.806}}, "sampler_results": {"episode_reward_max": 464.0, "episode_reward_min": 267.0, "episode_reward_mean": 378.6, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.0, 356.0, 421.0, 319.0, 317.0, 333.0, 348.0, 378.0, 344.0, 361.0, 363.0, 400.0, 352.0, 372.0, 397.0, 401.0, 378.0, 380.0, 394.0, 386.0, 386.0, 416.0, 464.0, 344.0, 423.0, 362.0, 411.0, 386.0, 403.0, 357.0, 395.0, 373.0, 407.0, 355.0, 426.0, 412.0, 399.0, 411.0, 363.0, 384.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44565814561154155, "mean_inference_ms": 3.941805853162852, "mean_action_processing_ms": 0.12241602921549091, "mean_env_wait_ms": 0.26897885052959525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04922926425933838, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.14264166355133057}, "num_episodes": 19, "episode_return_max": 464.0, "episode_return_min": 267.0, "episode_return_mean": 378.6}, "env_runner_results": {"episode_reward_max": 464.0, "episode_reward_min": 267.0, "episode_reward_mean": 378.6, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.0, 356.0, 421.0, 319.0, 317.0, 333.0, 348.0, 378.0, 344.0, 361.0, 363.0, 400.0, 352.0, 372.0, 397.0, 401.0, 378.0, 380.0, 394.0, 386.0, 386.0, 416.0, 464.0, 344.0, 423.0, 362.0, 411.0, 386.0, 403.0, 357.0, 395.0, 373.0, 407.0, 355.0, 426.0, 412.0, 399.0, 411.0, 363.0, 384.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44565814561154155, "mean_inference_ms": 3.941805853162852, "mean_action_processing_ms": 0.12241602921549091, "mean_env_wait_ms": 0.26897885052959525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04922926425933838, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.14264166355133057}, "num_episodes": 19, "episode_return_max": 464.0, "episode_return_min": 267.0, "episode_return_mean": 378.6}, "episode_reward_max": 464.0, "episode_reward_min": 267.0, "episode_reward_mean": 378.6, "episode_len_mean": 100.0, "episodes_this_iter": 19, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [267.0, 356.0, 421.0, 319.0, 317.0, 333.0, 348.0, 378.0, 344.0, 361.0, 363.0, 400.0, 352.0, 372.0, 397.0, 401.0, 378.0, 380.0, 394.0, 386.0, 386.0, 416.0, 464.0, 344.0, 423.0, 362.0, 411.0, 386.0, 403.0, 357.0, 395.0, 373.0, 407.0, 355.0, 426.0, 412.0, 399.0, 411.0, 363.0, 384.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44565814561154155, "mean_inference_ms": 3.941805853162852, "mean_action_processing_ms": 0.12241602921549091, "mean_env_wait_ms": 0.26897885052959525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04922926425933838, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.14264166355133057}, "num_episodes": 19, "episode_return_max": 464.0, "episode_return_min": 267.0, "episode_return_mean": 378.6, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 3500, "num_env_steps_sampled": 4000, "num_env_steps_trained": 3500, "num_env_steps_sampled_this_iter": 1850, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 184.03409287520753, "num_env_steps_trained_throughput_per_sec": 149.21683206097907, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 10033.409, "restore_workers_time_ms": 0.0, "training_step_time_ms": 270.577, "sample_time_ms": 269.032, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 3500, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 3500, "num_training_step_calls_since_last_synch_worker_weights": 80, "num_samples_added_to_queue": 4000}, "done": false, "episodes_total": 40, "training_iteration": 2, "trial_id": "default", "date": "2024-05-19_19-02-00", "timestamp": 1716170520, "time_this_iter_s": 10.052485227584839, "time_total_s": 20.06681752204895, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 20.06681752204895, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 6.221428571428573, "ram_util_percent": 87.7642857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0003, "total_loss": 1149952.125, "policy_loss": 71287.90625, "entropy": 1.8560829162597656, "entropy_coeff": 0.01, "var_gnorm": 64.03987121582031, "vf_loss": 2157347.0, "vf_explained_var": -0.0010761022567749023}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5800, "num_env_steps_trained": 5500, "num_agent_steps_sampled": 5800, "num_agent_steps_trained": 5500, "num_training_step_calls_since_last_synch_worker_weights": 116, "num_samples_added_to_queue": 5500, "learner_queue": {"size_count": 11, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 107.567, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2614.88, "learner_dequeue_time_ms": 1512.806}}, "sampler_results": {"episode_reward_max": 464.0, "episode_reward_min": 267.0, "episode_reward_mean": 381.8448275862069, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 5800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.0, 356.0, 421.0, 319.0, 317.0, 333.0, 348.0, 378.0, 344.0, 361.0, 363.0, 400.0, 352.0, 372.0, 397.0, 401.0, 378.0, 380.0, 394.0, 386.0, 386.0, 416.0, 464.0, 344.0, 423.0, 362.0, 411.0, 386.0, 403.0, 357.0, 395.0, 373.0, 407.0, 355.0, 426.0, 412.0, 399.0, 411.0, 363.0, 384.0, 323.0, 432.0, 421.0, 458.0, 392.0, 358.0, 378.0, 381.0, 413.0, 422.0, 348.0, 325.0, 385.0, 353.0, 388.0, 383.0, 445.0, 398.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4556001931260787, "mean_inference_ms": 4.054660791946107, "mean_action_processing_ms": 0.11909916221237357, "mean_env_wait_ms": 0.2726904034792554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055705678874048696, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.15740065739072603}, "num_episodes": 18, "episode_return_max": 464.0, "episode_return_min": 267.0, "episode_return_mean": 381.8448275862069}, "env_runner_results": {"episode_reward_max": 464.0, "episode_reward_min": 267.0, "episode_reward_mean": 381.8448275862069, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 5800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.0, 356.0, 421.0, 319.0, 317.0, 333.0, 348.0, 378.0, 344.0, 361.0, 363.0, 400.0, 352.0, 372.0, 397.0, 401.0, 378.0, 380.0, 394.0, 386.0, 386.0, 416.0, 464.0, 344.0, 423.0, 362.0, 411.0, 386.0, 403.0, 357.0, 395.0, 373.0, 407.0, 355.0, 426.0, 412.0, 399.0, 411.0, 363.0, 384.0, 323.0, 432.0, 421.0, 458.0, 392.0, 358.0, 378.0, 381.0, 413.0, 422.0, 348.0, 325.0, 385.0, 353.0, 388.0, 383.0, 445.0, 398.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4556001931260787, "mean_inference_ms": 4.054660791946107, "mean_action_processing_ms": 0.11909916221237357, "mean_env_wait_ms": 0.2726904034792554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055705678874048696, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.15740065739072603}, "num_episodes": 18, "episode_return_max": 464.0, "episode_return_min": 267.0, "episode_return_mean": 381.8448275862069}, "episode_reward_max": 464.0, "episode_reward_min": 267.0, "episode_reward_mean": 381.8448275862069, "episode_len_mean": 100.0, "episodes_this_iter": 18, "episodes_timesteps_total": 5800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [267.0, 356.0, 421.0, 319.0, 317.0, 333.0, 348.0, 378.0, 344.0, 361.0, 363.0, 400.0, 352.0, 372.0, 397.0, 401.0, 378.0, 380.0, 394.0, 386.0, 386.0, 416.0, 464.0, 344.0, 423.0, 362.0, 411.0, 386.0, 403.0, 357.0, 395.0, 373.0, 407.0, 355.0, 426.0, 412.0, 399.0, 411.0, 363.0, 384.0, 323.0, 432.0, 421.0, 458.0, 392.0, 358.0, 378.0, 381.0, 413.0, 422.0, 348.0, 325.0, 385.0, 353.0, 388.0, 383.0, 445.0, 398.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4556001931260787, "mean_inference_ms": 4.054660791946107, "mean_action_processing_ms": 0.11909916221237357, "mean_env_wait_ms": 0.2726904034792554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055705678874048696, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.15740065739072603}, "num_episodes": 18, "episode_return_max": 464.0, "episode_return_min": 267.0, "episode_return_mean": 381.8448275862069, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5800, "num_agent_steps_trained": 5500, "num_env_steps_sampled": 5800, "num_env_steps_trained": 5500, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 175.91907395708418, "num_env_steps_trained_throughput_per_sec": 195.46563773009353, "timesteps_total": 5800, "num_env_steps_sampled_lifetime": 5800, "num_agent_steps_sampled_lifetime": 5800, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 5800, "timers": {"training_iteration_time_ms": 10099.598, "restore_workers_time_ms": 0.0, "training_step_time_ms": 268.604, "sample_time_ms": 268.205, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 5800, "num_env_steps_trained": 5500, "num_agent_steps_sampled": 5800, "num_agent_steps_trained": 5500, "num_training_step_calls_since_last_synch_worker_weights": 116, "num_samples_added_to_queue": 5500}, "done": false, "episodes_total": 58, "training_iteration": 3, "trial_id": "default", "date": "2024-05-19_19-02-10", "timestamp": 1716170530, "time_this_iter_s": 10.231977462768555, "time_total_s": 30.298794984817505, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 30.298794984817505, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 6.378571428571428, "ram_util_percent": 87.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0003, "total_loss": 1456912.25, "policy_loss": 79921.328125, "entropy": 1.7942721843719482, "entropy_coeff": 0.01, "var_gnorm": 64.0704574584961, "vf_loss": 2753999.75, "vf_explained_var": -0.002477288246154785}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7600, "num_env_steps_trained": 7500, "num_agent_steps_sampled": 7600, "num_agent_steps_trained": 7500, "num_training_step_calls_since_last_synch_worker_weights": 152, "num_samples_added_to_queue": 7500, "learner_queue": {"size_count": 15, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 101.657, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2655.227, "learner_dequeue_time_ms": 1512.806}}, "sampler_results": {"episode_reward_max": 464.0, "episode_reward_min": 267.0, "episode_reward_mean": 382.42105263157896, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 7600, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.0, 356.0, 421.0, 319.0, 317.0, 333.0, 348.0, 378.0, 344.0, 361.0, 363.0, 400.0, 352.0, 372.0, 397.0, 401.0, 378.0, 380.0, 394.0, 386.0, 386.0, 416.0, 464.0, 344.0, 423.0, 362.0, 411.0, 386.0, 403.0, 357.0, 395.0, 373.0, 407.0, 355.0, 426.0, 412.0, 399.0, 411.0, 363.0, 384.0, 323.0, 432.0, 421.0, 458.0, 392.0, 358.0, 378.0, 381.0, 413.0, 422.0, 348.0, 325.0, 385.0, 353.0, 388.0, 383.0, 445.0, 398.0, 413.0, 377.0, 353.0, 381.0, 342.0, 408.0, 346.0, 372.0, 378.0, 351.0, 413.0, 333.0, 394.0, 430.0, 357.0, 430.0, 385.0, 454.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4600212638745404, "mean_inference_ms": 4.1406214775295425, "mean_action_processing_ms": 0.11738104303141778, "mean_env_wait_ms": 0.27376601524595684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05084433053669177, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.14471380334151418}, "num_episodes": 18, "episode_return_max": 464.0, "episode_return_min": 267.0, "episode_return_mean": 382.42105263157896}, "env_runner_results": {"episode_reward_max": 464.0, "episode_reward_min": 267.0, "episode_reward_mean": 382.42105263157896, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 7600, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.0, 356.0, 421.0, 319.0, 317.0, 333.0, 348.0, 378.0, 344.0, 361.0, 363.0, 400.0, 352.0, 372.0, 397.0, 401.0, 378.0, 380.0, 394.0, 386.0, 386.0, 416.0, 464.0, 344.0, 423.0, 362.0, 411.0, 386.0, 403.0, 357.0, 395.0, 373.0, 407.0, 355.0, 426.0, 412.0, 399.0, 411.0, 363.0, 384.0, 323.0, 432.0, 421.0, 458.0, 392.0, 358.0, 378.0, 381.0, 413.0, 422.0, 348.0, 325.0, 385.0, 353.0, 388.0, 383.0, 445.0, 398.0, 413.0, 377.0, 353.0, 381.0, 342.0, 408.0, 346.0, 372.0, 378.0, 351.0, 413.0, 333.0, 394.0, 430.0, 357.0, 430.0, 385.0, 454.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4600212638745404, "mean_inference_ms": 4.1406214775295425, "mean_action_processing_ms": 0.11738104303141778, "mean_env_wait_ms": 0.27376601524595684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05084433053669177, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.14471380334151418}, "num_episodes": 18, "episode_return_max": 464.0, "episode_return_min": 267.0, "episode_return_mean": 382.42105263157896}, "episode_reward_max": 464.0, "episode_reward_min": 267.0, "episode_reward_mean": 382.42105263157896, "episode_len_mean": 100.0, "episodes_this_iter": 18, "episodes_timesteps_total": 7600, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [267.0, 356.0, 421.0, 319.0, 317.0, 333.0, 348.0, 378.0, 344.0, 361.0, 363.0, 400.0, 352.0, 372.0, 397.0, 401.0, 378.0, 380.0, 394.0, 386.0, 386.0, 416.0, 464.0, 344.0, 423.0, 362.0, 411.0, 386.0, 403.0, 357.0, 395.0, 373.0, 407.0, 355.0, 426.0, 412.0, 399.0, 411.0, 363.0, 384.0, 323.0, 432.0, 421.0, 458.0, 392.0, 358.0, 378.0, 381.0, 413.0, 422.0, 348.0, 325.0, 385.0, 353.0, 388.0, 383.0, 445.0, 398.0, 413.0, 377.0, 353.0, 381.0, 342.0, 408.0, 346.0, 372.0, 378.0, 351.0, 413.0, 333.0, 394.0, 430.0, 357.0, 430.0, 385.0, 454.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4600212638745404, "mean_inference_ms": 4.1406214775295425, "mean_action_processing_ms": 0.11738104303141778, "mean_env_wait_ms": 0.27376601524595684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05084433053669177, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.14471380334151418}, "num_episodes": 18, "episode_return_max": 464.0, "episode_return_min": 267.0, "episode_return_mean": 382.42105263157896, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7600, "num_agent_steps_trained": 7500, "num_env_steps_sampled": 7600, "num_env_steps_trained": 7500, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 177.42861790064646, "num_env_steps_trained_throughput_per_sec": 197.14290877849606, "timesteps_total": 7600, "num_env_steps_sampled_lifetime": 7600, "num_agent_steps_sampled_lifetime": 7600, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 7600, "timers": {"training_iteration_time_ms": 10110.93, "restore_workers_time_ms": 0.0, "training_step_time_ms": 302.693, "sample_time_ms": 302.183, "synch_weights_time_ms": 0.096}, "counters": {"num_env_steps_sampled": 7600, "num_env_steps_trained": 7500, "num_agent_steps_sampled": 7600, "num_agent_steps_trained": 7500, "num_training_step_calls_since_last_synch_worker_weights": 152, "num_samples_added_to_queue": 7500}, "done": false, "episodes_total": 76, "training_iteration": 4, "trial_id": "default", "date": "2024-05-19_19-02-20", "timestamp": 1716170540, "time_this_iter_s": 10.145926475524902, "time_total_s": 40.44472146034241, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 40.44472146034241, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 6.693333333333333, "ram_util_percent": 87.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0003, "total_loss": 1487205.875, "policy_loss": 75859.7734375, "entropy": 1.7558512687683105, "entropy_coeff": 0.01, "var_gnorm": 64.10716247558594, "vf_loss": 2822709.75, "vf_explained_var": -0.0029518604278564453}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9550, "num_env_steps_trained": 9500, "num_agent_steps_sampled": 9550, "num_agent_steps_trained": 9500, "num_training_step_calls_since_last_synch_worker_weights": 191, "num_samples_added_to_queue": 9500, "learner_queue": {"size_count": 19, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 92.571, "learner_load_time_ms": 1.504, "learner_load_wait_time_ms": 2592.474, "learner_dequeue_time_ms": 22562.195}}, "sampler_results": {"episode_reward_max": 464.0, "episode_reward_min": 267.0, "episode_reward_mean": 385.9578947368421, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 9500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.0, 356.0, 421.0, 319.0, 317.0, 333.0, 348.0, 378.0, 344.0, 361.0, 363.0, 400.0, 352.0, 372.0, 397.0, 401.0, 378.0, 380.0, 394.0, 386.0, 386.0, 416.0, 464.0, 344.0, 423.0, 362.0, 411.0, 386.0, 403.0, 357.0, 395.0, 373.0, 407.0, 355.0, 426.0, 412.0, 399.0, 411.0, 363.0, 384.0, 323.0, 432.0, 421.0, 458.0, 392.0, 358.0, 378.0, 381.0, 413.0, 422.0, 348.0, 325.0, 385.0, 353.0, 388.0, 383.0, 445.0, 398.0, 413.0, 377.0, 353.0, 381.0, 342.0, 408.0, 346.0, 372.0, 378.0, 351.0, 413.0, 333.0, 394.0, 430.0, 357.0, 430.0, 385.0, 454.0, 303.0, 350.0, 367.0, 414.0, 393.0, 426.0, 412.0, 455.0, 423.0, 433.0, 412.0, 454.0, 413.0, 370.0, 394.0, 399.0, 376.0, 417.0, 391.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46032545573494954, "mean_inference_ms": 4.187813808287129, "mean_action_processing_ms": 0.11687676282562387, "mean_env_wait_ms": 0.27696844713895846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05529955813759252, "StateBufferConnector_ms": 0.0010540610865542764, "ViewRequirementAgentConnector_ms": 0.13887154428582443}, "num_episodes": 19, "episode_return_max": 464.0, "episode_return_min": 267.0, "episode_return_mean": 385.9578947368421}, "env_runner_results": {"episode_reward_max": 464.0, "episode_reward_min": 267.0, "episode_reward_mean": 385.9578947368421, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 9500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.0, 356.0, 421.0, 319.0, 317.0, 333.0, 348.0, 378.0, 344.0, 361.0, 363.0, 400.0, 352.0, 372.0, 397.0, 401.0, 378.0, 380.0, 394.0, 386.0, 386.0, 416.0, 464.0, 344.0, 423.0, 362.0, 411.0, 386.0, 403.0, 357.0, 395.0, 373.0, 407.0, 355.0, 426.0, 412.0, 399.0, 411.0, 363.0, 384.0, 323.0, 432.0, 421.0, 458.0, 392.0, 358.0, 378.0, 381.0, 413.0, 422.0, 348.0, 325.0, 385.0, 353.0, 388.0, 383.0, 445.0, 398.0, 413.0, 377.0, 353.0, 381.0, 342.0, 408.0, 346.0, 372.0, 378.0, 351.0, 413.0, 333.0, 394.0, 430.0, 357.0, 430.0, 385.0, 454.0, 303.0, 350.0, 367.0, 414.0, 393.0, 426.0, 412.0, 455.0, 423.0, 433.0, 412.0, 454.0, 413.0, 370.0, 394.0, 399.0, 376.0, 417.0, 391.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46032545573494954, "mean_inference_ms": 4.187813808287129, "mean_action_processing_ms": 0.11687676282562387, "mean_env_wait_ms": 0.27696844713895846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05529955813759252, "StateBufferConnector_ms": 0.0010540610865542764, "ViewRequirementAgentConnector_ms": 0.13887154428582443}, "num_episodes": 19, "episode_return_max": 464.0, "episode_return_min": 267.0, "episode_return_mean": 385.9578947368421}, "episode_reward_max": 464.0, "episode_reward_min": 267.0, "episode_reward_mean": 385.9578947368421, "episode_len_mean": 100.0, "episodes_this_iter": 19, "episodes_timesteps_total": 9500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [267.0, 356.0, 421.0, 319.0, 317.0, 333.0, 348.0, 378.0, 344.0, 361.0, 363.0, 400.0, 352.0, 372.0, 397.0, 401.0, 378.0, 380.0, 394.0, 386.0, 386.0, 416.0, 464.0, 344.0, 423.0, 362.0, 411.0, 386.0, 403.0, 357.0, 395.0, 373.0, 407.0, 355.0, 426.0, 412.0, 399.0, 411.0, 363.0, 384.0, 323.0, 432.0, 421.0, 458.0, 392.0, 358.0, 378.0, 381.0, 413.0, 422.0, 348.0, 325.0, 385.0, 353.0, 388.0, 383.0, 445.0, 398.0, 413.0, 377.0, 353.0, 381.0, 342.0, 408.0, 346.0, 372.0, 378.0, 351.0, 413.0, 333.0, 394.0, 430.0, 357.0, 430.0, 385.0, 454.0, 303.0, 350.0, 367.0, 414.0, 393.0, 426.0, 412.0, 455.0, 423.0, 433.0, 412.0, 454.0, 413.0, 370.0, 394.0, 399.0, 376.0, 417.0, 391.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46032545573494954, "mean_inference_ms": 4.187813808287129, "mean_action_processing_ms": 0.11687676282562387, "mean_env_wait_ms": 0.27696844713895846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05529955813759252, "StateBufferConnector_ms": 0.0010540610865542764, "ViewRequirementAgentConnector_ms": 0.13887154428582443}, "num_episodes": 19, "episode_return_max": 464.0, "episode_return_min": 267.0, "episode_return_mean": 385.9578947368421, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9550, "num_agent_steps_trained": 9500, "num_env_steps_sampled": 9550, "num_env_steps_trained": 9500, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 194.945759367661, "num_env_steps_trained_throughput_per_sec": 199.94436858221638, "timesteps_total": 9550, "num_env_steps_sampled_lifetime": 9550, "num_agent_steps_sampled_lifetime": 9550, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 9550, "timers": {"training_iteration_time_ms": 10089.3, "restore_workers_time_ms": 0.0, "training_step_time_ms": 307.711, "sample_time_ms": 307.511, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 9550, "num_env_steps_trained": 9500, "num_agent_steps_sampled": 9550, "num_agent_steps_trained": 9500, "num_training_step_calls_since_last_synch_worker_weights": 191, "num_samples_added_to_queue": 9500}, "done": false, "episodes_total": 95, "training_iteration": 5, "trial_id": "default", "date": "2024-05-19_19-02-30", "timestamp": 1716170550, "time_this_iter_s": 10.002782344818115, "time_total_s": 50.44750380516052, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 50.44750380516052, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 5.507142857142858, "ram_util_percent": 88.34285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0003, "total_loss": 1579548.875, "policy_loss": 77407.6953125, "entropy": 1.6984390020370483, "entropy_coeff": 0.01, "var_gnorm": 64.13760375976562, "vf_loss": 3004299.25, "vf_explained_var": -0.003968358039855957}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 11500, "num_env_steps_trained": 11000, "num_agent_steps_sampled": 11500, "num_agent_steps_trained": 11000, "num_training_step_calls_since_last_synch_worker_weights": 230, "num_samples_added_to_queue": 11500, "learner_queue": {"size_count": 22, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 76.71, "learner_load_time_ms": 1.504, "learner_load_wait_time_ms": 2559.424, "learner_dequeue_time_ms": 22562.195}}, "sampler_results": {"episode_reward_max": 464.0, "episode_reward_min": 303.0, "episode_reward_mean": 395.0, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [401.0, 378.0, 380.0, 394.0, 386.0, 386.0, 416.0, 464.0, 344.0, 423.0, 362.0, 411.0, 386.0, 403.0, 357.0, 395.0, 373.0, 407.0, 355.0, 426.0, 412.0, 399.0, 411.0, 363.0, 384.0, 323.0, 432.0, 421.0, 458.0, 392.0, 358.0, 378.0, 381.0, 413.0, 422.0, 348.0, 325.0, 385.0, 353.0, 388.0, 383.0, 445.0, 398.0, 413.0, 377.0, 353.0, 381.0, 342.0, 408.0, 346.0, 372.0, 378.0, 351.0, 413.0, 333.0, 394.0, 430.0, 357.0, 430.0, 385.0, 454.0, 303.0, 350.0, 367.0, 414.0, 393.0, 426.0, 412.0, 455.0, 423.0, 433.0, 412.0, 454.0, 413.0, 370.0, 394.0, 399.0, 376.0, 417.0, 391.0, 362.0, 430.0, 375.0, 441.0, 366.0, 360.0, 398.0, 412.0, 421.0, 439.0, 418.0, 401.0, 412.0, 436.0, 379.0, 425.0, 415.0, 401.0, 432.0, 439.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.465302712934001, "mean_inference_ms": 4.280024342193188, "mean_action_processing_ms": 0.11578307340571743, "mean_env_wait_ms": 0.2837350645701401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056687116622924805, "StateBufferConnector_ms": 0.0019626617431640625, "ViewRequirementAgentConnector_ms": 0.13797450065612793}, "num_episodes": 20, "episode_return_max": 464.0, "episode_return_min": 303.0, "episode_return_mean": 395.0}, "env_runner_results": {"episode_reward_max": 464.0, "episode_reward_min": 303.0, "episode_reward_mean": 395.0, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [401.0, 378.0, 380.0, 394.0, 386.0, 386.0, 416.0, 464.0, 344.0, 423.0, 362.0, 411.0, 386.0, 403.0, 357.0, 395.0, 373.0, 407.0, 355.0, 426.0, 412.0, 399.0, 411.0, 363.0, 384.0, 323.0, 432.0, 421.0, 458.0, 392.0, 358.0, 378.0, 381.0, 413.0, 422.0, 348.0, 325.0, 385.0, 353.0, 388.0, 383.0, 445.0, 398.0, 413.0, 377.0, 353.0, 381.0, 342.0, 408.0, 346.0, 372.0, 378.0, 351.0, 413.0, 333.0, 394.0, 430.0, 357.0, 430.0, 385.0, 454.0, 303.0, 350.0, 367.0, 414.0, 393.0, 426.0, 412.0, 455.0, 423.0, 433.0, 412.0, 454.0, 413.0, 370.0, 394.0, 399.0, 376.0, 417.0, 391.0, 362.0, 430.0, 375.0, 441.0, 366.0, 360.0, 398.0, 412.0, 421.0, 439.0, 418.0, 401.0, 412.0, 436.0, 379.0, 425.0, 415.0, 401.0, 432.0, 439.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.465302712934001, "mean_inference_ms": 4.280024342193188, "mean_action_processing_ms": 0.11578307340571743, "mean_env_wait_ms": 0.2837350645701401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056687116622924805, "StateBufferConnector_ms": 0.0019626617431640625, "ViewRequirementAgentConnector_ms": 0.13797450065612793}, "num_episodes": 20, "episode_return_max": 464.0, "episode_return_min": 303.0, "episode_return_mean": 395.0}, "episode_reward_max": 464.0, "episode_reward_min": 303.0, "episode_reward_mean": 395.0, "episode_len_mean": 100.0, "episodes_this_iter": 20, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [401.0, 378.0, 380.0, 394.0, 386.0, 386.0, 416.0, 464.0, 344.0, 423.0, 362.0, 411.0, 386.0, 403.0, 357.0, 395.0, 373.0, 407.0, 355.0, 426.0, 412.0, 399.0, 411.0, 363.0, 384.0, 323.0, 432.0, 421.0, 458.0, 392.0, 358.0, 378.0, 381.0, 413.0, 422.0, 348.0, 325.0, 385.0, 353.0, 388.0, 383.0, 445.0, 398.0, 413.0, 377.0, 353.0, 381.0, 342.0, 408.0, 346.0, 372.0, 378.0, 351.0, 413.0, 333.0, 394.0, 430.0, 357.0, 430.0, 385.0, 454.0, 303.0, 350.0, 367.0, 414.0, 393.0, 426.0, 412.0, 455.0, 423.0, 433.0, 412.0, 454.0, 413.0, 370.0, 394.0, 399.0, 376.0, 417.0, 391.0, 362.0, 430.0, 375.0, 441.0, 366.0, 360.0, 398.0, 412.0, 421.0, 439.0, 418.0, 401.0, 412.0, 436.0, 379.0, 425.0, 415.0, 401.0, 432.0, 439.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.465302712934001, "mean_inference_ms": 4.280024342193188, "mean_action_processing_ms": 0.11578307340571743, "mean_env_wait_ms": 0.2837350645701401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056687116622924805, "StateBufferConnector_ms": 0.0019626617431640625, "ViewRequirementAgentConnector_ms": 0.13797450065612793}, "num_episodes": 20, "episode_return_max": 464.0, "episode_return_min": 303.0, "episode_return_mean": 395.0, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11500, "num_agent_steps_trained": 11000, "num_env_steps_sampled": 11500, "num_env_steps_trained": 11000, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 193.249678289058, "num_env_steps_trained_throughput_per_sec": 148.65359868389078, "timesteps_total": 11500, "num_env_steps_sampled_lifetime": 11500, "num_agent_steps_sampled_lifetime": 11500, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 11500, "timers": {"training_iteration_time_ms": 10089.513, "restore_workers_time_ms": 0.0, "training_step_time_ms": 277.982, "sample_time_ms": 277.811, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 11500, "num_env_steps_trained": 11000, "num_agent_steps_sampled": 11500, "num_agent_steps_trained": 11000, "num_training_step_calls_since_last_synch_worker_weights": 230, "num_samples_added_to_queue": 11500}, "done": false, "episodes_total": 115, "training_iteration": 6, "trial_id": "default", "date": "2024-05-19_19-02-40", "timestamp": 1716170560, "time_this_iter_s": 10.096373558044434, "time_total_s": 60.543877363204956, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 60.543877363204956, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 5.457142857142857, "ram_util_percent": 88.06428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0003, "total_loss": 1402986.375, "policy_loss": 67855.8671875, "entropy": 1.5617902278900146, "entropy_coeff": 0.01, "var_gnorm": 64.1802749633789, "vf_loss": 2670276.75, "vf_explained_var": -0.005306243896484375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 13400, "num_env_steps_trained": 13000, "num_agent_steps_sampled": 13400, "num_agent_steps_trained": 13000, "num_training_step_calls_since_last_synch_worker_weights": 268, "num_samples_added_to_queue": 13000, "learner_queue": {"size_count": 26, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.831, "learner_load_time_ms": 1.504, "learner_load_wait_time_ms": 2521.686, "learner_dequeue_time_ms": 22562.195}}, "sampler_results": {"episode_reward_max": 458.0, "episode_reward_min": 303.0, "episode_reward_mean": 394.42, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [426.0, 412.0, 399.0, 411.0, 363.0, 384.0, 323.0, 432.0, 421.0, 458.0, 392.0, 358.0, 378.0, 381.0, 413.0, 422.0, 348.0, 325.0, 385.0, 353.0, 388.0, 383.0, 445.0, 398.0, 413.0, 377.0, 353.0, 381.0, 342.0, 408.0, 346.0, 372.0, 378.0, 351.0, 413.0, 333.0, 394.0, 430.0, 357.0, 430.0, 385.0, 454.0, 303.0, 350.0, 367.0, 414.0, 393.0, 426.0, 412.0, 455.0, 423.0, 433.0, 412.0, 454.0, 413.0, 370.0, 394.0, 399.0, 376.0, 417.0, 391.0, 362.0, 430.0, 375.0, 441.0, 366.0, 360.0, 398.0, 412.0, 421.0, 439.0, 418.0, 401.0, 412.0, 436.0, 379.0, 425.0, 415.0, 401.0, 432.0, 439.0, 408.0, 363.0, 393.0, 405.0, 380.0, 413.0, 397.0, 458.0, 329.0, 372.0, 400.0, 422.0, 441.0, 352.0, 349.0, 371.0, 361.0, 358.0, 391.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4685836471755867, "mean_inference_ms": 4.343919044866897, "mean_action_processing_ms": 0.11479901474644773, "mean_env_wait_ms": 0.2912852037259032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.054264068603515625, "StateBufferConnector_ms": 0.0019626617431640625, "ViewRequirementAgentConnector_ms": 0.14963507652282715}, "num_episodes": 19, "episode_return_max": 458.0, "episode_return_min": 303.0, "episode_return_mean": 394.42}, "env_runner_results": {"episode_reward_max": 458.0, "episode_reward_min": 303.0, "episode_reward_mean": 394.42, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [426.0, 412.0, 399.0, 411.0, 363.0, 384.0, 323.0, 432.0, 421.0, 458.0, 392.0, 358.0, 378.0, 381.0, 413.0, 422.0, 348.0, 325.0, 385.0, 353.0, 388.0, 383.0, 445.0, 398.0, 413.0, 377.0, 353.0, 381.0, 342.0, 408.0, 346.0, 372.0, 378.0, 351.0, 413.0, 333.0, 394.0, 430.0, 357.0, 430.0, 385.0, 454.0, 303.0, 350.0, 367.0, 414.0, 393.0, 426.0, 412.0, 455.0, 423.0, 433.0, 412.0, 454.0, 413.0, 370.0, 394.0, 399.0, 376.0, 417.0, 391.0, 362.0, 430.0, 375.0, 441.0, 366.0, 360.0, 398.0, 412.0, 421.0, 439.0, 418.0, 401.0, 412.0, 436.0, 379.0, 425.0, 415.0, 401.0, 432.0, 439.0, 408.0, 363.0, 393.0, 405.0, 380.0, 413.0, 397.0, 458.0, 329.0, 372.0, 400.0, 422.0, 441.0, 352.0, 349.0, 371.0, 361.0, 358.0, 391.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4685836471755867, "mean_inference_ms": 4.343919044866897, "mean_action_processing_ms": 0.11479901474644773, "mean_env_wait_ms": 0.2912852037259032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.054264068603515625, "StateBufferConnector_ms": 0.0019626617431640625, "ViewRequirementAgentConnector_ms": 0.14963507652282715}, "num_episodes": 19, "episode_return_max": 458.0, "episode_return_min": 303.0, "episode_return_mean": 394.42}, "episode_reward_max": 458.0, "episode_reward_min": 303.0, "episode_reward_mean": 394.42, "episode_len_mean": 100.0, "episodes_this_iter": 19, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [426.0, 412.0, 399.0, 411.0, 363.0, 384.0, 323.0, 432.0, 421.0, 458.0, 392.0, 358.0, 378.0, 381.0, 413.0, 422.0, 348.0, 325.0, 385.0, 353.0, 388.0, 383.0, 445.0, 398.0, 413.0, 377.0, 353.0, 381.0, 342.0, 408.0, 346.0, 372.0, 378.0, 351.0, 413.0, 333.0, 394.0, 430.0, 357.0, 430.0, 385.0, 454.0, 303.0, 350.0, 367.0, 414.0, 393.0, 426.0, 412.0, 455.0, 423.0, 433.0, 412.0, 454.0, 413.0, 370.0, 394.0, 399.0, 376.0, 417.0, 391.0, 362.0, 430.0, 375.0, 441.0, 366.0, 360.0, 398.0, 412.0, 421.0, 439.0, 418.0, 401.0, 412.0, 436.0, 379.0, 425.0, 415.0, 401.0, 432.0, 439.0, 408.0, 363.0, 393.0, 405.0, 380.0, 413.0, 397.0, 458.0, 329.0, 372.0, 400.0, 422.0, 441.0, 352.0, 349.0, 371.0, 361.0, 358.0, 391.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4685836471755867, "mean_inference_ms": 4.343919044866897, "mean_action_processing_ms": 0.11479901474644773, "mean_env_wait_ms": 0.2912852037259032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.054264068603515625, "StateBufferConnector_ms": 0.0019626617431640625, "ViewRequirementAgentConnector_ms": 0.14963507652282715}, "num_episodes": 19, "episode_return_max": 458.0, "episode_return_min": 303.0, "episode_return_mean": 394.42, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13400, "num_agent_steps_trained": 13000, "num_env_steps_sampled": 13400, "num_env_steps_trained": 13000, "num_env_steps_sampled_this_iter": 1900, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 185.88724367014274, "num_env_steps_trained_throughput_per_sec": 195.67078281067657, "timesteps_total": 13400, "num_env_steps_sampled_lifetime": 13400, "num_agent_steps_sampled_lifetime": 13400, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 13400, "timers": {"training_iteration_time_ms": 10108.332, "restore_workers_time_ms": 0.0, "training_step_time_ms": 285.748, "sample_time_ms": 285.305, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 13400, "num_env_steps_trained": 13000, "num_agent_steps_sampled": 13400, "num_agent_steps_trained": 13000, "num_training_step_calls_since_last_synch_worker_weights": 268, "num_samples_added_to_queue": 13000}, "done": false, "episodes_total": 134, "training_iteration": 7, "trial_id": "default", "date": "2024-05-19_19-02-51", "timestamp": 1716170571, "time_this_iter_s": 10.221250057220459, "time_total_s": 70.76512742042542, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 70.76512742042542, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 6.260000000000001, "ram_util_percent": 87.78}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0003, "total_loss": 1369790.5, "policy_loss": 65961.0625, "entropy": 1.494128942489624, "entropy_coeff": 0.01, "var_gnorm": 64.22323608398438, "vf_loss": 2607673.75, "vf_explained_var": -0.005923151969909668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 15300, "num_env_steps_trained": 15000, "num_agent_steps_sampled": 15300, "num_agent_steps_trained": 15000, "num_training_step_calls_since_last_synch_worker_weights": 306, "num_samples_added_to_queue": 15000, "learner_queue": {"size_count": 30, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.83, "learner_load_time_ms": 1.504, "learner_load_wait_time_ms": 2602.906, "learner_dequeue_time_ms": 22562.195}}, "sampler_results": {"episode_reward_max": 458.0, "episode_reward_min": 303.0, "episode_reward_mean": 394.1, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [353.0, 388.0, 383.0, 445.0, 398.0, 413.0, 377.0, 353.0, 381.0, 342.0, 408.0, 346.0, 372.0, 378.0, 351.0, 413.0, 333.0, 394.0, 430.0, 357.0, 430.0, 385.0, 454.0, 303.0, 350.0, 367.0, 414.0, 393.0, 426.0, 412.0, 455.0, 423.0, 433.0, 412.0, 454.0, 413.0, 370.0, 394.0, 399.0, 376.0, 417.0, 391.0, 362.0, 430.0, 375.0, 441.0, 366.0, 360.0, 398.0, 412.0, 421.0, 439.0, 418.0, 401.0, 412.0, 436.0, 379.0, 425.0, 415.0, 401.0, 432.0, 439.0, 408.0, 363.0, 393.0, 405.0, 380.0, 413.0, 397.0, 458.0, 329.0, 372.0, 400.0, 422.0, 441.0, 352.0, 349.0, 371.0, 361.0, 358.0, 391.0, 390.0, 423.0, 386.0, 336.0, 375.0, 399.0, 392.0, 441.0, 398.0, 328.0, 365.0, 383.0, 393.0, 385.0, 447.0, 362.0, 390.0, 404.0, 402.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4686605365611712, "mean_inference_ms": 4.364909317290138, "mean_action_processing_ms": 0.11597198553157204, "mean_env_wait_ms": 0.29633623864620473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027027368545532227, "StateBufferConnector_ms": 0.003969669342041016, "ViewRequirementAgentConnector_ms": 0.14348196983337402}, "num_episodes": 19, "episode_return_max": 458.0, "episode_return_min": 303.0, "episode_return_mean": 394.1}, "env_runner_results": {"episode_reward_max": 458.0, "episode_reward_min": 303.0, "episode_reward_mean": 394.1, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [353.0, 388.0, 383.0, 445.0, 398.0, 413.0, 377.0, 353.0, 381.0, 342.0, 408.0, 346.0, 372.0, 378.0, 351.0, 413.0, 333.0, 394.0, 430.0, 357.0, 430.0, 385.0, 454.0, 303.0, 350.0, 367.0, 414.0, 393.0, 426.0, 412.0, 455.0, 423.0, 433.0, 412.0, 454.0, 413.0, 370.0, 394.0, 399.0, 376.0, 417.0, 391.0, 362.0, 430.0, 375.0, 441.0, 366.0, 360.0, 398.0, 412.0, 421.0, 439.0, 418.0, 401.0, 412.0, 436.0, 379.0, 425.0, 415.0, 401.0, 432.0, 439.0, 408.0, 363.0, 393.0, 405.0, 380.0, 413.0, 397.0, 458.0, 329.0, 372.0, 400.0, 422.0, 441.0, 352.0, 349.0, 371.0, 361.0, 358.0, 391.0, 390.0, 423.0, 386.0, 336.0, 375.0, 399.0, 392.0, 441.0, 398.0, 328.0, 365.0, 383.0, 393.0, 385.0, 447.0, 362.0, 390.0, 404.0, 402.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4686605365611712, "mean_inference_ms": 4.364909317290138, "mean_action_processing_ms": 0.11597198553157204, "mean_env_wait_ms": 0.29633623864620473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027027368545532227, "StateBufferConnector_ms": 0.003969669342041016, "ViewRequirementAgentConnector_ms": 0.14348196983337402}, "num_episodes": 19, "episode_return_max": 458.0, "episode_return_min": 303.0, "episode_return_mean": 394.1}, "episode_reward_max": 458.0, "episode_reward_min": 303.0, "episode_reward_mean": 394.1, "episode_len_mean": 100.0, "episodes_this_iter": 19, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [353.0, 388.0, 383.0, 445.0, 398.0, 413.0, 377.0, 353.0, 381.0, 342.0, 408.0, 346.0, 372.0, 378.0, 351.0, 413.0, 333.0, 394.0, 430.0, 357.0, 430.0, 385.0, 454.0, 303.0, 350.0, 367.0, 414.0, 393.0, 426.0, 412.0, 455.0, 423.0, 433.0, 412.0, 454.0, 413.0, 370.0, 394.0, 399.0, 376.0, 417.0, 391.0, 362.0, 430.0, 375.0, 441.0, 366.0, 360.0, 398.0, 412.0, 421.0, 439.0, 418.0, 401.0, 412.0, 436.0, 379.0, 425.0, 415.0, 401.0, 432.0, 439.0, 408.0, 363.0, 393.0, 405.0, 380.0, 413.0, 397.0, 458.0, 329.0, 372.0, 400.0, 422.0, 441.0, 352.0, 349.0, 371.0, 361.0, 358.0, 391.0, 390.0, 423.0, 386.0, 336.0, 375.0, 399.0, 392.0, 441.0, 398.0, 328.0, 365.0, 383.0, 393.0, 385.0, 447.0, 362.0, 390.0, 404.0, 402.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4686605365611712, "mean_inference_ms": 4.364909317290138, "mean_action_processing_ms": 0.11597198553157204, "mean_env_wait_ms": 0.29633623864620473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027027368545532227, "StateBufferConnector_ms": 0.003969669342041016, "ViewRequirementAgentConnector_ms": 0.14348196983337402}, "num_episodes": 19, "episode_return_max": 458.0, "episode_return_min": 303.0, "episode_return_mean": 394.1, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15300, "num_agent_steps_trained": 15000, "num_env_steps_sampled": 15300, "num_env_steps_trained": 15000, "num_env_steps_sampled_this_iter": 1900, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 185.91233060723204, "num_env_steps_trained_throughput_per_sec": 195.69719011287583, "timesteps_total": 15300, "num_env_steps_sampled_lifetime": 15300, "num_agent_steps_sampled_lifetime": 15300, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 15300, "timers": {"training_iteration_time_ms": 10122.275, "restore_workers_time_ms": 0.0, "training_step_time_ms": 289.237, "sample_time_ms": 289.037, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 15300, "num_env_steps_trained": 15000, "num_agent_steps_sampled": 15300, "num_agent_steps_trained": 15000, "num_training_step_calls_since_last_synch_worker_weights": 306, "num_samples_added_to_queue": 15000}, "done": false, "episodes_total": 153, "training_iteration": 8, "trial_id": "default", "date": "2024-05-19_19-03-01", "timestamp": 1716170581, "time_this_iter_s": 10.219870805740356, "time_total_s": 80.98499822616577, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 80.98499822616577, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 6.528571428571428, "ram_util_percent": 87.75714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0003, "total_loss": 1010580.0, "policy_loss": 53008.9453125, "entropy": 1.46891188621521, "entropy_coeff": 0.01, "var_gnorm": 64.26484680175781, "vf_loss": 1915156.75, "vf_explained_var": -0.007105827331542969}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 17050, "num_env_steps_trained": 17000, "num_agent_steps_sampled": 17050, "num_agent_steps_trained": 17000, "num_training_step_calls_since_last_synch_worker_weights": 341, "num_samples_added_to_queue": 17000, "learner_queue": {"size_count": 34, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 89.841, "learner_load_time_ms": 1.003, "learner_load_wait_time_ms": 2701.969, "learner_dequeue_time_ms": 29379.602}}, "sampler_results": {"episode_reward_max": 458.0, "episode_reward_min": 292.0, "episode_reward_mean": 388.96, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [394.0, 430.0, 357.0, 430.0, 385.0, 454.0, 303.0, 350.0, 367.0, 414.0, 393.0, 426.0, 412.0, 455.0, 423.0, 433.0, 412.0, 454.0, 413.0, 370.0, 394.0, 399.0, 376.0, 417.0, 391.0, 362.0, 430.0, 375.0, 441.0, 366.0, 360.0, 398.0, 412.0, 421.0, 439.0, 418.0, 401.0, 412.0, 436.0, 379.0, 425.0, 415.0, 401.0, 432.0, 439.0, 408.0, 363.0, 393.0, 405.0, 380.0, 413.0, 397.0, 458.0, 329.0, 372.0, 400.0, 422.0, 441.0, 352.0, 349.0, 371.0, 361.0, 358.0, 391.0, 390.0, 423.0, 386.0, 336.0, 375.0, 399.0, 392.0, 441.0, 398.0, 328.0, 365.0, 383.0, 393.0, 385.0, 447.0, 362.0, 390.0, 404.0, 402.0, 384.0, 343.0, 300.0, 429.0, 305.0, 385.0, 292.0, 310.0, 337.0, 376.0, 384.0, 346.0, 377.0, 294.0, 344.0, 312.0, 402.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4696506015688644, "mean_inference_ms": 4.367963332198232, "mean_action_processing_ms": 0.11781763343246762, "mean_env_wait_ms": 0.2998951932593558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03251147270202637, "StateBufferConnector_ms": 0.003969669342041016, "ViewRequirementAgentConnector_ms": 0.13158392906188965}, "num_episodes": 17, "episode_return_max": 458.0, "episode_return_min": 292.0, "episode_return_mean": 388.96}, "env_runner_results": {"episode_reward_max": 458.0, "episode_reward_min": 292.0, "episode_reward_mean": 388.96, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [394.0, 430.0, 357.0, 430.0, 385.0, 454.0, 303.0, 350.0, 367.0, 414.0, 393.0, 426.0, 412.0, 455.0, 423.0, 433.0, 412.0, 454.0, 413.0, 370.0, 394.0, 399.0, 376.0, 417.0, 391.0, 362.0, 430.0, 375.0, 441.0, 366.0, 360.0, 398.0, 412.0, 421.0, 439.0, 418.0, 401.0, 412.0, 436.0, 379.0, 425.0, 415.0, 401.0, 432.0, 439.0, 408.0, 363.0, 393.0, 405.0, 380.0, 413.0, 397.0, 458.0, 329.0, 372.0, 400.0, 422.0, 441.0, 352.0, 349.0, 371.0, 361.0, 358.0, 391.0, 390.0, 423.0, 386.0, 336.0, 375.0, 399.0, 392.0, 441.0, 398.0, 328.0, 365.0, 383.0, 393.0, 385.0, 447.0, 362.0, 390.0, 404.0, 402.0, 384.0, 343.0, 300.0, 429.0, 305.0, 385.0, 292.0, 310.0, 337.0, 376.0, 384.0, 346.0, 377.0, 294.0, 344.0, 312.0, 402.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4696506015688644, "mean_inference_ms": 4.367963332198232, "mean_action_processing_ms": 0.11781763343246762, "mean_env_wait_ms": 0.2998951932593558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03251147270202637, "StateBufferConnector_ms": 0.003969669342041016, "ViewRequirementAgentConnector_ms": 0.13158392906188965}, "num_episodes": 17, "episode_return_max": 458.0, "episode_return_min": 292.0, "episode_return_mean": 388.96}, "episode_reward_max": 458.0, "episode_reward_min": 292.0, "episode_reward_mean": 388.96, "episode_len_mean": 100.0, "episodes_this_iter": 17, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [394.0, 430.0, 357.0, 430.0, 385.0, 454.0, 303.0, 350.0, 367.0, 414.0, 393.0, 426.0, 412.0, 455.0, 423.0, 433.0, 412.0, 454.0, 413.0, 370.0, 394.0, 399.0, 376.0, 417.0, 391.0, 362.0, 430.0, 375.0, 441.0, 366.0, 360.0, 398.0, 412.0, 421.0, 439.0, 418.0, 401.0, 412.0, 436.0, 379.0, 425.0, 415.0, 401.0, 432.0, 439.0, 408.0, 363.0, 393.0, 405.0, 380.0, 413.0, 397.0, 458.0, 329.0, 372.0, 400.0, 422.0, 441.0, 352.0, 349.0, 371.0, 361.0, 358.0, 391.0, 390.0, 423.0, 386.0, 336.0, 375.0, 399.0, 392.0, 441.0, 398.0, 328.0, 365.0, 383.0, 393.0, 385.0, 447.0, 362.0, 390.0, 404.0, 402.0, 384.0, 343.0, 300.0, 429.0, 305.0, 385.0, 292.0, 310.0, 337.0, 376.0, 384.0, 346.0, 377.0, 294.0, 344.0, 312.0, 402.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4696506015688644, "mean_inference_ms": 4.367963332198232, "mean_action_processing_ms": 0.11781763343246762, "mean_env_wait_ms": 0.2998951932593558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03251147270202637, "StateBufferConnector_ms": 0.003969669342041016, "ViewRequirementAgentConnector_ms": 0.13158392906188965}, "num_episodes": 17, "episode_return_max": 458.0, "episode_return_min": 292.0, "episode_return_mean": 388.96, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17050, "num_agent_steps_trained": 17000, "num_env_steps_sampled": 17050, "num_env_steps_trained": 17000, "num_env_steps_sampled_this_iter": 1750, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 173.0150906687051, "num_env_steps_trained_throughput_per_sec": 197.73153219280584, "timesteps_total": 17050, "num_env_steps_sampled_lifetime": 17050, "num_agent_steps_sampled_lifetime": 17050, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 17050, "timers": {"training_iteration_time_ms": 10121.436, "restore_workers_time_ms": 0.0, "training_step_time_ms": 293.036, "sample_time_ms": 291.501, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 17050, "num_env_steps_trained": 17000, "num_agent_steps_sampled": 17050, "num_agent_steps_trained": 17000, "num_training_step_calls_since_last_synch_worker_weights": 341, "num_samples_added_to_queue": 17000}, "done": false, "episodes_total": 170, "training_iteration": 9, "trial_id": "default", "date": "2024-05-19_19-03-11", "timestamp": 1716170591, "time_this_iter_s": 10.11472463607788, "time_total_s": 91.09972286224365, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 91.09972286224365, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 6.492857142857142, "ram_util_percent": 87.76428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0003, "total_loss": 1212947.0, "policy_loss": 61900.703125, "entropy": 1.4895951747894287, "entropy_coeff": 0.01, "var_gnorm": 64.29452514648438, "vf_loss": 2302107.5, "vf_explained_var": -0.007377743721008301}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 18850, "num_env_steps_trained": 18500, "num_agent_steps_sampled": 18850, "num_agent_steps_trained": 18500, "num_training_step_calls_since_last_synch_worker_weights": 377, "num_samples_added_to_queue": 18500, "learner_queue": {"size_count": 37, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.526, "learner_load_time_ms": 1.003, "learner_load_wait_time_ms": 2705.018, "learner_dequeue_time_ms": 29379.602}}, "sampler_results": {"episode_reward_max": 458.0, "episode_reward_min": 211.0, "episode_reward_mean": 379.78, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [413.0, 370.0, 394.0, 399.0, 376.0, 417.0, 391.0, 362.0, 430.0, 375.0, 441.0, 366.0, 360.0, 398.0, 412.0, 421.0, 439.0, 418.0, 401.0, 412.0, 436.0, 379.0, 425.0, 415.0, 401.0, 432.0, 439.0, 408.0, 363.0, 393.0, 405.0, 380.0, 413.0, 397.0, 458.0, 329.0, 372.0, 400.0, 422.0, 441.0, 352.0, 349.0, 371.0, 361.0, 358.0, 391.0, 390.0, 423.0, 386.0, 336.0, 375.0, 399.0, 392.0, 441.0, 398.0, 328.0, 365.0, 383.0, 393.0, 385.0, 447.0, 362.0, 390.0, 404.0, 402.0, 384.0, 343.0, 300.0, 429.0, 305.0, 385.0, 292.0, 310.0, 337.0, 376.0, 384.0, 346.0, 377.0, 294.0, 344.0, 312.0, 402.0, 397.0, 369.0, 312.0, 211.0, 327.0, 322.0, 352.0, 307.0, 312.0, 372.0, 316.0, 385.0, 450.0, 368.0, 329.0, 423.0, 388.0, 434.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47214649705317396, "mean_inference_ms": 4.374902405976492, "mean_action_processing_ms": 0.11938573992738308, "mean_env_wait_ms": 0.3023814607677485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025374412536621094, "StateBufferConnector_ms": 0.003969669342041016, "ViewRequirementAgentConnector_ms": 0.13701343536376953}, "num_episodes": 18, "episode_return_max": 458.0, "episode_return_min": 211.0, "episode_return_mean": 379.78}, "env_runner_results": {"episode_reward_max": 458.0, "episode_reward_min": 211.0, "episode_reward_mean": 379.78, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [413.0, 370.0, 394.0, 399.0, 376.0, 417.0, 391.0, 362.0, 430.0, 375.0, 441.0, 366.0, 360.0, 398.0, 412.0, 421.0, 439.0, 418.0, 401.0, 412.0, 436.0, 379.0, 425.0, 415.0, 401.0, 432.0, 439.0, 408.0, 363.0, 393.0, 405.0, 380.0, 413.0, 397.0, 458.0, 329.0, 372.0, 400.0, 422.0, 441.0, 352.0, 349.0, 371.0, 361.0, 358.0, 391.0, 390.0, 423.0, 386.0, 336.0, 375.0, 399.0, 392.0, 441.0, 398.0, 328.0, 365.0, 383.0, 393.0, 385.0, 447.0, 362.0, 390.0, 404.0, 402.0, 384.0, 343.0, 300.0, 429.0, 305.0, 385.0, 292.0, 310.0, 337.0, 376.0, 384.0, 346.0, 377.0, 294.0, 344.0, 312.0, 402.0, 397.0, 369.0, 312.0, 211.0, 327.0, 322.0, 352.0, 307.0, 312.0, 372.0, 316.0, 385.0, 450.0, 368.0, 329.0, 423.0, 388.0, 434.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47214649705317396, "mean_inference_ms": 4.374902405976492, "mean_action_processing_ms": 0.11938573992738308, "mean_env_wait_ms": 0.3023814607677485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025374412536621094, "StateBufferConnector_ms": 0.003969669342041016, "ViewRequirementAgentConnector_ms": 0.13701343536376953}, "num_episodes": 18, "episode_return_max": 458.0, "episode_return_min": 211.0, "episode_return_mean": 379.78}, "episode_reward_max": 458.0, "episode_reward_min": 211.0, "episode_reward_mean": 379.78, "episode_len_mean": 100.0, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [413.0, 370.0, 394.0, 399.0, 376.0, 417.0, 391.0, 362.0, 430.0, 375.0, 441.0, 366.0, 360.0, 398.0, 412.0, 421.0, 439.0, 418.0, 401.0, 412.0, 436.0, 379.0, 425.0, 415.0, 401.0, 432.0, 439.0, 408.0, 363.0, 393.0, 405.0, 380.0, 413.0, 397.0, 458.0, 329.0, 372.0, 400.0, 422.0, 441.0, 352.0, 349.0, 371.0, 361.0, 358.0, 391.0, 390.0, 423.0, 386.0, 336.0, 375.0, 399.0, 392.0, 441.0, 398.0, 328.0, 365.0, 383.0, 393.0, 385.0, 447.0, 362.0, 390.0, 404.0, 402.0, 384.0, 343.0, 300.0, 429.0, 305.0, 385.0, 292.0, 310.0, 337.0, 376.0, 384.0, 346.0, 377.0, 294.0, 344.0, 312.0, 402.0, 397.0, 369.0, 312.0, 211.0, 327.0, 322.0, 352.0, 307.0, 312.0, 372.0, 316.0, 385.0, 450.0, 368.0, 329.0, 423.0, 388.0, 434.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47214649705317396, "mean_inference_ms": 4.374902405976492, "mean_action_processing_ms": 0.11938573992738308, "mean_env_wait_ms": 0.3023814607677485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025374412536621094, "StateBufferConnector_ms": 0.003969669342041016, "ViewRequirementAgentConnector_ms": 0.13701343536376953}, "num_episodes": 18, "episode_return_max": 458.0, "episode_return_min": 211.0, "episode_return_mean": 379.78, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18850, "num_agent_steps_trained": 18500, "num_env_steps_sampled": 18850, "num_env_steps_trained": 18500, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 178.36049090703128, "num_env_steps_trained_throughput_per_sec": 148.63374242252604, "timesteps_total": 18850, "num_env_steps_sampled_lifetime": 18850, "num_agent_steps_sampled_lifetime": 18850, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 18850, "timers": {"training_iteration_time_ms": 10118.484, "restore_workers_time_ms": 0.0, "training_step_time_ms": 284.668, "sample_time_ms": 284.375, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 18850, "num_env_steps_trained": 18500, "num_agent_steps_sampled": 18850, "num_agent_steps_trained": 18500, "num_training_step_calls_since_last_synch_worker_weights": 377, "num_samples_added_to_queue": 18500}, "done": false, "episodes_total": 188, "training_iteration": 10, "trial_id": "default", "date": "2024-05-19_19-03-21", "timestamp": 1716170601, "time_this_iter_s": 10.093913793563843, "time_total_s": 101.1936366558075, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 101.1936366558075, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 7.173333333333332, "ram_util_percent": 87.77333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0003, "total_loss": 1472138.125, "policy_loss": 61557.7265625, "entropy": 1.4538557529449463, "entropy_coeff": 0.01, "var_gnorm": 64.33162689208984, "vf_loss": 2821175.25, "vf_explained_var": -0.0073157548904418945}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 20650, "num_env_steps_trained": 20500, "num_agent_steps_sampled": 20650, "num_agent_steps_trained": 20500, "num_training_step_calls_since_last_synch_worker_weights": 413, "num_samples_added_to_queue": 20500, "learner_queue": {"size_count": 41, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.165, "learner_load_time_ms": 1.003, "learner_load_wait_time_ms": 2757.052, "learner_dequeue_time_ms": 29379.602}}, "sampler_results": {"episode_reward_max": 458.0, "episode_reward_min": 211.0, "episode_reward_mean": 380.01, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [401.0, 412.0, 436.0, 379.0, 425.0, 415.0, 401.0, 432.0, 439.0, 408.0, 363.0, 393.0, 405.0, 380.0, 413.0, 397.0, 458.0, 329.0, 372.0, 400.0, 422.0, 441.0, 352.0, 349.0, 371.0, 361.0, 358.0, 391.0, 390.0, 423.0, 386.0, 336.0, 375.0, 399.0, 392.0, 441.0, 398.0, 328.0, 365.0, 383.0, 393.0, 385.0, 447.0, 362.0, 390.0, 404.0, 402.0, 384.0, 343.0, 300.0, 429.0, 305.0, 385.0, 292.0, 310.0, 337.0, 376.0, 384.0, 346.0, 377.0, 294.0, 344.0, 312.0, 402.0, 397.0, 369.0, 312.0, 211.0, 327.0, 322.0, 352.0, 307.0, 312.0, 372.0, 316.0, 385.0, 450.0, 368.0, 329.0, 423.0, 388.0, 434.0, 304.0, 325.0, 370.0, 444.0, 445.0, 380.0, 415.0, 391.0, 396.0, 356.0, 416.0, 453.0, 433.0, 405.0, 389.0, 445.0, 391.0, 447.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47497535178951905, "mean_inference_ms": 4.392356127777797, "mean_action_processing_ms": 0.12070407270993484, "mean_env_wait_ms": 0.30138858392813295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011105775833129883, "StateBufferConnector_ms": 0.002968311309814453, "ViewRequirementAgentConnector_ms": 0.15867853164672852}, "num_episodes": 18, "episode_return_max": 458.0, "episode_return_min": 211.0, "episode_return_mean": 380.01}, "env_runner_results": {"episode_reward_max": 458.0, "episode_reward_min": 211.0, "episode_reward_mean": 380.01, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [401.0, 412.0, 436.0, 379.0, 425.0, 415.0, 401.0, 432.0, 439.0, 408.0, 363.0, 393.0, 405.0, 380.0, 413.0, 397.0, 458.0, 329.0, 372.0, 400.0, 422.0, 441.0, 352.0, 349.0, 371.0, 361.0, 358.0, 391.0, 390.0, 423.0, 386.0, 336.0, 375.0, 399.0, 392.0, 441.0, 398.0, 328.0, 365.0, 383.0, 393.0, 385.0, 447.0, 362.0, 390.0, 404.0, 402.0, 384.0, 343.0, 300.0, 429.0, 305.0, 385.0, 292.0, 310.0, 337.0, 376.0, 384.0, 346.0, 377.0, 294.0, 344.0, 312.0, 402.0, 397.0, 369.0, 312.0, 211.0, 327.0, 322.0, 352.0, 307.0, 312.0, 372.0, 316.0, 385.0, 450.0, 368.0, 329.0, 423.0, 388.0, 434.0, 304.0, 325.0, 370.0, 444.0, 445.0, 380.0, 415.0, 391.0, 396.0, 356.0, 416.0, 453.0, 433.0, 405.0, 389.0, 445.0, 391.0, 447.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47497535178951905, "mean_inference_ms": 4.392356127777797, "mean_action_processing_ms": 0.12070407270993484, "mean_env_wait_ms": 0.30138858392813295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011105775833129883, "StateBufferConnector_ms": 0.002968311309814453, "ViewRequirementAgentConnector_ms": 0.15867853164672852}, "num_episodes": 18, "episode_return_max": 458.0, "episode_return_min": 211.0, "episode_return_mean": 380.01}, "episode_reward_max": 458.0, "episode_reward_min": 211.0, "episode_reward_mean": 380.01, "episode_len_mean": 100.0, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [401.0, 412.0, 436.0, 379.0, 425.0, 415.0, 401.0, 432.0, 439.0, 408.0, 363.0, 393.0, 405.0, 380.0, 413.0, 397.0, 458.0, 329.0, 372.0, 400.0, 422.0, 441.0, 352.0, 349.0, 371.0, 361.0, 358.0, 391.0, 390.0, 423.0, 386.0, 336.0, 375.0, 399.0, 392.0, 441.0, 398.0, 328.0, 365.0, 383.0, 393.0, 385.0, 447.0, 362.0, 390.0, 404.0, 402.0, 384.0, 343.0, 300.0, 429.0, 305.0, 385.0, 292.0, 310.0, 337.0, 376.0, 384.0, 346.0, 377.0, 294.0, 344.0, 312.0, 402.0, 397.0, 369.0, 312.0, 211.0, 327.0, 322.0, 352.0, 307.0, 312.0, 372.0, 316.0, 385.0, 450.0, 368.0, 329.0, 423.0, 388.0, 434.0, 304.0, 325.0, 370.0, 444.0, 445.0, 380.0, 415.0, 391.0, 396.0, 356.0, 416.0, 453.0, 433.0, 405.0, 389.0, 445.0, 391.0, 447.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47497535178951905, "mean_inference_ms": 4.392356127777797, "mean_action_processing_ms": 0.12070407270993484, "mean_env_wait_ms": 0.30138858392813295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011105775833129883, "StateBufferConnector_ms": 0.002968311309814453, "ViewRequirementAgentConnector_ms": 0.15867853164672852}, "num_episodes": 18, "episode_return_max": 458.0, "episode_return_min": 211.0, "episode_return_mean": 380.01, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20650, "num_agent_steps_trained": 20500, "num_env_steps_sampled": 20650, "num_env_steps_trained": 20500, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 179.40111573646172, "num_env_steps_trained_throughput_per_sec": 199.33457304051302, "timesteps_total": 20650, "num_env_steps_sampled_lifetime": 20650, "num_agent_steps_sampled_lifetime": 20650, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 20650, "timers": {"training_iteration_time_ms": 10120.389, "restore_workers_time_ms": 0.0, "training_step_time_ms": 276.354, "sample_time_ms": 275.895, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 20650, "num_env_steps_trained": 20500, "num_agent_steps_sampled": 20650, "num_agent_steps_trained": 20500, "num_training_step_calls_since_last_synch_worker_weights": 413, "num_samples_added_to_queue": 20500}, "done": false, "episodes_total": 206, "training_iteration": 11, "trial_id": "default", "date": "2024-05-19_19-03-31", "timestamp": 1716170611, "time_this_iter_s": 10.034381866455078, "time_total_s": 111.22801852226257, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 111.22801852226257, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 6.835714285714286, "ram_util_percent": 88.02857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0003, "total_loss": 981333.3125, "policy_loss": 43700.44140625, "entropy": 1.2708595991134644, "entropy_coeff": 0.01, "var_gnorm": 64.35742950439453, "vf_loss": 1875278.5, "vf_explained_var": -0.006874680519104004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 22400, "num_env_steps_trained": 22000, "num_agent_steps_sampled": 22400, "num_agent_steps_trained": 22000, "num_training_step_calls_since_last_synch_worker_weights": 448, "num_samples_added_to_queue": 22000, "learner_queue": {"size_count": 44, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.155, "learner_load_time_ms": 1.003, "learner_load_wait_time_ms": 2759.032, "learner_dequeue_time_ms": 29379.602}}, "sampler_results": {"episode_reward_max": 453.0, "episode_reward_min": 211.0, "episode_reward_mean": 370.78, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [372.0, 400.0, 422.0, 441.0, 352.0, 349.0, 371.0, 361.0, 358.0, 391.0, 390.0, 423.0, 386.0, 336.0, 375.0, 399.0, 392.0, 441.0, 398.0, 328.0, 365.0, 383.0, 393.0, 385.0, 447.0, 362.0, 390.0, 404.0, 402.0, 384.0, 343.0, 300.0, 429.0, 305.0, 385.0, 292.0, 310.0, 337.0, 376.0, 384.0, 346.0, 377.0, 294.0, 344.0, 312.0, 402.0, 397.0, 369.0, 312.0, 211.0, 327.0, 322.0, 352.0, 307.0, 312.0, 372.0, 316.0, 385.0, 450.0, 368.0, 329.0, 423.0, 388.0, 434.0, 304.0, 325.0, 370.0, 444.0, 445.0, 380.0, 415.0, 391.0, 396.0, 356.0, 416.0, 453.0, 433.0, 405.0, 389.0, 445.0, 391.0, 447.0, 422.0, 393.0, 407.0, 351.0, 345.0, 369.0, 397.0, 383.0, 363.0, 292.0, 258.0, 371.0, 338.0, 397.0, 313.0, 315.0, 351.0, 298.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47811498011060016, "mean_inference_ms": 4.415676498707805, "mean_action_processing_ms": 0.12202646181195526, "mean_env_wait_ms": 0.29907693578406885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014434099197387695, "StateBufferConnector_ms": 0.002007007598876953, "ViewRequirementAgentConnector_ms": 0.15186834335327148}, "num_episodes": 18, "episode_return_max": 453.0, "episode_return_min": 211.0, "episode_return_mean": 370.78}, "env_runner_results": {"episode_reward_max": 453.0, "episode_reward_min": 211.0, "episode_reward_mean": 370.78, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [372.0, 400.0, 422.0, 441.0, 352.0, 349.0, 371.0, 361.0, 358.0, 391.0, 390.0, 423.0, 386.0, 336.0, 375.0, 399.0, 392.0, 441.0, 398.0, 328.0, 365.0, 383.0, 393.0, 385.0, 447.0, 362.0, 390.0, 404.0, 402.0, 384.0, 343.0, 300.0, 429.0, 305.0, 385.0, 292.0, 310.0, 337.0, 376.0, 384.0, 346.0, 377.0, 294.0, 344.0, 312.0, 402.0, 397.0, 369.0, 312.0, 211.0, 327.0, 322.0, 352.0, 307.0, 312.0, 372.0, 316.0, 385.0, 450.0, 368.0, 329.0, 423.0, 388.0, 434.0, 304.0, 325.0, 370.0, 444.0, 445.0, 380.0, 415.0, 391.0, 396.0, 356.0, 416.0, 453.0, 433.0, 405.0, 389.0, 445.0, 391.0, 447.0, 422.0, 393.0, 407.0, 351.0, 345.0, 369.0, 397.0, 383.0, 363.0, 292.0, 258.0, 371.0, 338.0, 397.0, 313.0, 315.0, 351.0, 298.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47811498011060016, "mean_inference_ms": 4.415676498707805, "mean_action_processing_ms": 0.12202646181195526, "mean_env_wait_ms": 0.29907693578406885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014434099197387695, "StateBufferConnector_ms": 0.002007007598876953, "ViewRequirementAgentConnector_ms": 0.15186834335327148}, "num_episodes": 18, "episode_return_max": 453.0, "episode_return_min": 211.0, "episode_return_mean": 370.78}, "episode_reward_max": 453.0, "episode_reward_min": 211.0, "episode_reward_mean": 370.78, "episode_len_mean": 100.0, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [372.0, 400.0, 422.0, 441.0, 352.0, 349.0, 371.0, 361.0, 358.0, 391.0, 390.0, 423.0, 386.0, 336.0, 375.0, 399.0, 392.0, 441.0, 398.0, 328.0, 365.0, 383.0, 393.0, 385.0, 447.0, 362.0, 390.0, 404.0, 402.0, 384.0, 343.0, 300.0, 429.0, 305.0, 385.0, 292.0, 310.0, 337.0, 376.0, 384.0, 346.0, 377.0, 294.0, 344.0, 312.0, 402.0, 397.0, 369.0, 312.0, 211.0, 327.0, 322.0, 352.0, 307.0, 312.0, 372.0, 316.0, 385.0, 450.0, 368.0, 329.0, 423.0, 388.0, 434.0, 304.0, 325.0, 370.0, 444.0, 445.0, 380.0, 415.0, 391.0, 396.0, 356.0, 416.0, 453.0, 433.0, 405.0, 389.0, 445.0, 391.0, 447.0, 422.0, 393.0, 407.0, 351.0, 345.0, 369.0, 397.0, 383.0, 363.0, 292.0, 258.0, 371.0, 338.0, 397.0, 313.0, 315.0, 351.0, 298.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47811498011060016, "mean_inference_ms": 4.415676498707805, "mean_action_processing_ms": 0.12202646181195526, "mean_env_wait_ms": 0.29907693578406885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014434099197387695, "StateBufferConnector_ms": 0.002007007598876953, "ViewRequirementAgentConnector_ms": 0.15186834335327148}, "num_episodes": 18, "episode_return_max": 453.0, "episode_return_min": 211.0, "episode_return_mean": 370.78, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22400, "num_agent_steps_trained": 22000, "num_env_steps_sampled": 22400, "num_env_steps_trained": 22000, "num_env_steps_sampled_this_iter": 1750, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 173.73527484575794, "num_env_steps_trained_throughput_per_sec": 148.91594986779253, "timesteps_total": 22400, "num_env_steps_sampled_lifetime": 22400, "num_agent_steps_sampled_lifetime": 22400, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 22400, "timers": {"training_iteration_time_ms": 10122.42, "restore_workers_time_ms": 0.0, "training_step_time_ms": 275.727, "sample_time_ms": 275.313, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 22400, "num_env_steps_trained": 22000, "num_agent_steps_sampled": 22400, "num_agent_steps_trained": 22000, "num_training_step_calls_since_last_synch_worker_weights": 448, "num_samples_added_to_queue": 22000}, "done": false, "episodes_total": 224, "training_iteration": 12, "trial_id": "default", "date": "2024-05-19_19-03-41", "timestamp": 1716170621, "time_this_iter_s": 10.072796106338501, "time_total_s": 121.30081462860107, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 121.30081462860107, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 6.8999999999999995, "ram_util_percent": 87.87142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0003, "total_loss": 1016419.9375, "policy_loss": 41360.65234375, "entropy": 1.1652909517288208, "entropy_coeff": 0.01, "var_gnorm": 64.38920593261719, "vf_loss": 1950130.25, "vf_explained_var": -0.009043455123901367}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 24200, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24200, "num_agent_steps_trained": 24000, "num_training_step_calls_since_last_synch_worker_weights": 484, "num_samples_added_to_queue": 24000, "learner_queue": {"size_count": 48, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.006, "learner_load_time_ms": 1.003, "learner_load_wait_time_ms": 2728.879, "learner_dequeue_time_ms": 29379.602}}, "sampler_results": {"episode_reward_max": 453.0, "episode_reward_min": 211.0, "episode_reward_mean": 360.7, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [398.0, 328.0, 365.0, 383.0, 393.0, 385.0, 447.0, 362.0, 390.0, 404.0, 402.0, 384.0, 343.0, 300.0, 429.0, 305.0, 385.0, 292.0, 310.0, 337.0, 376.0, 384.0, 346.0, 377.0, 294.0, 344.0, 312.0, 402.0, 397.0, 369.0, 312.0, 211.0, 327.0, 322.0, 352.0, 307.0, 312.0, 372.0, 316.0, 385.0, 450.0, 368.0, 329.0, 423.0, 388.0, 434.0, 304.0, 325.0, 370.0, 444.0, 445.0, 380.0, 415.0, 391.0, 396.0, 356.0, 416.0, 453.0, 433.0, 405.0, 389.0, 445.0, 391.0, 447.0, 422.0, 393.0, 407.0, 351.0, 345.0, 369.0, 397.0, 383.0, 363.0, 292.0, 258.0, 371.0, 338.0, 397.0, 313.0, 315.0, 351.0, 298.0, 323.0, 344.0, 358.0, 337.0, 365.0, 292.0, 346.0, 338.0, 254.0, 307.0, 285.0, 342.0, 316.0, 329.0, 436.0, 296.0, 302.0, 381.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48149655549551695, "mean_inference_ms": 4.440095254267233, "mean_action_processing_ms": 0.12303426488845254, "mean_env_wait_ms": 0.29658850127497155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019429445266723633, "StateBufferConnector_ms": 0.002007007598876953, "ViewRequirementAgentConnector_ms": 0.15961551666259766}, "num_episodes": 18, "episode_return_max": 453.0, "episode_return_min": 211.0, "episode_return_mean": 360.7}, "env_runner_results": {"episode_reward_max": 453.0, "episode_reward_min": 211.0, "episode_reward_mean": 360.7, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [398.0, 328.0, 365.0, 383.0, 393.0, 385.0, 447.0, 362.0, 390.0, 404.0, 402.0, 384.0, 343.0, 300.0, 429.0, 305.0, 385.0, 292.0, 310.0, 337.0, 376.0, 384.0, 346.0, 377.0, 294.0, 344.0, 312.0, 402.0, 397.0, 369.0, 312.0, 211.0, 327.0, 322.0, 352.0, 307.0, 312.0, 372.0, 316.0, 385.0, 450.0, 368.0, 329.0, 423.0, 388.0, 434.0, 304.0, 325.0, 370.0, 444.0, 445.0, 380.0, 415.0, 391.0, 396.0, 356.0, 416.0, 453.0, 433.0, 405.0, 389.0, 445.0, 391.0, 447.0, 422.0, 393.0, 407.0, 351.0, 345.0, 369.0, 397.0, 383.0, 363.0, 292.0, 258.0, 371.0, 338.0, 397.0, 313.0, 315.0, 351.0, 298.0, 323.0, 344.0, 358.0, 337.0, 365.0, 292.0, 346.0, 338.0, 254.0, 307.0, 285.0, 342.0, 316.0, 329.0, 436.0, 296.0, 302.0, 381.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48149655549551695, "mean_inference_ms": 4.440095254267233, "mean_action_processing_ms": 0.12303426488845254, "mean_env_wait_ms": 0.29658850127497155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019429445266723633, "StateBufferConnector_ms": 0.002007007598876953, "ViewRequirementAgentConnector_ms": 0.15961551666259766}, "num_episodes": 18, "episode_return_max": 453.0, "episode_return_min": 211.0, "episode_return_mean": 360.7}, "episode_reward_max": 453.0, "episode_reward_min": 211.0, "episode_reward_mean": 360.7, "episode_len_mean": 100.0, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [398.0, 328.0, 365.0, 383.0, 393.0, 385.0, 447.0, 362.0, 390.0, 404.0, 402.0, 384.0, 343.0, 300.0, 429.0, 305.0, 385.0, 292.0, 310.0, 337.0, 376.0, 384.0, 346.0, 377.0, 294.0, 344.0, 312.0, 402.0, 397.0, 369.0, 312.0, 211.0, 327.0, 322.0, 352.0, 307.0, 312.0, 372.0, 316.0, 385.0, 450.0, 368.0, 329.0, 423.0, 388.0, 434.0, 304.0, 325.0, 370.0, 444.0, 445.0, 380.0, 415.0, 391.0, 396.0, 356.0, 416.0, 453.0, 433.0, 405.0, 389.0, 445.0, 391.0, 447.0, 422.0, 393.0, 407.0, 351.0, 345.0, 369.0, 397.0, 383.0, 363.0, 292.0, 258.0, 371.0, 338.0, 397.0, 313.0, 315.0, 351.0, 298.0, 323.0, 344.0, 358.0, 337.0, 365.0, 292.0, 346.0, 338.0, 254.0, 307.0, 285.0, 342.0, 316.0, 329.0, 436.0, 296.0, 302.0, 381.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48149655549551695, "mean_inference_ms": 4.440095254267233, "mean_action_processing_ms": 0.12303426488845254, "mean_env_wait_ms": 0.29658850127497155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019429445266723633, "StateBufferConnector_ms": 0.002007007598876953, "ViewRequirementAgentConnector_ms": 0.15961551666259766}, "num_episodes": 18, "episode_return_max": 453.0, "episode_return_min": 211.0, "episode_return_mean": 360.7, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24200, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24200, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 176.66373200052192, "num_env_steps_trained_throughput_per_sec": 196.29303555613546, "timesteps_total": 24200, "num_env_steps_sampled_lifetime": 24200, "num_agent_steps_sampled_lifetime": 24200, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 24200, "timers": {"training_iteration_time_ms": 10118.107, "restore_workers_time_ms": 0.06, "training_step_time_ms": 335.511, "sample_time_ms": 335.157, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 24200, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24200, "num_agent_steps_trained": 24000, "num_training_step_calls_since_last_synch_worker_weights": 484, "num_samples_added_to_queue": 24000}, "done": false, "episodes_total": 242, "training_iteration": 13, "trial_id": "default", "date": "2024-05-19_19-03-51", "timestamp": 1716170631, "time_this_iter_s": 10.188848495483398, "time_total_s": 131.48966312408447, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 131.48966312408447, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 7.1466666666666665, "ram_util_percent": 88.05333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0003, "total_loss": 1055843.25, "policy_loss": 45273.98828125, "entropy": 1.2043185234069824, "entropy_coeff": 0.01, "var_gnorm": 64.4111328125, "vf_loss": 2021150.625, "vf_explained_var": -0.010486125946044922}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 25900, "num_env_steps_trained": 25500, "num_agent_steps_sampled": 25900, "num_agent_steps_trained": 25500, "num_training_step_calls_since_last_synch_worker_weights": 518, "num_samples_added_to_queue": 25500, "learner_queue": {"size_count": 51, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 89.061, "learner_load_time_ms": 0.752, "learner_load_wait_time_ms": 2846.962, "learner_dequeue_time_ms": 33468.848}}, "sampler_results": {"episode_reward_max": 464.0, "episode_reward_min": 211.0, "episode_reward_mean": 360.63, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.0, 310.0, 337.0, 376.0, 384.0, 346.0, 377.0, 294.0, 344.0, 312.0, 402.0, 397.0, 369.0, 312.0, 211.0, 327.0, 322.0, 352.0, 307.0, 312.0, 372.0, 316.0, 385.0, 450.0, 368.0, 329.0, 423.0, 388.0, 434.0, 304.0, 325.0, 370.0, 444.0, 445.0, 380.0, 415.0, 391.0, 396.0, 356.0, 416.0, 453.0, 433.0, 405.0, 389.0, 445.0, 391.0, 447.0, 422.0, 393.0, 407.0, 351.0, 345.0, 369.0, 397.0, 383.0, 363.0, 292.0, 258.0, 371.0, 338.0, 397.0, 313.0, 315.0, 351.0, 298.0, 323.0, 344.0, 358.0, 337.0, 365.0, 292.0, 346.0, 338.0, 254.0, 307.0, 285.0, 342.0, 316.0, 329.0, 436.0, 296.0, 302.0, 381.0, 384.0, 305.0, 325.0, 330.0, 322.0, 439.0, 401.0, 363.0, 373.0, 304.0, 431.0, 375.0, 386.0, 464.0, 405.0, 399.0, 390.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48473329614961685, "mean_inference_ms": 4.464718530110474, "mean_action_processing_ms": 0.12381335452651868, "mean_env_wait_ms": 0.2948362793995151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02089834213256836, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1753549575805664}, "num_episodes": 17, "episode_return_max": 464.0, "episode_return_min": 211.0, "episode_return_mean": 360.63}, "env_runner_results": {"episode_reward_max": 464.0, "episode_reward_min": 211.0, "episode_reward_mean": 360.63, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.0, 310.0, 337.0, 376.0, 384.0, 346.0, 377.0, 294.0, 344.0, 312.0, 402.0, 397.0, 369.0, 312.0, 211.0, 327.0, 322.0, 352.0, 307.0, 312.0, 372.0, 316.0, 385.0, 450.0, 368.0, 329.0, 423.0, 388.0, 434.0, 304.0, 325.0, 370.0, 444.0, 445.0, 380.0, 415.0, 391.0, 396.0, 356.0, 416.0, 453.0, 433.0, 405.0, 389.0, 445.0, 391.0, 447.0, 422.0, 393.0, 407.0, 351.0, 345.0, 369.0, 397.0, 383.0, 363.0, 292.0, 258.0, 371.0, 338.0, 397.0, 313.0, 315.0, 351.0, 298.0, 323.0, 344.0, 358.0, 337.0, 365.0, 292.0, 346.0, 338.0, 254.0, 307.0, 285.0, 342.0, 316.0, 329.0, 436.0, 296.0, 302.0, 381.0, 384.0, 305.0, 325.0, 330.0, 322.0, 439.0, 401.0, 363.0, 373.0, 304.0, 431.0, 375.0, 386.0, 464.0, 405.0, 399.0, 390.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48473329614961685, "mean_inference_ms": 4.464718530110474, "mean_action_processing_ms": 0.12381335452651868, "mean_env_wait_ms": 0.2948362793995151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02089834213256836, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1753549575805664}, "num_episodes": 17, "episode_return_max": 464.0, "episode_return_min": 211.0, "episode_return_mean": 360.63}, "episode_reward_max": 464.0, "episode_reward_min": 211.0, "episode_reward_mean": 360.63, "episode_len_mean": 100.0, "episodes_this_iter": 17, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [292.0, 310.0, 337.0, 376.0, 384.0, 346.0, 377.0, 294.0, 344.0, 312.0, 402.0, 397.0, 369.0, 312.0, 211.0, 327.0, 322.0, 352.0, 307.0, 312.0, 372.0, 316.0, 385.0, 450.0, 368.0, 329.0, 423.0, 388.0, 434.0, 304.0, 325.0, 370.0, 444.0, 445.0, 380.0, 415.0, 391.0, 396.0, 356.0, 416.0, 453.0, 433.0, 405.0, 389.0, 445.0, 391.0, 447.0, 422.0, 393.0, 407.0, 351.0, 345.0, 369.0, 397.0, 383.0, 363.0, 292.0, 258.0, 371.0, 338.0, 397.0, 313.0, 315.0, 351.0, 298.0, 323.0, 344.0, 358.0, 337.0, 365.0, 292.0, 346.0, 338.0, 254.0, 307.0, 285.0, 342.0, 316.0, 329.0, 436.0, 296.0, 302.0, 381.0, 384.0, 305.0, 325.0, 330.0, 322.0, 439.0, 401.0, 363.0, 373.0, 304.0, 431.0, 375.0, 386.0, 464.0, 405.0, 399.0, 390.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48473329614961685, "mean_inference_ms": 4.464718530110474, "mean_action_processing_ms": 0.12381335452651868, "mean_env_wait_ms": 0.2948362793995151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02089834213256836, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1753549575805664}, "num_episodes": 17, "episode_return_max": 464.0, "episode_return_min": 211.0, "episode_return_mean": 360.63, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25900, "num_agent_steps_trained": 25500, "num_env_steps_sampled": 25900, "num_env_steps_trained": 25500, "num_env_steps_sampled_this_iter": 1700, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 167.51739953878143, "num_env_steps_trained_throughput_per_sec": 147.80947018127773, "timesteps_total": 25900, "num_env_steps_sampled_lifetime": 25900, "num_agent_steps_sampled_lifetime": 25900, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 25900, "timers": {"training_iteration_time_ms": 10118.435, "restore_workers_time_ms": 0.0, "training_step_time_ms": 258.497, "sample_time_ms": 258.181, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 25900, "num_env_steps_trained": 25500, "num_agent_steps_sampled": 25900, "num_agent_steps_trained": 25500, "num_training_step_calls_since_last_synch_worker_weights": 518, "num_samples_added_to_queue": 25500}, "done": false, "episodes_total": 259, "training_iteration": 14, "trial_id": "default", "date": "2024-05-19_19-04-02", "timestamp": 1716170642, "time_this_iter_s": 10.148199558258057, "time_total_s": 141.63786268234253, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 141.63786268234253, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 6.65, "ram_util_percent": 88.68571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0003, "total_loss": 1403063.5, "policy_loss": 54480.37109375, "entropy": 1.2841335535049438, "entropy_coeff": 0.01, "var_gnorm": 64.43814086914062, "vf_loss": 2697179.0, "vf_explained_var": -0.008927464485168457}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 27700, "num_env_steps_trained": 27500, "num_agent_steps_sampled": 27700, "num_agent_steps_trained": 27500, "num_training_step_calls_since_last_synch_worker_weights": 554, "num_samples_added_to_queue": 27500, "learner_queue": {"size_count": 55, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 96.286, "learner_load_time_ms": 0.752, "learner_load_wait_time_ms": 2750.341, "learner_dequeue_time_ms": 33468.848}}, "sampler_results": {"episode_reward_max": 464.0, "episode_reward_min": 254.0, "episode_reward_mean": 374.16, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [307.0, 312.0, 372.0, 316.0, 385.0, 450.0, 368.0, 329.0, 423.0, 388.0, 434.0, 304.0, 325.0, 370.0, 444.0, 445.0, 380.0, 415.0, 391.0, 396.0, 356.0, 416.0, 453.0, 433.0, 405.0, 389.0, 445.0, 391.0, 447.0, 422.0, 393.0, 407.0, 351.0, 345.0, 369.0, 397.0, 383.0, 363.0, 292.0, 258.0, 371.0, 338.0, 397.0, 313.0, 315.0, 351.0, 298.0, 323.0, 344.0, 358.0, 337.0, 365.0, 292.0, 346.0, 338.0, 254.0, 307.0, 285.0, 342.0, 316.0, 329.0, 436.0, 296.0, 302.0, 381.0, 384.0, 305.0, 325.0, 330.0, 322.0, 439.0, 401.0, 363.0, 373.0, 304.0, 431.0, 375.0, 386.0, 464.0, 405.0, 399.0, 390.0, 450.0, 359.0, 386.0, 401.0, 436.0, 448.0, 459.0, 419.0, 395.0, 413.0, 419.0, 420.0, 359.0, 443.0, 342.0, 457.0, 383.0, 428.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4873668036647072, "mean_inference_ms": 4.484976236302406, "mean_action_processing_ms": 0.12449419956590449, "mean_env_wait_ms": 0.29344344317153204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017795085906982422, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.16449403762817383}, "num_episodes": 18, "episode_return_max": 464.0, "episode_return_min": 254.0, "episode_return_mean": 374.16}, "env_runner_results": {"episode_reward_max": 464.0, "episode_reward_min": 254.0, "episode_reward_mean": 374.16, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [307.0, 312.0, 372.0, 316.0, 385.0, 450.0, 368.0, 329.0, 423.0, 388.0, 434.0, 304.0, 325.0, 370.0, 444.0, 445.0, 380.0, 415.0, 391.0, 396.0, 356.0, 416.0, 453.0, 433.0, 405.0, 389.0, 445.0, 391.0, 447.0, 422.0, 393.0, 407.0, 351.0, 345.0, 369.0, 397.0, 383.0, 363.0, 292.0, 258.0, 371.0, 338.0, 397.0, 313.0, 315.0, 351.0, 298.0, 323.0, 344.0, 358.0, 337.0, 365.0, 292.0, 346.0, 338.0, 254.0, 307.0, 285.0, 342.0, 316.0, 329.0, 436.0, 296.0, 302.0, 381.0, 384.0, 305.0, 325.0, 330.0, 322.0, 439.0, 401.0, 363.0, 373.0, 304.0, 431.0, 375.0, 386.0, 464.0, 405.0, 399.0, 390.0, 450.0, 359.0, 386.0, 401.0, 436.0, 448.0, 459.0, 419.0, 395.0, 413.0, 419.0, 420.0, 359.0, 443.0, 342.0, 457.0, 383.0, 428.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4873668036647072, "mean_inference_ms": 4.484976236302406, "mean_action_processing_ms": 0.12449419956590449, "mean_env_wait_ms": 0.29344344317153204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017795085906982422, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.16449403762817383}, "num_episodes": 18, "episode_return_max": 464.0, "episode_return_min": 254.0, "episode_return_mean": 374.16}, "episode_reward_max": 464.0, "episode_reward_min": 254.0, "episode_reward_mean": 374.16, "episode_len_mean": 100.0, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [307.0, 312.0, 372.0, 316.0, 385.0, 450.0, 368.0, 329.0, 423.0, 388.0, 434.0, 304.0, 325.0, 370.0, 444.0, 445.0, 380.0, 415.0, 391.0, 396.0, 356.0, 416.0, 453.0, 433.0, 405.0, 389.0, 445.0, 391.0, 447.0, 422.0, 393.0, 407.0, 351.0, 345.0, 369.0, 397.0, 383.0, 363.0, 292.0, 258.0, 371.0, 338.0, 397.0, 313.0, 315.0, 351.0, 298.0, 323.0, 344.0, 358.0, 337.0, 365.0, 292.0, 346.0, 338.0, 254.0, 307.0, 285.0, 342.0, 316.0, 329.0, 436.0, 296.0, 302.0, 381.0, 384.0, 305.0, 325.0, 330.0, 322.0, 439.0, 401.0, 363.0, 373.0, 304.0, 431.0, 375.0, 386.0, 464.0, 405.0, 399.0, 390.0, 450.0, 359.0, 386.0, 401.0, 436.0, 448.0, 459.0, 419.0, 395.0, 413.0, 419.0, 420.0, 359.0, 443.0, 342.0, 457.0, 383.0, 428.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4873668036647072, "mean_inference_ms": 4.484976236302406, "mean_action_processing_ms": 0.12449419956590449, "mean_env_wait_ms": 0.29344344317153204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017795085906982422, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.16449403762817383}, "num_episodes": 18, "episode_return_max": 464.0, "episode_return_min": 254.0, "episode_return_mean": 374.16, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27700, "num_agent_steps_trained": 27500, "num_env_steps_sampled": 27700, "num_env_steps_trained": 27500, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 179.34236066110705, "num_env_steps_trained_throughput_per_sec": 199.2692896234523, "timesteps_total": 27700, "num_env_steps_sampled_lifetime": 27700, "num_agent_steps_sampled_lifetime": 27700, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 27700, "timers": {"training_iteration_time_ms": 10121.824, "restore_workers_time_ms": 0.0, "training_step_time_ms": 322.96, "sample_time_ms": 322.341, "synch_weights_time_ms": 0.1}, "counters": {"num_env_steps_sampled": 27700, "num_env_steps_trained": 27500, "num_agent_steps_sampled": 27700, "num_agent_steps_trained": 27500, "num_training_step_calls_since_last_synch_worker_weights": 554, "num_samples_added_to_queue": 27500}, "done": false, "episodes_total": 277, "training_iteration": 15, "trial_id": "default", "date": "2024-05-19_19-04-12", "timestamp": 1716170652, "time_this_iter_s": 10.037679672241211, "time_total_s": 151.67554235458374, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 151.67554235458374, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 6.6499999999999995, "ram_util_percent": 88.62857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0003, "total_loss": 824580.0625, "policy_loss": 36354.4296875, "entropy": 1.25814950466156, "entropy_coeff": 0.01, "var_gnorm": 64.46388244628906, "vf_loss": 1576463.875, "vf_explained_var": -0.010046601295471191}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 29900, "num_env_steps_trained": 29500, "num_agent_steps_sampled": 29900, "num_agent_steps_trained": 29500, "num_training_step_calls_since_last_synch_worker_weights": 598, "num_samples_added_to_queue": 29500, "learner_queue": {"size_count": 59, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.992, "learner_load_time_ms": 0.752, "learner_load_wait_time_ms": 2580.03, "learner_dequeue_time_ms": 33468.848}}, "sampler_results": {"episode_reward_max": 464.0, "episode_reward_min": 189.0, "episode_reward_mean": 365.34, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [453.0, 433.0, 405.0, 389.0, 445.0, 391.0, 447.0, 422.0, 393.0, 407.0, 351.0, 345.0, 369.0, 397.0, 383.0, 363.0, 292.0, 258.0, 371.0, 338.0, 397.0, 313.0, 315.0, 351.0, 298.0, 323.0, 344.0, 358.0, 337.0, 365.0, 292.0, 346.0, 338.0, 254.0, 307.0, 285.0, 342.0, 316.0, 329.0, 436.0, 296.0, 302.0, 381.0, 384.0, 305.0, 325.0, 330.0, 322.0, 439.0, 401.0, 363.0, 373.0, 304.0, 431.0, 375.0, 386.0, 464.0, 405.0, 399.0, 390.0, 450.0, 359.0, 386.0, 401.0, 436.0, 448.0, 459.0, 419.0, 395.0, 413.0, 419.0, 420.0, 359.0, 443.0, 342.0, 457.0, 383.0, 428.0, 415.0, 453.0, 354.0, 384.0, 403.0, 311.0, 379.0, 394.0, 310.0, 358.0, 339.0, 383.0, 285.0, 307.0, 228.0, 399.0, 330.0, 248.0, 268.0, 380.0, 327.0, 189.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48966871971261433, "mean_inference_ms": 4.491830371826754, "mean_action_processing_ms": 0.12563061575076484, "mean_env_wait_ms": 0.29178898931744013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023458242416381836, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1269237995147705}, "num_episodes": 22, "episode_return_max": 464.0, "episode_return_min": 189.0, "episode_return_mean": 365.34}, "env_runner_results": {"episode_reward_max": 464.0, "episode_reward_min": 189.0, "episode_reward_mean": 365.34, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [453.0, 433.0, 405.0, 389.0, 445.0, 391.0, 447.0, 422.0, 393.0, 407.0, 351.0, 345.0, 369.0, 397.0, 383.0, 363.0, 292.0, 258.0, 371.0, 338.0, 397.0, 313.0, 315.0, 351.0, 298.0, 323.0, 344.0, 358.0, 337.0, 365.0, 292.0, 346.0, 338.0, 254.0, 307.0, 285.0, 342.0, 316.0, 329.0, 436.0, 296.0, 302.0, 381.0, 384.0, 305.0, 325.0, 330.0, 322.0, 439.0, 401.0, 363.0, 373.0, 304.0, 431.0, 375.0, 386.0, 464.0, 405.0, 399.0, 390.0, 450.0, 359.0, 386.0, 401.0, 436.0, 448.0, 459.0, 419.0, 395.0, 413.0, 419.0, 420.0, 359.0, 443.0, 342.0, 457.0, 383.0, 428.0, 415.0, 453.0, 354.0, 384.0, 403.0, 311.0, 379.0, 394.0, 310.0, 358.0, 339.0, 383.0, 285.0, 307.0, 228.0, 399.0, 330.0, 248.0, 268.0, 380.0, 327.0, 189.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48966871971261433, "mean_inference_ms": 4.491830371826754, "mean_action_processing_ms": 0.12563061575076484, "mean_env_wait_ms": 0.29178898931744013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023458242416381836, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1269237995147705}, "num_episodes": 22, "episode_return_max": 464.0, "episode_return_min": 189.0, "episode_return_mean": 365.34}, "episode_reward_max": 464.0, "episode_reward_min": 189.0, "episode_reward_mean": 365.34, "episode_len_mean": 100.0, "episodes_this_iter": 22, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [453.0, 433.0, 405.0, 389.0, 445.0, 391.0, 447.0, 422.0, 393.0, 407.0, 351.0, 345.0, 369.0, 397.0, 383.0, 363.0, 292.0, 258.0, 371.0, 338.0, 397.0, 313.0, 315.0, 351.0, 298.0, 323.0, 344.0, 358.0, 337.0, 365.0, 292.0, 346.0, 338.0, 254.0, 307.0, 285.0, 342.0, 316.0, 329.0, 436.0, 296.0, 302.0, 381.0, 384.0, 305.0, 325.0, 330.0, 322.0, 439.0, 401.0, 363.0, 373.0, 304.0, 431.0, 375.0, 386.0, 464.0, 405.0, 399.0, 390.0, 450.0, 359.0, 386.0, 401.0, 436.0, 448.0, 459.0, 419.0, 395.0, 413.0, 419.0, 420.0, 359.0, 443.0, 342.0, 457.0, 383.0, 428.0, 415.0, 453.0, 354.0, 384.0, 403.0, 311.0, 379.0, 394.0, 310.0, 358.0, 339.0, 383.0, 285.0, 307.0, 228.0, 399.0, 330.0, 248.0, 268.0, 380.0, 327.0, 189.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48966871971261433, "mean_inference_ms": 4.491830371826754, "mean_action_processing_ms": 0.12563061575076484, "mean_env_wait_ms": 0.29178898931744013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023458242416381836, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1269237995147705}, "num_episodes": 22, "episode_return_max": 464.0, "episode_return_min": 189.0, "episode_return_mean": 365.34, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29900, "num_agent_steps_trained": 29500, "num_env_steps_sampled": 29900, "num_env_steps_trained": 29500, "num_env_steps_sampled_this_iter": 2200, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 214.33231257925996, "num_env_steps_trained_throughput_per_sec": 194.84755689023632, "timesteps_total": 29900, "num_env_steps_sampled_lifetime": 29900, "num_agent_steps_sampled_lifetime": 29900, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 29900, "timers": {"training_iteration_time_ms": 10139.21, "restore_workers_time_ms": 0.0, "training_step_time_ms": 238.432, "sample_time_ms": 237.046, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 29900, "num_env_steps_trained": 29500, "num_agent_steps_sampled": 29900, "num_agent_steps_trained": 29500, "num_training_step_calls_since_last_synch_worker_weights": 598, "num_samples_added_to_queue": 29500}, "done": false, "episodes_total": 299, "training_iteration": 16, "trial_id": "default", "date": "2024-05-19_19-04-22", "timestamp": 1716170662, "time_this_iter_s": 10.265429258346558, "time_total_s": 161.9409716129303, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 161.9409716129303, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 5.38, "ram_util_percent": 89.05333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0003, "total_loss": 748713.375, "policy_loss": 39134.1484375, "entropy": 1.293637990951538, "entropy_coeff": 0.01, "var_gnorm": 64.4892578125, "vf_loss": 1419171.375, "vf_explained_var": -0.011426329612731934}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 31750, "num_env_steps_trained": 31500, "num_agent_steps_sampled": 31750, "num_agent_steps_trained": 31500, "num_training_step_calls_since_last_synch_worker_weights": 635, "num_samples_added_to_queue": 31500, "learner_queue": {"size_count": 63, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.02, "learner_load_time_ms": 0.752, "learner_load_wait_time_ms": 2522.659, "learner_dequeue_time_ms": 33468.848}}, "sampler_results": {"episode_reward_max": 464.0, "episode_reward_min": 189.0, "episode_reward_mean": 348.17, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [371.0, 338.0, 397.0, 313.0, 315.0, 351.0, 298.0, 323.0, 344.0, 358.0, 337.0, 365.0, 292.0, 346.0, 338.0, 254.0, 307.0, 285.0, 342.0, 316.0, 329.0, 436.0, 296.0, 302.0, 381.0, 384.0, 305.0, 325.0, 330.0, 322.0, 439.0, 401.0, 363.0, 373.0, 304.0, 431.0, 375.0, 386.0, 464.0, 405.0, 399.0, 390.0, 450.0, 359.0, 386.0, 401.0, 436.0, 448.0, 459.0, 419.0, 395.0, 413.0, 419.0, 420.0, 359.0, 443.0, 342.0, 457.0, 383.0, 428.0, 415.0, 453.0, 354.0, 384.0, 403.0, 311.0, 379.0, 394.0, 310.0, 358.0, 339.0, 383.0, 285.0, 307.0, 228.0, 399.0, 330.0, 248.0, 268.0, 380.0, 327.0, 189.0, 279.0, 326.0, 303.0, 281.0, 363.0, 242.0, 237.0, 272.0, 328.0, 209.0, 227.0, 286.0, 302.0, 257.0, 376.0, 264.0, 350.0, 324.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49113012851759336, "mean_inference_ms": 4.494065711497489, "mean_action_processing_ms": 0.12621160316064808, "mean_env_wait_ms": 0.29104924911829294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04343247413635254, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11224627494812012}, "num_episodes": 18, "episode_return_max": 464.0, "episode_return_min": 189.0, "episode_return_mean": 348.17}, "env_runner_results": {"episode_reward_max": 464.0, "episode_reward_min": 189.0, "episode_reward_mean": 348.17, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [371.0, 338.0, 397.0, 313.0, 315.0, 351.0, 298.0, 323.0, 344.0, 358.0, 337.0, 365.0, 292.0, 346.0, 338.0, 254.0, 307.0, 285.0, 342.0, 316.0, 329.0, 436.0, 296.0, 302.0, 381.0, 384.0, 305.0, 325.0, 330.0, 322.0, 439.0, 401.0, 363.0, 373.0, 304.0, 431.0, 375.0, 386.0, 464.0, 405.0, 399.0, 390.0, 450.0, 359.0, 386.0, 401.0, 436.0, 448.0, 459.0, 419.0, 395.0, 413.0, 419.0, 420.0, 359.0, 443.0, 342.0, 457.0, 383.0, 428.0, 415.0, 453.0, 354.0, 384.0, 403.0, 311.0, 379.0, 394.0, 310.0, 358.0, 339.0, 383.0, 285.0, 307.0, 228.0, 399.0, 330.0, 248.0, 268.0, 380.0, 327.0, 189.0, 279.0, 326.0, 303.0, 281.0, 363.0, 242.0, 237.0, 272.0, 328.0, 209.0, 227.0, 286.0, 302.0, 257.0, 376.0, 264.0, 350.0, 324.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49113012851759336, "mean_inference_ms": 4.494065711497489, "mean_action_processing_ms": 0.12621160316064808, "mean_env_wait_ms": 0.29104924911829294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04343247413635254, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11224627494812012}, "num_episodes": 18, "episode_return_max": 464.0, "episode_return_min": 189.0, "episode_return_mean": 348.17}, "episode_reward_max": 464.0, "episode_reward_min": 189.0, "episode_reward_mean": 348.17, "episode_len_mean": 100.0, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [371.0, 338.0, 397.0, 313.0, 315.0, 351.0, 298.0, 323.0, 344.0, 358.0, 337.0, 365.0, 292.0, 346.0, 338.0, 254.0, 307.0, 285.0, 342.0, 316.0, 329.0, 436.0, 296.0, 302.0, 381.0, 384.0, 305.0, 325.0, 330.0, 322.0, 439.0, 401.0, 363.0, 373.0, 304.0, 431.0, 375.0, 386.0, 464.0, 405.0, 399.0, 390.0, 450.0, 359.0, 386.0, 401.0, 436.0, 448.0, 459.0, 419.0, 395.0, 413.0, 419.0, 420.0, 359.0, 443.0, 342.0, 457.0, 383.0, 428.0, 415.0, 453.0, 354.0, 384.0, 403.0, 311.0, 379.0, 394.0, 310.0, 358.0, 339.0, 383.0, 285.0, 307.0, 228.0, 399.0, 330.0, 248.0, 268.0, 380.0, 327.0, 189.0, 279.0, 326.0, 303.0, 281.0, 363.0, 242.0, 237.0, 272.0, 328.0, 209.0, 227.0, 286.0, 302.0, 257.0, 376.0, 264.0, 350.0, 324.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49113012851759336, "mean_inference_ms": 4.494065711497489, "mean_action_processing_ms": 0.12621160316064808, "mean_env_wait_ms": 0.29104924911829294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04343247413635254, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11224627494812012}, "num_episodes": 18, "episode_return_max": 464.0, "episode_return_min": 189.0, "episode_return_mean": 348.17, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31750, "num_agent_steps_trained": 31500, "num_env_steps_sampled": 31750, "num_env_steps_trained": 31500, "num_env_steps_sampled_this_iter": 1850, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 180.48147839830105, "num_env_steps_trained_throughput_per_sec": 195.1151117819471, "timesteps_total": 31750, "num_env_steps_sampled_lifetime": 31750, "num_agent_steps_sampled_lifetime": 31750, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 31750, "timers": {"training_iteration_time_ms": 10142.121, "restore_workers_time_ms": 0.0, "training_step_time_ms": 299.88, "sample_time_ms": 299.68, "synch_weights_time_ms": 0.1}, "counters": {"num_env_steps_sampled": 31750, "num_env_steps_trained": 31500, "num_agent_steps_sampled": 31750, "num_agent_steps_trained": 31500, "num_training_step_calls_since_last_synch_worker_weights": 635, "num_samples_added_to_queue": 31500}, "done": false, "episodes_total": 317, "training_iteration": 17, "trial_id": "default", "date": "2024-05-19_19-04-32", "timestamp": 1716170672, "time_this_iter_s": 10.250359296798706, "time_total_s": 172.191330909729, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 172.191330909729, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 5.685714285714284, "ram_util_percent": 88.42857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0003, "total_loss": 777210.6875, "policy_loss": 44552.92578125, "entropy": 1.4297468662261963, "entropy_coeff": 0.01, "var_gnorm": 64.51416015625, "vf_loss": 1465329.875, "vf_explained_var": -0.01215052604675293}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 33600, "num_env_steps_trained": 33500, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33500, "num_training_step_calls_since_last_synch_worker_weights": 672, "num_samples_added_to_queue": 33500, "learner_queue": {"size_count": 67, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.252, "learner_load_time_ms": 0.602, "learner_load_wait_time_ms": 2539.966, "learner_dequeue_time_ms": 35407.338}}, "sampler_results": {"episode_reward_max": 464.0, "episode_reward_min": 174.0, "episode_reward_mean": 341.72, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [316.0, 329.0, 436.0, 296.0, 302.0, 381.0, 384.0, 305.0, 325.0, 330.0, 322.0, 439.0, 401.0, 363.0, 373.0, 304.0, 431.0, 375.0, 386.0, 464.0, 405.0, 399.0, 390.0, 450.0, 359.0, 386.0, 401.0, 436.0, 448.0, 459.0, 419.0, 395.0, 413.0, 419.0, 420.0, 359.0, 443.0, 342.0, 457.0, 383.0, 428.0, 415.0, 453.0, 354.0, 384.0, 403.0, 311.0, 379.0, 394.0, 310.0, 358.0, 339.0, 383.0, 285.0, 307.0, 228.0, 399.0, 330.0, 248.0, 268.0, 380.0, 327.0, 189.0, 279.0, 326.0, 303.0, 281.0, 363.0, 242.0, 237.0, 272.0, 328.0, 209.0, 227.0, 286.0, 302.0, 257.0, 376.0, 264.0, 350.0, 324.0, 251.0, 224.0, 339.0, 174.0, 341.0, 319.0, 319.0, 295.0, 324.0, 301.0, 259.0, 299.0, 314.0, 295.0, 296.0, 220.0, 370.0, 356.0, 333.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4925518831008144, "mean_inference_ms": 4.4920049271224425, "mean_action_processing_ms": 0.1268888248801536, "mean_env_wait_ms": 0.2900265573922673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03670907020568848, "StateBufferConnector_ms": 0.0021669864654541016, "ViewRequirementAgentConnector_ms": 0.1495833396911621}, "num_episodes": 19, "episode_return_max": 464.0, "episode_return_min": 174.0, "episode_return_mean": 341.72}, "env_runner_results": {"episode_reward_max": 464.0, "episode_reward_min": 174.0, "episode_reward_mean": 341.72, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [316.0, 329.0, 436.0, 296.0, 302.0, 381.0, 384.0, 305.0, 325.0, 330.0, 322.0, 439.0, 401.0, 363.0, 373.0, 304.0, 431.0, 375.0, 386.0, 464.0, 405.0, 399.0, 390.0, 450.0, 359.0, 386.0, 401.0, 436.0, 448.0, 459.0, 419.0, 395.0, 413.0, 419.0, 420.0, 359.0, 443.0, 342.0, 457.0, 383.0, 428.0, 415.0, 453.0, 354.0, 384.0, 403.0, 311.0, 379.0, 394.0, 310.0, 358.0, 339.0, 383.0, 285.0, 307.0, 228.0, 399.0, 330.0, 248.0, 268.0, 380.0, 327.0, 189.0, 279.0, 326.0, 303.0, 281.0, 363.0, 242.0, 237.0, 272.0, 328.0, 209.0, 227.0, 286.0, 302.0, 257.0, 376.0, 264.0, 350.0, 324.0, 251.0, 224.0, 339.0, 174.0, 341.0, 319.0, 319.0, 295.0, 324.0, 301.0, 259.0, 299.0, 314.0, 295.0, 296.0, 220.0, 370.0, 356.0, 333.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4925518831008144, "mean_inference_ms": 4.4920049271224425, "mean_action_processing_ms": 0.1268888248801536, "mean_env_wait_ms": 0.2900265573922673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03670907020568848, "StateBufferConnector_ms": 0.0021669864654541016, "ViewRequirementAgentConnector_ms": 0.1495833396911621}, "num_episodes": 19, "episode_return_max": 464.0, "episode_return_min": 174.0, "episode_return_mean": 341.72}, "episode_reward_max": 464.0, "episode_reward_min": 174.0, "episode_reward_mean": 341.72, "episode_len_mean": 100.0, "episodes_this_iter": 19, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [316.0, 329.0, 436.0, 296.0, 302.0, 381.0, 384.0, 305.0, 325.0, 330.0, 322.0, 439.0, 401.0, 363.0, 373.0, 304.0, 431.0, 375.0, 386.0, 464.0, 405.0, 399.0, 390.0, 450.0, 359.0, 386.0, 401.0, 436.0, 448.0, 459.0, 419.0, 395.0, 413.0, 419.0, 420.0, 359.0, 443.0, 342.0, 457.0, 383.0, 428.0, 415.0, 453.0, 354.0, 384.0, 403.0, 311.0, 379.0, 394.0, 310.0, 358.0, 339.0, 383.0, 285.0, 307.0, 228.0, 399.0, 330.0, 248.0, 268.0, 380.0, 327.0, 189.0, 279.0, 326.0, 303.0, 281.0, 363.0, 242.0, 237.0, 272.0, 328.0, 209.0, 227.0, 286.0, 302.0, 257.0, 376.0, 264.0, 350.0, 324.0, 251.0, 224.0, 339.0, 174.0, 341.0, 319.0, 319.0, 295.0, 324.0, 301.0, 259.0, 299.0, 314.0, 295.0, 296.0, 220.0, 370.0, 356.0, 333.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4925518831008144, "mean_inference_ms": 4.4920049271224425, "mean_action_processing_ms": 0.1268888248801536, "mean_env_wait_ms": 0.2900265573922673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03670907020568848, "StateBufferConnector_ms": 0.0021669864654541016, "ViewRequirementAgentConnector_ms": 0.1495833396911621}, "num_episodes": 19, "episode_return_max": 464.0, "episode_return_min": 174.0, "episode_return_mean": 341.72, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33500, "num_env_steps_sampled": 33600, "num_env_steps_trained": 33500, "num_env_steps_sampled_this_iter": 1850, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 184.35484874965016, "num_env_steps_trained_throughput_per_sec": 199.30253918881098, "timesteps_total": 33600, "num_env_steps_sampled_lifetime": 33600, "num_agent_steps_sampled_lifetime": 33600, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 33600, "timers": {"training_iteration_time_ms": 10123.633, "restore_workers_time_ms": 0.0, "training_step_time_ms": 263.784, "sample_time_ms": 261.862, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 33600, "num_env_steps_trained": 33500, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33500, "num_training_step_calls_since_last_synch_worker_weights": 672, "num_samples_added_to_queue": 33500}, "done": false, "episodes_total": 336, "training_iteration": 18, "trial_id": "default", "date": "2024-05-19_19-04-42", "timestamp": 1716170682, "time_this_iter_s": 10.036049365997314, "time_total_s": 182.22738027572632, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 182.22738027572632, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 5.857142857142857, "ram_util_percent": 88.24285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0003, "total_loss": 683542.4375, "policy_loss": 40821.828125, "entropy": 1.4424511194229126, "entropy_coeff": 0.01, "var_gnorm": 64.53189849853516, "vf_loss": 1285455.625, "vf_explained_var": -0.011477828025817871}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 35400, "num_env_steps_trained": 35000, "num_agent_steps_sampled": 35400, "num_agent_steps_trained": 35000, "num_training_step_calls_since_last_synch_worker_weights": 708, "num_samples_added_to_queue": 35000, "learner_queue": {"size_count": 70, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.274, "learner_load_time_ms": 0.602, "learner_load_wait_time_ms": 2639.732, "learner_dequeue_time_ms": 35407.338}}, "sampler_results": {"episode_reward_max": 464.0, "episode_reward_min": 174.0, "episode_reward_mean": 332.66, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [386.0, 464.0, 405.0, 399.0, 390.0, 450.0, 359.0, 386.0, 401.0, 436.0, 448.0, 459.0, 419.0, 395.0, 413.0, 419.0, 420.0, 359.0, 443.0, 342.0, 457.0, 383.0, 428.0, 415.0, 453.0, 354.0, 384.0, 403.0, 311.0, 379.0, 394.0, 310.0, 358.0, 339.0, 383.0, 285.0, 307.0, 228.0, 399.0, 330.0, 248.0, 268.0, 380.0, 327.0, 189.0, 279.0, 326.0, 303.0, 281.0, 363.0, 242.0, 237.0, 272.0, 328.0, 209.0, 227.0, 286.0, 302.0, 257.0, 376.0, 264.0, 350.0, 324.0, 251.0, 224.0, 339.0, 174.0, 341.0, 319.0, 319.0, 295.0, 324.0, 301.0, 259.0, 299.0, 314.0, 295.0, 296.0, 220.0, 370.0, 356.0, 333.0, 300.0, 301.0, 307.0, 325.0, 287.0, 320.0, 344.0, 341.0, 284.0, 417.0, 303.0, 248.0, 309.0, 281.0, 319.0, 270.0, 237.0, 313.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49324167056758234, "mean_inference_ms": 4.486130447654867, "mean_action_processing_ms": 0.12750789558041142, "mean_env_wait_ms": 0.2897438250297567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034598588943481445, "StateBufferConnector_ms": 0.0021669864654541016, "ViewRequirementAgentConnector_ms": 0.1345524787902832}, "num_episodes": 18, "episode_return_max": 464.0, "episode_return_min": 174.0, "episode_return_mean": 332.66}, "env_runner_results": {"episode_reward_max": 464.0, "episode_reward_min": 174.0, "episode_reward_mean": 332.66, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [386.0, 464.0, 405.0, 399.0, 390.0, 450.0, 359.0, 386.0, 401.0, 436.0, 448.0, 459.0, 419.0, 395.0, 413.0, 419.0, 420.0, 359.0, 443.0, 342.0, 457.0, 383.0, 428.0, 415.0, 453.0, 354.0, 384.0, 403.0, 311.0, 379.0, 394.0, 310.0, 358.0, 339.0, 383.0, 285.0, 307.0, 228.0, 399.0, 330.0, 248.0, 268.0, 380.0, 327.0, 189.0, 279.0, 326.0, 303.0, 281.0, 363.0, 242.0, 237.0, 272.0, 328.0, 209.0, 227.0, 286.0, 302.0, 257.0, 376.0, 264.0, 350.0, 324.0, 251.0, 224.0, 339.0, 174.0, 341.0, 319.0, 319.0, 295.0, 324.0, 301.0, 259.0, 299.0, 314.0, 295.0, 296.0, 220.0, 370.0, 356.0, 333.0, 300.0, 301.0, 307.0, 325.0, 287.0, 320.0, 344.0, 341.0, 284.0, 417.0, 303.0, 248.0, 309.0, 281.0, 319.0, 270.0, 237.0, 313.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49324167056758234, "mean_inference_ms": 4.486130447654867, "mean_action_processing_ms": 0.12750789558041142, "mean_env_wait_ms": 0.2897438250297567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034598588943481445, "StateBufferConnector_ms": 0.0021669864654541016, "ViewRequirementAgentConnector_ms": 0.1345524787902832}, "num_episodes": 18, "episode_return_max": 464.0, "episode_return_min": 174.0, "episode_return_mean": 332.66}, "episode_reward_max": 464.0, "episode_reward_min": 174.0, "episode_reward_mean": 332.66, "episode_len_mean": 100.0, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [386.0, 464.0, 405.0, 399.0, 390.0, 450.0, 359.0, 386.0, 401.0, 436.0, 448.0, 459.0, 419.0, 395.0, 413.0, 419.0, 420.0, 359.0, 443.0, 342.0, 457.0, 383.0, 428.0, 415.0, 453.0, 354.0, 384.0, 403.0, 311.0, 379.0, 394.0, 310.0, 358.0, 339.0, 383.0, 285.0, 307.0, 228.0, 399.0, 330.0, 248.0, 268.0, 380.0, 327.0, 189.0, 279.0, 326.0, 303.0, 281.0, 363.0, 242.0, 237.0, 272.0, 328.0, 209.0, 227.0, 286.0, 302.0, 257.0, 376.0, 264.0, 350.0, 324.0, 251.0, 224.0, 339.0, 174.0, 341.0, 319.0, 319.0, 295.0, 324.0, 301.0, 259.0, 299.0, 314.0, 295.0, 296.0, 220.0, 370.0, 356.0, 333.0, 300.0, 301.0, 307.0, 325.0, 287.0, 320.0, 344.0, 341.0, 284.0, 417.0, 303.0, 248.0, 309.0, 281.0, 319.0, 270.0, 237.0, 313.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49324167056758234, "mean_inference_ms": 4.486130447654867, "mean_action_processing_ms": 0.12750789558041142, "mean_env_wait_ms": 0.2897438250297567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034598588943481445, "StateBufferConnector_ms": 0.0021669864654541016, "ViewRequirementAgentConnector_ms": 0.1345524787902832}, "num_episodes": 18, "episode_return_max": 464.0, "episode_return_min": 174.0, "episode_return_mean": 332.66, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35400, "num_agent_steps_trained": 35000, "num_env_steps_sampled": 35400, "num_env_steps_trained": 35000, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 178.89753110060002, "num_env_steps_trained_throughput_per_sec": 149.08127591716666, "timesteps_total": 35400, "num_env_steps_sampled_lifetime": 35400, "num_agent_steps_sampled_lifetime": 35400, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 35400, "timers": {"training_iteration_time_ms": 10118.323, "restore_workers_time_ms": 0.0, "training_step_time_ms": 319.811, "sample_time_ms": 319.289, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 35400, "num_env_steps_trained": 35000, "num_agent_steps_sampled": 35400, "num_agent_steps_trained": 35000, "num_training_step_calls_since_last_synch_worker_weights": 708, "num_samples_added_to_queue": 35000}, "done": false, "episodes_total": 354, "training_iteration": 19, "trial_id": "default", "date": "2024-05-19_19-04-52", "timestamp": 1716170692, "time_this_iter_s": 10.063570737838745, "time_total_s": 192.29095101356506, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 192.29095101356506, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 6.199999999999999, "ram_util_percent": 88.18}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0003, "total_loss": 921232.9375, "policy_loss": 47715.12109375, "entropy": 1.401457667350769, "entropy_coeff": 0.01, "var_gnorm": 64.55386352539062, "vf_loss": 1747049.625, "vf_explained_var": -0.012267827987670898}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 74.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 37250, "num_env_steps_trained": 37000, "num_agent_steps_sampled": 37250, "num_agent_steps_trained": 37000, "num_training_step_calls_since_last_synch_worker_weights": 745, "num_samples_added_to_queue": 37000, "learner_queue": {"size_count": 74, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 76.686, "learner_load_time_ms": 0.602, "learner_load_wait_time_ms": 2661.752, "learner_dequeue_time_ms": 35407.338}}, "sampler_results": {"episode_reward_max": 457.0, "episode_reward_min": 174.0, "episode_reward_mean": 313.82, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [443.0, 342.0, 457.0, 383.0, 428.0, 415.0, 453.0, 354.0, 384.0, 403.0, 311.0, 379.0, 394.0, 310.0, 358.0, 339.0, 383.0, 285.0, 307.0, 228.0, 399.0, 330.0, 248.0, 268.0, 380.0, 327.0, 189.0, 279.0, 326.0, 303.0, 281.0, 363.0, 242.0, 237.0, 272.0, 328.0, 209.0, 227.0, 286.0, 302.0, 257.0, 376.0, 264.0, 350.0, 324.0, 251.0, 224.0, 339.0, 174.0, 341.0, 319.0, 319.0, 295.0, 324.0, 301.0, 259.0, 299.0, 314.0, 295.0, 296.0, 220.0, 370.0, 356.0, 333.0, 300.0, 301.0, 307.0, 325.0, 287.0, 320.0, 344.0, 341.0, 284.0, 417.0, 303.0, 248.0, 309.0, 281.0, 319.0, 270.0, 237.0, 313.0, 284.0, 275.0, 278.0, 319.0, 196.0, 302.0, 347.0, 311.0, 269.0, 348.0, 272.0, 332.0, 263.0, 329.0, 387.0, 365.0, 393.0, 254.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4939088800458001, "mean_inference_ms": 4.4765157636079, "mean_action_processing_ms": 0.12816144000624077, "mean_env_wait_ms": 0.2896312198272015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04520153999328613, "StateBufferConnector_ms": 0.0021669864654541016, "ViewRequirementAgentConnector_ms": 0.13938403129577637}, "num_episodes": 18, "episode_return_max": 457.0, "episode_return_min": 174.0, "episode_return_mean": 313.82}, "env_runner_results": {"episode_reward_max": 457.0, "episode_reward_min": 174.0, "episode_reward_mean": 313.82, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [443.0, 342.0, 457.0, 383.0, 428.0, 415.0, 453.0, 354.0, 384.0, 403.0, 311.0, 379.0, 394.0, 310.0, 358.0, 339.0, 383.0, 285.0, 307.0, 228.0, 399.0, 330.0, 248.0, 268.0, 380.0, 327.0, 189.0, 279.0, 326.0, 303.0, 281.0, 363.0, 242.0, 237.0, 272.0, 328.0, 209.0, 227.0, 286.0, 302.0, 257.0, 376.0, 264.0, 350.0, 324.0, 251.0, 224.0, 339.0, 174.0, 341.0, 319.0, 319.0, 295.0, 324.0, 301.0, 259.0, 299.0, 314.0, 295.0, 296.0, 220.0, 370.0, 356.0, 333.0, 300.0, 301.0, 307.0, 325.0, 287.0, 320.0, 344.0, 341.0, 284.0, 417.0, 303.0, 248.0, 309.0, 281.0, 319.0, 270.0, 237.0, 313.0, 284.0, 275.0, 278.0, 319.0, 196.0, 302.0, 347.0, 311.0, 269.0, 348.0, 272.0, 332.0, 263.0, 329.0, 387.0, 365.0, 393.0, 254.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4939088800458001, "mean_inference_ms": 4.4765157636079, "mean_action_processing_ms": 0.12816144000624077, "mean_env_wait_ms": 0.2896312198272015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04520153999328613, "StateBufferConnector_ms": 0.0021669864654541016, "ViewRequirementAgentConnector_ms": 0.13938403129577637}, "num_episodes": 18, "episode_return_max": 457.0, "episode_return_min": 174.0, "episode_return_mean": 313.82}, "episode_reward_max": 457.0, "episode_reward_min": 174.0, "episode_reward_mean": 313.82, "episode_len_mean": 100.0, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [443.0, 342.0, 457.0, 383.0, 428.0, 415.0, 453.0, 354.0, 384.0, 403.0, 311.0, 379.0, 394.0, 310.0, 358.0, 339.0, 383.0, 285.0, 307.0, 228.0, 399.0, 330.0, 248.0, 268.0, 380.0, 327.0, 189.0, 279.0, 326.0, 303.0, 281.0, 363.0, 242.0, 237.0, 272.0, 328.0, 209.0, 227.0, 286.0, 302.0, 257.0, 376.0, 264.0, 350.0, 324.0, 251.0, 224.0, 339.0, 174.0, 341.0, 319.0, 319.0, 295.0, 324.0, 301.0, 259.0, 299.0, 314.0, 295.0, 296.0, 220.0, 370.0, 356.0, 333.0, 300.0, 301.0, 307.0, 325.0, 287.0, 320.0, 344.0, 341.0, 284.0, 417.0, 303.0, 248.0, 309.0, 281.0, 319.0, 270.0, 237.0, 313.0, 284.0, 275.0, 278.0, 319.0, 196.0, 302.0, 347.0, 311.0, 269.0, 348.0, 272.0, 332.0, 263.0, 329.0, 387.0, 365.0, 393.0, 254.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4939088800458001, "mean_inference_ms": 4.4765157636079, "mean_action_processing_ms": 0.12816144000624077, "mean_env_wait_ms": 0.2896312198272015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04520153999328613, "StateBufferConnector_ms": 0.0021669864654541016, "ViewRequirementAgentConnector_ms": 0.13938403129577637}, "num_episodes": 18, "episode_return_max": 457.0, "episode_return_min": 174.0, "episode_return_mean": 313.82, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37250, "num_agent_steps_trained": 37000, "num_env_steps_sampled": 37250, "num_env_steps_trained": 37000, "num_env_steps_sampled_this_iter": 1850, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 184.2114616810527, "num_env_steps_trained_throughput_per_sec": 199.14752614167858, "timesteps_total": 37250, "num_env_steps_sampled_lifetime": 37250, "num_agent_steps_sampled_lifetime": 37250, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 37250, "timers": {"training_iteration_time_ms": 10113.412, "restore_workers_time_ms": 0.0, "training_step_time_ms": 311.454, "sample_time_ms": 309.238, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 37250, "num_env_steps_trained": 37000, "num_agent_steps_sampled": 37250, "num_agent_steps_trained": 37000, "num_training_step_calls_since_last_synch_worker_weights": 745, "num_samples_added_to_queue": 37000}, "done": false, "episodes_total": 372, "training_iteration": 20, "trial_id": "default", "date": "2024-05-19_19-05-03", "timestamp": 1716170703, "time_this_iter_s": 10.043805360794067, "time_total_s": 202.33475637435913, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 202.33475637435913, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 6.9142857142857155, "ram_util_percent": 88.62142857142858}}
