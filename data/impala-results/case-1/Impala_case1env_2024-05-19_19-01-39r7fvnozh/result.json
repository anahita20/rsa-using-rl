{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0, "total_loss": 993255.9375, "policy_loss": 75336.984375, "entropy": 2.0794284343719482, "entropy_coeff": 0.01, "var_gnorm": 64.00000762939453, "vf_loss": 1835858.75, "vf_explained_var": -1.537799835205078e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1900, "num_env_steps_trained": 1500, "num_agent_steps_sampled": 1900, "num_agent_steps_trained": 1500, "num_training_step_calls_since_last_synch_worker_weights": 38, "num_samples_added_to_queue": 1500, "learner_queue": {"size_count": 3, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.0, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 70236.017, "learner_dequeue_time_ms": 205519.62}}, "sampler_results": {"episode_reward_max": 365.0, "episode_reward_min": 258.0, "episode_reward_mean": 314.0, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 1900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.0, 337.0, 301.0, 314.0, 293.0, 298.0, 365.0, 310.0, 274.0, 353.0, 258.0, 326.0, 349.0, 276.0, 313.0, 302.0, 293.0, 362.0, 340.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49541762852154553, "mean_inference_ms": 4.3634308569685905, "mean_action_processing_ms": 0.1310288812034322, "mean_env_wait_ms": 0.2949540079549261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025997663799085115, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.146434181614926}, "num_episodes": 19, "episode_return_max": 365.0, "episode_return_min": 258.0, "episode_return_mean": 314.0}, "env_runner_results": {"episode_reward_max": 365.0, "episode_reward_min": 258.0, "episode_reward_mean": 314.0, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 1900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.0, 337.0, 301.0, 314.0, 293.0, 298.0, 365.0, 310.0, 274.0, 353.0, 258.0, 326.0, 349.0, 276.0, 313.0, 302.0, 293.0, 362.0, 340.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49541762852154553, "mean_inference_ms": 4.3634308569685905, "mean_action_processing_ms": 0.1310288812034322, "mean_env_wait_ms": 0.2949540079549261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025997663799085115, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.146434181614926}, "num_episodes": 19, "episode_return_max": 365.0, "episode_return_min": 258.0, "episode_return_mean": 314.0}, "episode_reward_max": 365.0, "episode_reward_min": 258.0, "episode_reward_mean": 314.0, "episode_len_mean": 100.0, "episodes_this_iter": 19, "episodes_timesteps_total": 1900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [302.0, 337.0, 301.0, 314.0, 293.0, 298.0, 365.0, 310.0, 274.0, 353.0, 258.0, 326.0, 349.0, 276.0, 313.0, 302.0, 293.0, 362.0, 340.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49541762852154553, "mean_inference_ms": 4.3634308569685905, "mean_action_processing_ms": 0.1310288812034322, "mean_env_wait_ms": 0.2949540079549261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025997663799085115, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.146434181614926}, "num_episodes": 19, "episode_return_max": 365.0, "episode_return_min": 258.0, "episode_return_mean": 314.0, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1900, "num_agent_steps_trained": 1500, "num_env_steps_sampled": 1900, "num_env_steps_trained": 1500, "num_env_steps_sampled_this_iter": 1900, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 187.8613752089142, "num_env_steps_trained_throughput_per_sec": 148.31161200703752, "timesteps_total": 1900, "num_env_steps_sampled_lifetime": 1900, "num_agent_steps_sampled_lifetime": 1900, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 1900, "timers": {"training_iteration_time_ms": 10113.841, "restore_workers_time_ms": 0.0, "training_step_time_ms": 280.27, "sample_time_ms": 279.662, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 1900, "num_env_steps_trained": 1500, "num_agent_steps_sampled": 1900, "num_agent_steps_trained": 1500, "num_training_step_calls_since_last_synch_worker_weights": 38, "num_samples_added_to_queue": 1500}, "done": false, "episodes_total": 19, "training_iteration": 1, "trial_id": "default", "date": "2024-05-19_19-05-13", "timestamp": 1716170713, "time_this_iter_s": 10.113840579986572, "time_total_s": 10.113840579986572, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 10.113840579986572, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 6.3401993355481725, "ram_util_percent": 88.16744186046512}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0, "total_loss": 940818.125, "policy_loss": 71565.9296875, "entropy": 2.0794286727905273, "entropy_coeff": 0.01, "var_gnorm": 64.00000762939453, "vf_loss": 1738525.25, "vf_explained_var": -6.9141387939453125e-06}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3750, "num_env_steps_trained": 3500, "num_agent_steps_sampled": 3750, "num_agent_steps_trained": 3500, "num_training_step_calls_since_last_synch_worker_weights": 75, "num_samples_added_to_queue": 3500, "learner_queue": {"size_count": 7, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.902, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 31611.612, "learner_dequeue_time_ms": 205519.62}}, "sampler_results": {"episode_reward_max": 426.0, "episode_reward_min": 250.0, "episode_reward_mean": 313.43243243243245, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 3700, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.0, 337.0, 301.0, 314.0, 293.0, 298.0, 365.0, 310.0, 274.0, 353.0, 258.0, 326.0, 349.0, 276.0, 313.0, 302.0, 293.0, 362.0, 340.0, 276.0, 346.0, 261.0, 390.0, 402.0, 345.0, 250.0, 276.0, 265.0, 426.0, 281.0, 301.0, 250.0, 352.0, 319.0, 258.0, 347.0, 286.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5005130209640197, "mean_inference_ms": 4.402343424131848, "mean_action_processing_ms": 0.1412620055032418, "mean_env_wait_ms": 0.2918040564297765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07279499157055004, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.15646895846805056}, "num_episodes": 18, "episode_return_max": 426.0, "episode_return_min": 250.0, "episode_return_mean": 313.43243243243245}, "env_runner_results": {"episode_reward_max": 426.0, "episode_reward_min": 250.0, "episode_reward_mean": 313.43243243243245, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 3700, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.0, 337.0, 301.0, 314.0, 293.0, 298.0, 365.0, 310.0, 274.0, 353.0, 258.0, 326.0, 349.0, 276.0, 313.0, 302.0, 293.0, 362.0, 340.0, 276.0, 346.0, 261.0, 390.0, 402.0, 345.0, 250.0, 276.0, 265.0, 426.0, 281.0, 301.0, 250.0, 352.0, 319.0, 258.0, 347.0, 286.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5005130209640197, "mean_inference_ms": 4.402343424131848, "mean_action_processing_ms": 0.1412620055032418, "mean_env_wait_ms": 0.2918040564297765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07279499157055004, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.15646895846805056}, "num_episodes": 18, "episode_return_max": 426.0, "episode_return_min": 250.0, "episode_return_mean": 313.43243243243245}, "episode_reward_max": 426.0, "episode_reward_min": 250.0, "episode_reward_mean": 313.43243243243245, "episode_len_mean": 100.0, "episodes_this_iter": 18, "episodes_timesteps_total": 3700, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [302.0, 337.0, 301.0, 314.0, 293.0, 298.0, 365.0, 310.0, 274.0, 353.0, 258.0, 326.0, 349.0, 276.0, 313.0, 302.0, 293.0, 362.0, 340.0, 276.0, 346.0, 261.0, 390.0, 402.0, 345.0, 250.0, 276.0, 265.0, 426.0, 281.0, 301.0, 250.0, 352.0, 319.0, 258.0, 347.0, 286.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5005130209640197, "mean_inference_ms": 4.402343424131848, "mean_action_processing_ms": 0.1412620055032418, "mean_env_wait_ms": 0.2918040564297765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07279499157055004, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.15646895846805056}, "num_episodes": 18, "episode_return_max": 426.0, "episode_return_min": 250.0, "episode_return_mean": 313.43243243243245, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3750, "num_agent_steps_trained": 3500, "num_env_steps_sampled": 3750, "num_env_steps_trained": 3500, "num_env_steps_sampled_this_iter": 1850, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 180.12473666538898, "num_env_steps_trained_throughput_per_sec": 194.7294450436638, "timesteps_total": 3750, "num_env_steps_sampled_lifetime": 3750, "num_agent_steps_sampled_lifetime": 3750, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 3750, "timers": {"training_iteration_time_ms": 10192.25, "restore_workers_time_ms": 0.0, "training_step_time_ms": 295.062, "sample_time_ms": 293.699, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 3750, "num_env_steps_trained": 3500, "num_agent_steps_sampled": 3750, "num_agent_steps_trained": 3500, "num_training_step_calls_since_last_synch_worker_weights": 75, "num_samples_added_to_queue": 3500}, "done": false, "episodes_total": 37, "training_iteration": 2, "trial_id": "default", "date": "2024-05-19_19-05-23", "timestamp": 1716170723, "time_this_iter_s": 10.272209644317627, "time_total_s": 20.3860502243042, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 20.3860502243042, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 5.793333333333333, "ram_util_percent": 88.65333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0, "total_loss": 1041235.375, "policy_loss": 76190.890625, "entropy": 2.07942795753479, "entropy_coeff": 0.01, "var_gnorm": 64.00000762939453, "vf_loss": 1930109.75, "vf_explained_var": 3.933906555175781e-06}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5550, "num_env_steps_trained": 5500, "num_agent_steps_sampled": 5550, "num_agent_steps_trained": 5500, "num_training_step_calls_since_last_synch_worker_weights": 111, "num_samples_added_to_queue": 5500, "learner_queue": {"size_count": 11, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 95.982, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2678.415, "learner_dequeue_time_ms": 205519.62}}, "sampler_results": {"episode_reward_max": 426.0, "episode_reward_min": 250.0, "episode_reward_mean": 316.8909090909091, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 5500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.0, 337.0, 301.0, 314.0, 293.0, 298.0, 365.0, 310.0, 274.0, 353.0, 258.0, 326.0, 349.0, 276.0, 313.0, 302.0, 293.0, 362.0, 340.0, 276.0, 346.0, 261.0, 390.0, 402.0, 345.0, 250.0, 276.0, 265.0, 426.0, 281.0, 301.0, 250.0, 352.0, 319.0, 258.0, 347.0, 286.0, 296.0, 329.0, 297.0, 291.0, 349.0, 324.0, 292.0, 274.0, 320.0, 350.0, 376.0, 359.0, 349.0, 343.0, 311.0, 326.0, 308.0, 338.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5054479488351328, "mean_inference_ms": 4.426394211968974, "mean_action_processing_ms": 0.14836754620782217, "mean_env_wait_ms": 0.29112712502250454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04897117614746094, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.16371553594415839}, "num_episodes": 18, "episode_return_max": 426.0, "episode_return_min": 250.0, "episode_return_mean": 316.8909090909091}, "env_runner_results": {"episode_reward_max": 426.0, "episode_reward_min": 250.0, "episode_reward_mean": 316.8909090909091, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 5500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.0, 337.0, 301.0, 314.0, 293.0, 298.0, 365.0, 310.0, 274.0, 353.0, 258.0, 326.0, 349.0, 276.0, 313.0, 302.0, 293.0, 362.0, 340.0, 276.0, 346.0, 261.0, 390.0, 402.0, 345.0, 250.0, 276.0, 265.0, 426.0, 281.0, 301.0, 250.0, 352.0, 319.0, 258.0, 347.0, 286.0, 296.0, 329.0, 297.0, 291.0, 349.0, 324.0, 292.0, 274.0, 320.0, 350.0, 376.0, 359.0, 349.0, 343.0, 311.0, 326.0, 308.0, 338.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5054479488351328, "mean_inference_ms": 4.426394211968974, "mean_action_processing_ms": 0.14836754620782217, "mean_env_wait_ms": 0.29112712502250454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04897117614746094, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.16371553594415839}, "num_episodes": 18, "episode_return_max": 426.0, "episode_return_min": 250.0, "episode_return_mean": 316.8909090909091}, "episode_reward_max": 426.0, "episode_reward_min": 250.0, "episode_reward_mean": 316.8909090909091, "episode_len_mean": 100.0, "episodes_this_iter": 18, "episodes_timesteps_total": 5500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [302.0, 337.0, 301.0, 314.0, 293.0, 298.0, 365.0, 310.0, 274.0, 353.0, 258.0, 326.0, 349.0, 276.0, 313.0, 302.0, 293.0, 362.0, 340.0, 276.0, 346.0, 261.0, 390.0, 402.0, 345.0, 250.0, 276.0, 265.0, 426.0, 281.0, 301.0, 250.0, 352.0, 319.0, 258.0, 347.0, 286.0, 296.0, 329.0, 297.0, 291.0, 349.0, 324.0, 292.0, 274.0, 320.0, 350.0, 376.0, 359.0, 349.0, 343.0, 311.0, 326.0, 308.0, 338.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5054479488351328, "mean_inference_ms": 4.426394211968974, "mean_action_processing_ms": 0.14836754620782217, "mean_env_wait_ms": 0.29112712502250454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04897117614746094, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.16371553594415839}, "num_episodes": 18, "episode_return_max": 426.0, "episode_return_min": 250.0, "episode_return_mean": 316.8909090909091, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5550, "num_agent_steps_trained": 5500, "num_env_steps_sampled": 5550, "num_env_steps_trained": 5500, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 178.70307780557013, "num_env_steps_trained_throughput_per_sec": 198.55897533952236, "timesteps_total": 5550, "num_env_steps_sampled_lifetime": 5550, "num_agent_steps_sampled_lifetime": 5550, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 5550, "timers": {"training_iteration_time_ms": 10152.358, "restore_workers_time_ms": 0.0, "training_step_time_ms": 274.611, "sample_time_ms": 274.313, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 5550, "num_env_steps_trained": 5500, "num_agent_steps_sampled": 5550, "num_agent_steps_trained": 5500, "num_training_step_calls_since_last_synch_worker_weights": 111, "num_samples_added_to_queue": 5500}, "done": false, "episodes_total": 55, "training_iteration": 3, "trial_id": "default", "date": "2024-05-19_19-05-33", "timestamp": 1716170733, "time_this_iter_s": 10.074574947357178, "time_total_s": 30.460625171661377, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 30.460625171661377, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 5.835714285714286, "ram_util_percent": 88.53571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0, "total_loss": 1013334.1875, "policy_loss": 74801.7109375, "entropy": 2.079428195953369, "entropy_coeff": 0.01, "var_gnorm": 64.00000762939453, "vf_loss": 1877085.75, "vf_explained_var": 7.212162017822266e-06}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7450, "num_env_steps_trained": 7000, "num_agent_steps_sampled": 7450, "num_agent_steps_trained": 7000, "num_training_step_calls_since_last_synch_worker_weights": 149, "num_samples_added_to_queue": 7000, "learner_queue": {"size_count": 14, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 106.911, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2672.416, "learner_dequeue_time_ms": 205519.62}}, "sampler_results": {"episode_reward_max": 426.0, "episode_reward_min": 250.0, "episode_reward_mean": 316.1216216216216, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 7400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.0, 337.0, 301.0, 314.0, 293.0, 298.0, 365.0, 310.0, 274.0, 353.0, 258.0, 326.0, 349.0, 276.0, 313.0, 302.0, 293.0, 362.0, 340.0, 276.0, 346.0, 261.0, 390.0, 402.0, 345.0, 250.0, 276.0, 265.0, 426.0, 281.0, 301.0, 250.0, 352.0, 319.0, 258.0, 347.0, 286.0, 296.0, 329.0, 297.0, 291.0, 349.0, 324.0, 292.0, 274.0, 320.0, 350.0, 376.0, 359.0, 349.0, 343.0, 311.0, 326.0, 308.0, 338.0, 291.0, 360.0, 318.0, 258.0, 292.0, 302.0, 277.0, 292.0, 336.0, 295.0, 271.0, 305.0, 274.0, 368.0, 326.0, 397.0, 336.0, 387.0, 279.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.506178637132681, "mean_inference_ms": 4.4341185107259005, "mean_action_processing_ms": 0.15048296466504607, "mean_env_wait_ms": 0.2923568197723704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03895308520342853, "StateBufferConnector_ms": 0.0015094473555281355, "ViewRequirementAgentConnector_ms": 0.15209301097972974}, "num_episodes": 19, "episode_return_max": 426.0, "episode_return_min": 250.0, "episode_return_mean": 316.1216216216216}, "env_runner_results": {"episode_reward_max": 426.0, "episode_reward_min": 250.0, "episode_reward_mean": 316.1216216216216, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 7400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.0, 337.0, 301.0, 314.0, 293.0, 298.0, 365.0, 310.0, 274.0, 353.0, 258.0, 326.0, 349.0, 276.0, 313.0, 302.0, 293.0, 362.0, 340.0, 276.0, 346.0, 261.0, 390.0, 402.0, 345.0, 250.0, 276.0, 265.0, 426.0, 281.0, 301.0, 250.0, 352.0, 319.0, 258.0, 347.0, 286.0, 296.0, 329.0, 297.0, 291.0, 349.0, 324.0, 292.0, 274.0, 320.0, 350.0, 376.0, 359.0, 349.0, 343.0, 311.0, 326.0, 308.0, 338.0, 291.0, 360.0, 318.0, 258.0, 292.0, 302.0, 277.0, 292.0, 336.0, 295.0, 271.0, 305.0, 274.0, 368.0, 326.0, 397.0, 336.0, 387.0, 279.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.506178637132681, "mean_inference_ms": 4.4341185107259005, "mean_action_processing_ms": 0.15048296466504607, "mean_env_wait_ms": 0.2923568197723704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03895308520342853, "StateBufferConnector_ms": 0.0015094473555281355, "ViewRequirementAgentConnector_ms": 0.15209301097972974}, "num_episodes": 19, "episode_return_max": 426.0, "episode_return_min": 250.0, "episode_return_mean": 316.1216216216216}, "episode_reward_max": 426.0, "episode_reward_min": 250.0, "episode_reward_mean": 316.1216216216216, "episode_len_mean": 100.0, "episodes_this_iter": 19, "episodes_timesteps_total": 7400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [302.0, 337.0, 301.0, 314.0, 293.0, 298.0, 365.0, 310.0, 274.0, 353.0, 258.0, 326.0, 349.0, 276.0, 313.0, 302.0, 293.0, 362.0, 340.0, 276.0, 346.0, 261.0, 390.0, 402.0, 345.0, 250.0, 276.0, 265.0, 426.0, 281.0, 301.0, 250.0, 352.0, 319.0, 258.0, 347.0, 286.0, 296.0, 329.0, 297.0, 291.0, 349.0, 324.0, 292.0, 274.0, 320.0, 350.0, 376.0, 359.0, 349.0, 343.0, 311.0, 326.0, 308.0, 338.0, 291.0, 360.0, 318.0, 258.0, 292.0, 302.0, 277.0, 292.0, 336.0, 295.0, 271.0, 305.0, 274.0, 368.0, 326.0, 397.0, 336.0, 387.0, 279.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.506178637132681, "mean_inference_ms": 4.4341185107259005, "mean_action_processing_ms": 0.15048296466504607, "mean_env_wait_ms": 0.2923568197723704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03895308520342853, "StateBufferConnector_ms": 0.0015094473555281355, "ViewRequirementAgentConnector_ms": 0.15209301097972974}, "num_episodes": 19, "episode_return_max": 426.0, "episode_return_min": 250.0, "episode_return_mean": 316.1216216216216, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7450, "num_agent_steps_trained": 7000, "num_env_steps_sampled": 7450, "num_env_steps_trained": 7000, "num_env_steps_sampled_this_iter": 1900, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 185.47410969232953, "num_env_steps_trained_throughput_per_sec": 146.4269287044707, "timesteps_total": 7450, "num_env_steps_sampled_lifetime": 7450, "num_agent_steps_sampled_lifetime": 7450, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 7450, "timers": {"training_iteration_time_ms": 10175.273, "restore_workers_time_ms": 0.0, "training_step_time_ms": 265.336, "sample_time_ms": 264.823, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 7450, "num_env_steps_trained": 7000, "num_agent_steps_sampled": 7450, "num_agent_steps_trained": 7000, "num_training_step_calls_since_last_synch_worker_weights": 149, "num_samples_added_to_queue": 7000}, "done": false, "episodes_total": 74, "training_iteration": 4, "trial_id": "default", "date": "2024-05-19_19-05-43", "timestamp": 1716170743, "time_this_iter_s": 10.244017362594604, "time_total_s": 40.70464253425598, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 40.70464253425598, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 5.828571428571428, "ram_util_percent": 88.49285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0, "total_loss": 1239615.625, "policy_loss": 84848.4140625, "entropy": 2.079428195953369, "entropy_coeff": 0.01, "var_gnorm": 64.00000762939453, "vf_loss": 2309555.25, "vf_explained_var": -6.67572021484375e-06}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9300, "num_env_steps_trained": 9000, "num_agent_steps_sampled": 9300, "num_agent_steps_trained": 9000, "num_training_step_calls_since_last_synch_worker_weights": 186, "num_samples_added_to_queue": 9000, "learner_queue": {"size_count": 18, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 98.775, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2671.387, "learner_dequeue_time_ms": 124861.988}}, "sampler_results": {"episode_reward_max": 433.0, "episode_reward_min": 250.0, "episode_reward_mean": 322.494623655914, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 9300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.0, 337.0, 301.0, 314.0, 293.0, 298.0, 365.0, 310.0, 274.0, 353.0, 258.0, 326.0, 349.0, 276.0, 313.0, 302.0, 293.0, 362.0, 340.0, 276.0, 346.0, 261.0, 390.0, 402.0, 345.0, 250.0, 276.0, 265.0, 426.0, 281.0, 301.0, 250.0, 352.0, 319.0, 258.0, 347.0, 286.0, 296.0, 329.0, 297.0, 291.0, 349.0, 324.0, 292.0, 274.0, 320.0, 350.0, 376.0, 359.0, 349.0, 343.0, 311.0, 326.0, 308.0, 338.0, 291.0, 360.0, 318.0, 258.0, 292.0, 302.0, 277.0, 292.0, 336.0, 295.0, 271.0, 305.0, 274.0, 368.0, 326.0, 397.0, 336.0, 387.0, 279.0, 345.0, 304.0, 327.0, 348.0, 331.0, 358.0, 354.0, 371.0, 274.0, 410.0, 313.0, 345.0, 263.0, 351.0, 328.0, 433.0, 386.0, 396.0, 362.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5071472906677109, "mean_inference_ms": 4.436870584724947, "mean_action_processing_ms": 0.15318332414389524, "mean_env_wait_ms": 0.29495250565877434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03921062715591923, "StateBufferConnector_ms": 0.001201065637732065, "ViewRequirementAgentConnector_ms": 0.1534664502707861}, "num_episodes": 19, "episode_return_max": 433.0, "episode_return_min": 250.0, "episode_return_mean": 322.494623655914}, "env_runner_results": {"episode_reward_max": 433.0, "episode_reward_min": 250.0, "episode_reward_mean": 322.494623655914, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 9300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.0, 337.0, 301.0, 314.0, 293.0, 298.0, 365.0, 310.0, 274.0, 353.0, 258.0, 326.0, 349.0, 276.0, 313.0, 302.0, 293.0, 362.0, 340.0, 276.0, 346.0, 261.0, 390.0, 402.0, 345.0, 250.0, 276.0, 265.0, 426.0, 281.0, 301.0, 250.0, 352.0, 319.0, 258.0, 347.0, 286.0, 296.0, 329.0, 297.0, 291.0, 349.0, 324.0, 292.0, 274.0, 320.0, 350.0, 376.0, 359.0, 349.0, 343.0, 311.0, 326.0, 308.0, 338.0, 291.0, 360.0, 318.0, 258.0, 292.0, 302.0, 277.0, 292.0, 336.0, 295.0, 271.0, 305.0, 274.0, 368.0, 326.0, 397.0, 336.0, 387.0, 279.0, 345.0, 304.0, 327.0, 348.0, 331.0, 358.0, 354.0, 371.0, 274.0, 410.0, 313.0, 345.0, 263.0, 351.0, 328.0, 433.0, 386.0, 396.0, 362.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5071472906677109, "mean_inference_ms": 4.436870584724947, "mean_action_processing_ms": 0.15318332414389524, "mean_env_wait_ms": 0.29495250565877434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03921062715591923, "StateBufferConnector_ms": 0.001201065637732065, "ViewRequirementAgentConnector_ms": 0.1534664502707861}, "num_episodes": 19, "episode_return_max": 433.0, "episode_return_min": 250.0, "episode_return_mean": 322.494623655914}, "episode_reward_max": 433.0, "episode_reward_min": 250.0, "episode_reward_mean": 322.494623655914, "episode_len_mean": 100.0, "episodes_this_iter": 19, "episodes_timesteps_total": 9300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [302.0, 337.0, 301.0, 314.0, 293.0, 298.0, 365.0, 310.0, 274.0, 353.0, 258.0, 326.0, 349.0, 276.0, 313.0, 302.0, 293.0, 362.0, 340.0, 276.0, 346.0, 261.0, 390.0, 402.0, 345.0, 250.0, 276.0, 265.0, 426.0, 281.0, 301.0, 250.0, 352.0, 319.0, 258.0, 347.0, 286.0, 296.0, 329.0, 297.0, 291.0, 349.0, 324.0, 292.0, 274.0, 320.0, 350.0, 376.0, 359.0, 349.0, 343.0, 311.0, 326.0, 308.0, 338.0, 291.0, 360.0, 318.0, 258.0, 292.0, 302.0, 277.0, 292.0, 336.0, 295.0, 271.0, 305.0, 274.0, 368.0, 326.0, 397.0, 336.0, 387.0, 279.0, 345.0, 304.0, 327.0, 348.0, 331.0, 358.0, 354.0, 371.0, 274.0, 410.0, 313.0, 345.0, 263.0, 351.0, 328.0, 433.0, 386.0, 396.0, 362.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5071472906677109, "mean_inference_ms": 4.436870584724947, "mean_action_processing_ms": 0.15318332414389524, "mean_env_wait_ms": 0.29495250565877434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03921062715591923, "StateBufferConnector_ms": 0.001201065637732065, "ViewRequirementAgentConnector_ms": 0.1534664502707861}, "num_episodes": 19, "episode_return_max": 433.0, "episode_return_min": 250.0, "episode_return_mean": 322.494623655914, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9300, "num_agent_steps_trained": 9000, "num_env_steps_sampled": 9300, "num_env_steps_trained": 9000, "num_env_steps_sampled_this_iter": 1850, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 181.67656899883352, "num_env_steps_trained_throughput_per_sec": 196.40710162036055, "timesteps_total": 9300, "num_env_steps_sampled_lifetime": 9300, "num_agent_steps_sampled_lifetime": 9300, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 9300, "timers": {"training_iteration_time_ms": 10176.805, "restore_workers_time_ms": 0.0, "training_step_time_ms": 255.937, "sample_time_ms": 255.623, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 9300, "num_env_steps_trained": 9000, "num_agent_steps_sampled": 9300, "num_agent_steps_trained": 9000, "num_training_step_calls_since_last_synch_worker_weights": 186, "num_samples_added_to_queue": 9000}, "done": false, "episodes_total": 93, "training_iteration": 5, "trial_id": "default", "date": "2024-05-19_19-05-54", "timestamp": 1716170754, "time_this_iter_s": 10.18393087387085, "time_total_s": 50.88857340812683, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 50.88857340812683, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 5.873333333333334, "ram_util_percent": 88.33333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0, "total_loss": 1054816.0, "policy_loss": 76050.390625, "entropy": 2.07942795753479, "entropy_coeff": 0.01, "var_gnorm": 64.00000762939453, "vf_loss": 1957552.0, "vf_explained_var": -1.2278556823730469e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 11150, "num_env_steps_trained": 11000, "num_agent_steps_sampled": 11150, "num_agent_steps_trained": 11000, "num_training_step_calls_since_last_synch_worker_weights": 223, "num_samples_added_to_queue": 11000, "learner_queue": {"size_count": 22, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.746, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2660.418, "learner_dequeue_time_ms": 124861.988}}, "sampler_results": {"episode_reward_max": 433.0, "episode_reward_min": 250.0, "episode_reward_mean": 327.15, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [326.0, 349.0, 276.0, 313.0, 302.0, 293.0, 362.0, 340.0, 276.0, 346.0, 261.0, 390.0, 402.0, 345.0, 250.0, 276.0, 265.0, 426.0, 281.0, 301.0, 250.0, 352.0, 319.0, 258.0, 347.0, 286.0, 296.0, 329.0, 297.0, 291.0, 349.0, 324.0, 292.0, 274.0, 320.0, 350.0, 376.0, 359.0, 349.0, 343.0, 311.0, 326.0, 308.0, 338.0, 291.0, 360.0, 318.0, 258.0, 292.0, 302.0, 277.0, 292.0, 336.0, 295.0, 271.0, 305.0, 274.0, 368.0, 326.0, 397.0, 336.0, 387.0, 279.0, 345.0, 304.0, 327.0, 348.0, 331.0, 358.0, 354.0, 371.0, 274.0, 410.0, 313.0, 345.0, 263.0, 351.0, 328.0, 433.0, 386.0, 396.0, 362.0, 348.0, 361.0, 395.0, 350.0, 333.0, 362.0, 324.0, 350.0, 353.0, 297.0, 373.0, 315.0, 287.0, 361.0, 327.0, 378.0, 294.0, 320.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5081370936590077, "mean_inference_ms": 4.449894592628388, "mean_action_processing_ms": 0.15619876816925868, "mean_env_wait_ms": 0.29744931065886787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05224180221557617, "StateBufferConnector_ms": 0.0021636486053466797, "ViewRequirementAgentConnector_ms": 0.14719247817993164}, "num_episodes": 18, "episode_return_max": 433.0, "episode_return_min": 250.0, "episode_return_mean": 327.15}, "env_runner_results": {"episode_reward_max": 433.0, "episode_reward_min": 250.0, "episode_reward_mean": 327.15, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [326.0, 349.0, 276.0, 313.0, 302.0, 293.0, 362.0, 340.0, 276.0, 346.0, 261.0, 390.0, 402.0, 345.0, 250.0, 276.0, 265.0, 426.0, 281.0, 301.0, 250.0, 352.0, 319.0, 258.0, 347.0, 286.0, 296.0, 329.0, 297.0, 291.0, 349.0, 324.0, 292.0, 274.0, 320.0, 350.0, 376.0, 359.0, 349.0, 343.0, 311.0, 326.0, 308.0, 338.0, 291.0, 360.0, 318.0, 258.0, 292.0, 302.0, 277.0, 292.0, 336.0, 295.0, 271.0, 305.0, 274.0, 368.0, 326.0, 397.0, 336.0, 387.0, 279.0, 345.0, 304.0, 327.0, 348.0, 331.0, 358.0, 354.0, 371.0, 274.0, 410.0, 313.0, 345.0, 263.0, 351.0, 328.0, 433.0, 386.0, 396.0, 362.0, 348.0, 361.0, 395.0, 350.0, 333.0, 362.0, 324.0, 350.0, 353.0, 297.0, 373.0, 315.0, 287.0, 361.0, 327.0, 378.0, 294.0, 320.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5081370936590077, "mean_inference_ms": 4.449894592628388, "mean_action_processing_ms": 0.15619876816925868, "mean_env_wait_ms": 0.29744931065886787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05224180221557617, "StateBufferConnector_ms": 0.0021636486053466797, "ViewRequirementAgentConnector_ms": 0.14719247817993164}, "num_episodes": 18, "episode_return_max": 433.0, "episode_return_min": 250.0, "episode_return_mean": 327.15}, "episode_reward_max": 433.0, "episode_reward_min": 250.0, "episode_reward_mean": 327.15, "episode_len_mean": 100.0, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [326.0, 349.0, 276.0, 313.0, 302.0, 293.0, 362.0, 340.0, 276.0, 346.0, 261.0, 390.0, 402.0, 345.0, 250.0, 276.0, 265.0, 426.0, 281.0, 301.0, 250.0, 352.0, 319.0, 258.0, 347.0, 286.0, 296.0, 329.0, 297.0, 291.0, 349.0, 324.0, 292.0, 274.0, 320.0, 350.0, 376.0, 359.0, 349.0, 343.0, 311.0, 326.0, 308.0, 338.0, 291.0, 360.0, 318.0, 258.0, 292.0, 302.0, 277.0, 292.0, 336.0, 295.0, 271.0, 305.0, 274.0, 368.0, 326.0, 397.0, 336.0, 387.0, 279.0, 345.0, 304.0, 327.0, 348.0, 331.0, 358.0, 354.0, 371.0, 274.0, 410.0, 313.0, 345.0, 263.0, 351.0, 328.0, 433.0, 386.0, 396.0, 362.0, 348.0, 361.0, 395.0, 350.0, 333.0, 362.0, 324.0, 350.0, 353.0, 297.0, 373.0, 315.0, 287.0, 361.0, 327.0, 378.0, 294.0, 320.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5081370936590077, "mean_inference_ms": 4.449894592628388, "mean_action_processing_ms": 0.15619876816925868, "mean_env_wait_ms": 0.29744931065886787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05224180221557617, "StateBufferConnector_ms": 0.0021636486053466797, "ViewRequirementAgentConnector_ms": 0.14719247817993164}, "num_episodes": 18, "episode_return_max": 433.0, "episode_return_min": 250.0, "episode_return_mean": 327.15, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11150, "num_agent_steps_trained": 11000, "num_env_steps_sampled": 11150, "num_env_steps_trained": 11000, "num_env_steps_sampled_this_iter": 1850, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 181.84451104622582, "num_env_steps_trained_throughput_per_sec": 196.58866059051442, "timesteps_total": 11150, "num_env_steps_sampled_lifetime": 11150, "num_agent_steps_sampled_lifetime": 11150, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 11150, "timers": {"training_iteration_time_ms": 10176.258, "restore_workers_time_ms": 0.0, "training_step_time_ms": 241.56, "sample_time_ms": 241.246, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 11150, "num_env_steps_trained": 11000, "num_agent_steps_sampled": 11150, "num_agent_steps_trained": 11000, "num_training_step_calls_since_last_synch_worker_weights": 223, "num_samples_added_to_queue": 11000}, "done": false, "episodes_total": 111, "training_iteration": 6, "trial_id": "default", "date": "2024-05-19_19-06-04", "timestamp": 1716170764, "time_this_iter_s": 10.174522399902344, "time_total_s": 61.063095808029175, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 61.063095808029175, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 5.842857142857143, "ram_util_percent": 88.52857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0, "total_loss": 1126005.625, "policy_loss": 78656.34375, "entropy": 2.0794284343719482, "entropy_coeff": 0.01, "var_gnorm": 64.00000762939453, "vf_loss": 2094719.25, "vf_explained_var": 1.245737075805664e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 12950, "num_env_steps_trained": 12500, "num_agent_steps_sampled": 12950, "num_agent_steps_trained": 12500, "num_training_step_calls_since_last_synch_worker_weights": 259, "num_samples_added_to_queue": 12500, "learner_queue": {"size_count": 25, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.901, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2708.107, "learner_dequeue_time_ms": 124861.988}}, "sampler_results": {"episode_reward_max": 433.0, "episode_reward_min": 250.0, "episode_reward_mean": 325.92, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [281.0, 301.0, 250.0, 352.0, 319.0, 258.0, 347.0, 286.0, 296.0, 329.0, 297.0, 291.0, 349.0, 324.0, 292.0, 274.0, 320.0, 350.0, 376.0, 359.0, 349.0, 343.0, 311.0, 326.0, 308.0, 338.0, 291.0, 360.0, 318.0, 258.0, 292.0, 302.0, 277.0, 292.0, 336.0, 295.0, 271.0, 305.0, 274.0, 368.0, 326.0, 397.0, 336.0, 387.0, 279.0, 345.0, 304.0, 327.0, 348.0, 331.0, 358.0, 354.0, 371.0, 274.0, 410.0, 313.0, 345.0, 263.0, 351.0, 328.0, 433.0, 386.0, 396.0, 362.0, 348.0, 361.0, 395.0, 350.0, 333.0, 362.0, 324.0, 350.0, 353.0, 297.0, 373.0, 315.0, 287.0, 361.0, 327.0, 378.0, 294.0, 320.0, 324.0, 390.0, 279.0, 300.0, 279.0, 332.0, 345.0, 285.0, 273.0, 251.0, 418.0, 332.0, 301.0, 336.0, 261.0, 309.0, 317.0, 343.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5095963063115458, "mean_inference_ms": 4.463166880709045, "mean_action_processing_ms": 0.159708354173576, "mean_env_wait_ms": 0.3006275008560708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05310821533203125, "StateBufferConnector_ms": 0.0021636486053466797, "ViewRequirementAgentConnector_ms": 0.14351463317871094}, "num_episodes": 18, "episode_return_max": 433.0, "episode_return_min": 250.0, "episode_return_mean": 325.92}, "env_runner_results": {"episode_reward_max": 433.0, "episode_reward_min": 250.0, "episode_reward_mean": 325.92, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [281.0, 301.0, 250.0, 352.0, 319.0, 258.0, 347.0, 286.0, 296.0, 329.0, 297.0, 291.0, 349.0, 324.0, 292.0, 274.0, 320.0, 350.0, 376.0, 359.0, 349.0, 343.0, 311.0, 326.0, 308.0, 338.0, 291.0, 360.0, 318.0, 258.0, 292.0, 302.0, 277.0, 292.0, 336.0, 295.0, 271.0, 305.0, 274.0, 368.0, 326.0, 397.0, 336.0, 387.0, 279.0, 345.0, 304.0, 327.0, 348.0, 331.0, 358.0, 354.0, 371.0, 274.0, 410.0, 313.0, 345.0, 263.0, 351.0, 328.0, 433.0, 386.0, 396.0, 362.0, 348.0, 361.0, 395.0, 350.0, 333.0, 362.0, 324.0, 350.0, 353.0, 297.0, 373.0, 315.0, 287.0, 361.0, 327.0, 378.0, 294.0, 320.0, 324.0, 390.0, 279.0, 300.0, 279.0, 332.0, 345.0, 285.0, 273.0, 251.0, 418.0, 332.0, 301.0, 336.0, 261.0, 309.0, 317.0, 343.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5095963063115458, "mean_inference_ms": 4.463166880709045, "mean_action_processing_ms": 0.159708354173576, "mean_env_wait_ms": 0.3006275008560708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05310821533203125, "StateBufferConnector_ms": 0.0021636486053466797, "ViewRequirementAgentConnector_ms": 0.14351463317871094}, "num_episodes": 18, "episode_return_max": 433.0, "episode_return_min": 250.0, "episode_return_mean": 325.92}, "episode_reward_max": 433.0, "episode_reward_min": 250.0, "episode_reward_mean": 325.92, "episode_len_mean": 100.0, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [281.0, 301.0, 250.0, 352.0, 319.0, 258.0, 347.0, 286.0, 296.0, 329.0, 297.0, 291.0, 349.0, 324.0, 292.0, 274.0, 320.0, 350.0, 376.0, 359.0, 349.0, 343.0, 311.0, 326.0, 308.0, 338.0, 291.0, 360.0, 318.0, 258.0, 292.0, 302.0, 277.0, 292.0, 336.0, 295.0, 271.0, 305.0, 274.0, 368.0, 326.0, 397.0, 336.0, 387.0, 279.0, 345.0, 304.0, 327.0, 348.0, 331.0, 358.0, 354.0, 371.0, 274.0, 410.0, 313.0, 345.0, 263.0, 351.0, 328.0, 433.0, 386.0, 396.0, 362.0, 348.0, 361.0, 395.0, 350.0, 333.0, 362.0, 324.0, 350.0, 353.0, 297.0, 373.0, 315.0, 287.0, 361.0, 327.0, 378.0, 294.0, 320.0, 324.0, 390.0, 279.0, 300.0, 279.0, 332.0, 345.0, 285.0, 273.0, 251.0, 418.0, 332.0, 301.0, 336.0, 261.0, 309.0, 317.0, 343.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5095963063115458, "mean_inference_ms": 4.463166880709045, "mean_action_processing_ms": 0.159708354173576, "mean_env_wait_ms": 0.3006275008560708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05310821533203125, "StateBufferConnector_ms": 0.0021636486053466797, "ViewRequirementAgentConnector_ms": 0.14351463317871094}, "num_episodes": 18, "episode_return_max": 433.0, "episode_return_min": 250.0, "episode_return_mean": 325.92, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12950, "num_agent_steps_trained": 12500, "num_env_steps_sampled": 12950, "num_env_steps_trained": 12500, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 175.9211440504774, "num_env_steps_trained_throughput_per_sec": 146.60095337539784, "timesteps_total": 12950, "num_env_steps_sampled_lifetime": 12950, "num_agent_steps_sampled_lifetime": 12950, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 12950, "timers": {"training_iteration_time_ms": 10184.201, "restore_workers_time_ms": 0.0, "training_step_time_ms": 272.492, "sample_time_ms": 272.191, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 12950, "num_env_steps_trained": 12500, "num_agent_steps_sampled": 12950, "num_agent_steps_trained": 12500, "num_training_step_calls_since_last_synch_worker_weights": 259, "num_samples_added_to_queue": 12500}, "done": false, "episodes_total": 129, "training_iteration": 7, "trial_id": "default", "date": "2024-05-19_19-06-14", "timestamp": 1716170774, "time_this_iter_s": 10.231857061386108, "time_total_s": 71.29495286941528, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 71.29495286941528, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 5.459999999999999, "ram_util_percent": 88.07333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0, "total_loss": 975792.75, "policy_loss": 73373.8125, "entropy": 2.079428195953369, "entropy_coeff": 0.01, "var_gnorm": 64.00000762939453, "vf_loss": 1804858.625, "vf_explained_var": -1.0848045349121094e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 14900, "num_env_steps_trained": 14500, "num_agent_steps_sampled": 14900, "num_agent_steps_trained": 14500, "num_training_step_calls_since_last_synch_worker_weights": 298, "num_samples_added_to_queue": 14500, "learner_queue": {"size_count": 29, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.557, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2636.998, "learner_dequeue_time_ms": 124861.988}}, "sampler_results": {"episode_reward_max": 433.0, "episode_reward_min": 239.0, "episode_reward_mean": 327.95, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [349.0, 343.0, 311.0, 326.0, 308.0, 338.0, 291.0, 360.0, 318.0, 258.0, 292.0, 302.0, 277.0, 292.0, 336.0, 295.0, 271.0, 305.0, 274.0, 368.0, 326.0, 397.0, 336.0, 387.0, 279.0, 345.0, 304.0, 327.0, 348.0, 331.0, 358.0, 354.0, 371.0, 274.0, 410.0, 313.0, 345.0, 263.0, 351.0, 328.0, 433.0, 386.0, 396.0, 362.0, 348.0, 361.0, 395.0, 350.0, 333.0, 362.0, 324.0, 350.0, 353.0, 297.0, 373.0, 315.0, 287.0, 361.0, 327.0, 378.0, 294.0, 320.0, 324.0, 390.0, 279.0, 300.0, 279.0, 332.0, 345.0, 285.0, 273.0, 251.0, 418.0, 332.0, 301.0, 336.0, 261.0, 309.0, 317.0, 343.0, 315.0, 368.0, 283.0, 395.0, 341.0, 264.0, 274.0, 396.0, 345.0, 326.0, 362.0, 320.0, 400.0, 274.0, 314.0, 271.0, 319.0, 239.0, 354.0, 294.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5088091935594619, "mean_inference_ms": 4.460636957235523, "mean_action_processing_ms": 0.16055952361180012, "mean_env_wait_ms": 0.3034833295101351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0353388786315918, "StateBufferConnector_ms": 0.01012873649597168, "ViewRequirementAgentConnector_ms": 0.15186023712158203}, "num_episodes": 20, "episode_return_max": 433.0, "episode_return_min": 239.0, "episode_return_mean": 327.95}, "env_runner_results": {"episode_reward_max": 433.0, "episode_reward_min": 239.0, "episode_reward_mean": 327.95, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [349.0, 343.0, 311.0, 326.0, 308.0, 338.0, 291.0, 360.0, 318.0, 258.0, 292.0, 302.0, 277.0, 292.0, 336.0, 295.0, 271.0, 305.0, 274.0, 368.0, 326.0, 397.0, 336.0, 387.0, 279.0, 345.0, 304.0, 327.0, 348.0, 331.0, 358.0, 354.0, 371.0, 274.0, 410.0, 313.0, 345.0, 263.0, 351.0, 328.0, 433.0, 386.0, 396.0, 362.0, 348.0, 361.0, 395.0, 350.0, 333.0, 362.0, 324.0, 350.0, 353.0, 297.0, 373.0, 315.0, 287.0, 361.0, 327.0, 378.0, 294.0, 320.0, 324.0, 390.0, 279.0, 300.0, 279.0, 332.0, 345.0, 285.0, 273.0, 251.0, 418.0, 332.0, 301.0, 336.0, 261.0, 309.0, 317.0, 343.0, 315.0, 368.0, 283.0, 395.0, 341.0, 264.0, 274.0, 396.0, 345.0, 326.0, 362.0, 320.0, 400.0, 274.0, 314.0, 271.0, 319.0, 239.0, 354.0, 294.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5088091935594619, "mean_inference_ms": 4.460636957235523, "mean_action_processing_ms": 0.16055952361180012, "mean_env_wait_ms": 0.3034833295101351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0353388786315918, "StateBufferConnector_ms": 0.01012873649597168, "ViewRequirementAgentConnector_ms": 0.15186023712158203}, "num_episodes": 20, "episode_return_max": 433.0, "episode_return_min": 239.0, "episode_return_mean": 327.95}, "episode_reward_max": 433.0, "episode_reward_min": 239.0, "episode_reward_mean": 327.95, "episode_len_mean": 100.0, "episodes_this_iter": 20, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [349.0, 343.0, 311.0, 326.0, 308.0, 338.0, 291.0, 360.0, 318.0, 258.0, 292.0, 302.0, 277.0, 292.0, 336.0, 295.0, 271.0, 305.0, 274.0, 368.0, 326.0, 397.0, 336.0, 387.0, 279.0, 345.0, 304.0, 327.0, 348.0, 331.0, 358.0, 354.0, 371.0, 274.0, 410.0, 313.0, 345.0, 263.0, 351.0, 328.0, 433.0, 386.0, 396.0, 362.0, 348.0, 361.0, 395.0, 350.0, 333.0, 362.0, 324.0, 350.0, 353.0, 297.0, 373.0, 315.0, 287.0, 361.0, 327.0, 378.0, 294.0, 320.0, 324.0, 390.0, 279.0, 300.0, 279.0, 332.0, 345.0, 285.0, 273.0, 251.0, 418.0, 332.0, 301.0, 336.0, 261.0, 309.0, 317.0, 343.0, 315.0, 368.0, 283.0, 395.0, 341.0, 264.0, 274.0, 396.0, 345.0, 326.0, 362.0, 320.0, 400.0, 274.0, 314.0, 271.0, 319.0, 239.0, 354.0, 294.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5088091935594619, "mean_inference_ms": 4.460636957235523, "mean_action_processing_ms": 0.16055952361180012, "mean_env_wait_ms": 0.3034833295101351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0353388786315918, "StateBufferConnector_ms": 0.01012873649597168, "ViewRequirementAgentConnector_ms": 0.15186023712158203}, "num_episodes": 20, "episode_return_max": 433.0, "episode_return_min": 239.0, "episode_return_mean": 327.95, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14900, "num_agent_steps_trained": 14500, "num_env_steps_sampled": 14900, "num_env_steps_trained": 14500, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 191.99292844555825, "num_env_steps_trained_throughput_per_sec": 196.9158240467264, "timesteps_total": 14900, "num_env_steps_sampled_lifetime": 14900, "num_agent_steps_sampled_lifetime": 14900, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 14900, "timers": {"training_iteration_time_ms": 10180.754, "restore_workers_time_ms": 0.0, "training_step_time_ms": 297.502, "sample_time_ms": 295.786, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 14900, "num_env_steps_trained": 14500, "num_agent_steps_sampled": 14900, "num_agent_steps_trained": 14500, "num_training_step_calls_since_last_synch_worker_weights": 298, "num_samples_added_to_queue": 14500}, "done": false, "episodes_total": 149, "training_iteration": 8, "trial_id": "default", "date": "2024-05-19_19-06-24", "timestamp": 1716170784, "time_this_iter_s": 10.15662407875061, "time_total_s": 81.4515769481659, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 81.4515769481659, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 5.25, "ram_util_percent": 88.2214285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0, "total_loss": 1049909.625, "policy_loss": 76870.75, "entropy": 2.0794284343719482, "entropy_coeff": 0.01, "var_gnorm": 64.00000762939453, "vf_loss": 1946098.5, "vf_explained_var": 6.377696990966797e-06}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 16600, "num_env_steps_trained": 16500, "num_agent_steps_sampled": 16600, "num_agent_steps_trained": 16500, "num_training_step_calls_since_last_synch_worker_weights": 332, "num_samples_added_to_queue": 16500, "learner_queue": {"size_count": 33, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.62, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2708.971, "learner_dequeue_time_ms": 98076.955}}, "sampler_results": {"episode_reward_max": 439.0, "episode_reward_min": 239.0, "episode_reward_mean": 331.69, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [305.0, 274.0, 368.0, 326.0, 397.0, 336.0, 387.0, 279.0, 345.0, 304.0, 327.0, 348.0, 331.0, 358.0, 354.0, 371.0, 274.0, 410.0, 313.0, 345.0, 263.0, 351.0, 328.0, 433.0, 386.0, 396.0, 362.0, 348.0, 361.0, 395.0, 350.0, 333.0, 362.0, 324.0, 350.0, 353.0, 297.0, 373.0, 315.0, 287.0, 361.0, 327.0, 378.0, 294.0, 320.0, 324.0, 390.0, 279.0, 300.0, 279.0, 332.0, 345.0, 285.0, 273.0, 251.0, 418.0, 332.0, 301.0, 336.0, 261.0, 309.0, 317.0, 343.0, 315.0, 368.0, 283.0, 395.0, 341.0, 264.0, 274.0, 396.0, 345.0, 326.0, 362.0, 320.0, 400.0, 274.0, 314.0, 271.0, 319.0, 239.0, 354.0, 294.0, 361.0, 349.0, 357.0, 263.0, 347.0, 305.0, 307.0, 324.0, 367.0, 298.0, 267.0, 339.0, 369.0, 302.0, 297.0, 350.0, 439.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5104147587451476, "mean_inference_ms": 4.4647382195609415, "mean_action_processing_ms": 0.16105444158684068, "mean_env_wait_ms": 0.30508658554068296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03545808792114258, "StateBufferConnector_ms": 0.01013326644897461, "ViewRequirementAgentConnector_ms": 0.14267539978027344}, "num_episodes": 17, "episode_return_max": 439.0, "episode_return_min": 239.0, "episode_return_mean": 331.69}, "env_runner_results": {"episode_reward_max": 439.0, "episode_reward_min": 239.0, "episode_reward_mean": 331.69, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [305.0, 274.0, 368.0, 326.0, 397.0, 336.0, 387.0, 279.0, 345.0, 304.0, 327.0, 348.0, 331.0, 358.0, 354.0, 371.0, 274.0, 410.0, 313.0, 345.0, 263.0, 351.0, 328.0, 433.0, 386.0, 396.0, 362.0, 348.0, 361.0, 395.0, 350.0, 333.0, 362.0, 324.0, 350.0, 353.0, 297.0, 373.0, 315.0, 287.0, 361.0, 327.0, 378.0, 294.0, 320.0, 324.0, 390.0, 279.0, 300.0, 279.0, 332.0, 345.0, 285.0, 273.0, 251.0, 418.0, 332.0, 301.0, 336.0, 261.0, 309.0, 317.0, 343.0, 315.0, 368.0, 283.0, 395.0, 341.0, 264.0, 274.0, 396.0, 345.0, 326.0, 362.0, 320.0, 400.0, 274.0, 314.0, 271.0, 319.0, 239.0, 354.0, 294.0, 361.0, 349.0, 357.0, 263.0, 347.0, 305.0, 307.0, 324.0, 367.0, 298.0, 267.0, 339.0, 369.0, 302.0, 297.0, 350.0, 439.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5104147587451476, "mean_inference_ms": 4.4647382195609415, "mean_action_processing_ms": 0.16105444158684068, "mean_env_wait_ms": 0.30508658554068296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03545808792114258, "StateBufferConnector_ms": 0.01013326644897461, "ViewRequirementAgentConnector_ms": 0.14267539978027344}, "num_episodes": 17, "episode_return_max": 439.0, "episode_return_min": 239.0, "episode_return_mean": 331.69}, "episode_reward_max": 439.0, "episode_reward_min": 239.0, "episode_reward_mean": 331.69, "episode_len_mean": 100.0, "episodes_this_iter": 17, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [305.0, 274.0, 368.0, 326.0, 397.0, 336.0, 387.0, 279.0, 345.0, 304.0, 327.0, 348.0, 331.0, 358.0, 354.0, 371.0, 274.0, 410.0, 313.0, 345.0, 263.0, 351.0, 328.0, 433.0, 386.0, 396.0, 362.0, 348.0, 361.0, 395.0, 350.0, 333.0, 362.0, 324.0, 350.0, 353.0, 297.0, 373.0, 315.0, 287.0, 361.0, 327.0, 378.0, 294.0, 320.0, 324.0, 390.0, 279.0, 300.0, 279.0, 332.0, 345.0, 285.0, 273.0, 251.0, 418.0, 332.0, 301.0, 336.0, 261.0, 309.0, 317.0, 343.0, 315.0, 368.0, 283.0, 395.0, 341.0, 264.0, 274.0, 396.0, 345.0, 326.0, 362.0, 320.0, 400.0, 274.0, 314.0, 271.0, 319.0, 239.0, 354.0, 294.0, 361.0, 349.0, 357.0, 263.0, 347.0, 305.0, 307.0, 324.0, 367.0, 298.0, 267.0, 339.0, 369.0, 302.0, 297.0, 350.0, 439.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5104147587451476, "mean_inference_ms": 4.4647382195609415, "mean_action_processing_ms": 0.16105444158684068, "mean_env_wait_ms": 0.30508658554068296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03545808792114258, "StateBufferConnector_ms": 0.01013326644897461, "ViewRequirementAgentConnector_ms": 0.14267539978027344}, "num_episodes": 17, "episode_return_max": 439.0, "episode_return_min": 239.0, "episode_return_mean": 331.69, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16600, "num_agent_steps_trained": 16500, "num_env_steps_sampled": 16600, "num_env_steps_trained": 16500, "num_env_steps_sampled_this_iter": 1700, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 168.8648426774162, "num_env_steps_trained_throughput_per_sec": 198.66452079696023, "timesteps_total": 16600, "num_env_steps_sampled_lifetime": 16600, "num_agent_steps_sampled_lifetime": 16600, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 16600, "timers": {"training_iteration_time_ms": 10168.139, "restore_workers_time_ms": 0.0, "training_step_time_ms": 282.896, "sample_time_ms": 282.598, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 16600, "num_env_steps_trained": 16500, "num_agent_steps_sampled": 16600, "num_agent_steps_trained": 16500, "num_training_step_calls_since_last_synch_worker_weights": 332, "num_samples_added_to_queue": 16500}, "done": false, "episodes_total": 166, "training_iteration": 9, "trial_id": "default", "date": "2024-05-19_19-06-34", "timestamp": 1716170794, "time_this_iter_s": 10.069216012954712, "time_total_s": 91.5207929611206, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 91.5207929611206, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 6.007142857142858, "ram_util_percent": 88.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0, "total_loss": 935564.3125, "policy_loss": 72942.328125, "entropy": 2.0794286727905273, "entropy_coeff": 0.01, "var_gnorm": 64.00000762939453, "vf_loss": 1725264.75, "vf_explained_var": -5.364418029785156e-06}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 18450, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18450, "num_agent_steps_trained": 18000, "num_training_step_calls_since_last_synch_worker_weights": 369, "num_samples_added_to_queue": 18000, "learner_queue": {"size_count": 36, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 89.951, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2664.806, "learner_dequeue_time_ms": 98076.955}}, "sampler_results": {"episode_reward_max": 439.0, "episode_reward_min": 239.0, "episode_reward_mean": 329.47, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [313.0, 345.0, 263.0, 351.0, 328.0, 433.0, 386.0, 396.0, 362.0, 348.0, 361.0, 395.0, 350.0, 333.0, 362.0, 324.0, 350.0, 353.0, 297.0, 373.0, 315.0, 287.0, 361.0, 327.0, 378.0, 294.0, 320.0, 324.0, 390.0, 279.0, 300.0, 279.0, 332.0, 345.0, 285.0, 273.0, 251.0, 418.0, 332.0, 301.0, 336.0, 261.0, 309.0, 317.0, 343.0, 315.0, 368.0, 283.0, 395.0, 341.0, 264.0, 274.0, 396.0, 345.0, 326.0, 362.0, 320.0, 400.0, 274.0, 314.0, 271.0, 319.0, 239.0, 354.0, 294.0, 361.0, 349.0, 357.0, 263.0, 347.0, 305.0, 307.0, 324.0, 367.0, 298.0, 267.0, 339.0, 369.0, 302.0, 297.0, 350.0, 439.0, 348.0, 344.0, 263.0, 318.0, 376.0, 363.0, 348.0, 309.0, 317.0, 291.0, 299.0, 285.0, 320.0, 319.0, 275.0, 406.0, 411.0, 280.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5117071731627801, "mean_inference_ms": 4.470522304916508, "mean_action_processing_ms": 0.16048354087302538, "mean_env_wait_ms": 0.3060727192725898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047007083892822266, "StateBufferConnector_ms": 0.01001596450805664, "ViewRequirementAgentConnector_ms": 0.13979053497314453}, "num_episodes": 18, "episode_return_max": 439.0, "episode_return_min": 239.0, "episode_return_mean": 329.47}, "env_runner_results": {"episode_reward_max": 439.0, "episode_reward_min": 239.0, "episode_reward_mean": 329.47, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [313.0, 345.0, 263.0, 351.0, 328.0, 433.0, 386.0, 396.0, 362.0, 348.0, 361.0, 395.0, 350.0, 333.0, 362.0, 324.0, 350.0, 353.0, 297.0, 373.0, 315.0, 287.0, 361.0, 327.0, 378.0, 294.0, 320.0, 324.0, 390.0, 279.0, 300.0, 279.0, 332.0, 345.0, 285.0, 273.0, 251.0, 418.0, 332.0, 301.0, 336.0, 261.0, 309.0, 317.0, 343.0, 315.0, 368.0, 283.0, 395.0, 341.0, 264.0, 274.0, 396.0, 345.0, 326.0, 362.0, 320.0, 400.0, 274.0, 314.0, 271.0, 319.0, 239.0, 354.0, 294.0, 361.0, 349.0, 357.0, 263.0, 347.0, 305.0, 307.0, 324.0, 367.0, 298.0, 267.0, 339.0, 369.0, 302.0, 297.0, 350.0, 439.0, 348.0, 344.0, 263.0, 318.0, 376.0, 363.0, 348.0, 309.0, 317.0, 291.0, 299.0, 285.0, 320.0, 319.0, 275.0, 406.0, 411.0, 280.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5117071731627801, "mean_inference_ms": 4.470522304916508, "mean_action_processing_ms": 0.16048354087302538, "mean_env_wait_ms": 0.3060727192725898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047007083892822266, "StateBufferConnector_ms": 0.01001596450805664, "ViewRequirementAgentConnector_ms": 0.13979053497314453}, "num_episodes": 18, "episode_return_max": 439.0, "episode_return_min": 239.0, "episode_return_mean": 329.47}, "episode_reward_max": 439.0, "episode_reward_min": 239.0, "episode_reward_mean": 329.47, "episode_len_mean": 100.0, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [313.0, 345.0, 263.0, 351.0, 328.0, 433.0, 386.0, 396.0, 362.0, 348.0, 361.0, 395.0, 350.0, 333.0, 362.0, 324.0, 350.0, 353.0, 297.0, 373.0, 315.0, 287.0, 361.0, 327.0, 378.0, 294.0, 320.0, 324.0, 390.0, 279.0, 300.0, 279.0, 332.0, 345.0, 285.0, 273.0, 251.0, 418.0, 332.0, 301.0, 336.0, 261.0, 309.0, 317.0, 343.0, 315.0, 368.0, 283.0, 395.0, 341.0, 264.0, 274.0, 396.0, 345.0, 326.0, 362.0, 320.0, 400.0, 274.0, 314.0, 271.0, 319.0, 239.0, 354.0, 294.0, 361.0, 349.0, 357.0, 263.0, 347.0, 305.0, 307.0, 324.0, 367.0, 298.0, 267.0, 339.0, 369.0, 302.0, 297.0, 350.0, 439.0, 348.0, 344.0, 263.0, 318.0, 376.0, 363.0, 348.0, 309.0, 317.0, 291.0, 299.0, 285.0, 320.0, 319.0, 275.0, 406.0, 411.0, 280.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5117071731627801, "mean_inference_ms": 4.470522304916508, "mean_action_processing_ms": 0.16048354087302538, "mean_env_wait_ms": 0.3060727192725898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047007083892822266, "StateBufferConnector_ms": 0.01001596450805664, "ViewRequirementAgentConnector_ms": 0.13979053497314453}, "num_episodes": 18, "episode_return_max": 439.0, "episode_return_min": 239.0, "episode_return_mean": 329.47, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18450, "num_agent_steps_trained": 18000, "num_env_steps_sampled": 18450, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 1850, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 184.03717447977968, "num_env_steps_trained_throughput_per_sec": 149.2193306592808, "timesteps_total": 18450, "num_env_steps_sampled_lifetime": 18450, "num_agent_steps_sampled_lifetime": 18450, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 18450, "timers": {"training_iteration_time_ms": 10156.557, "restore_workers_time_ms": 0.0, "training_step_time_ms": 286.781, "sample_time_ms": 286.581, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 18450, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18450, "num_agent_steps_trained": 18000, "num_training_step_calls_since_last_synch_worker_weights": 369, "num_samples_added_to_queue": 18000}, "done": false, "episodes_total": 184, "training_iteration": 10, "trial_id": "default", "date": "2024-05-19_19-06-44", "timestamp": 1716170804, "time_this_iter_s": 10.052316904067993, "time_total_s": 101.5731098651886, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 101.5731098651886, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 6.278571428571429, "ram_util_percent": 88.54285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0, "total_loss": 974607.625, "policy_loss": 73361.4921875, "entropy": 2.0794289112091064, "entropy_coeff": 0.01, "var_gnorm": 64.00000762939453, "vf_loss": 1802513.125, "vf_explained_var": -4.172325134277344e-06}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 20400, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20400, "num_agent_steps_trained": 20000, "num_training_step_calls_since_last_synch_worker_weights": 408, "num_samples_added_to_queue": 20000, "learner_queue": {"size_count": 40, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 94.069, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2674.438, "learner_dequeue_time_ms": 98076.955}}, "sampler_results": {"episode_reward_max": 439.0, "episode_reward_min": 239.0, "episode_reward_mean": 323.7, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [315.0, 287.0, 361.0, 327.0, 378.0, 294.0, 320.0, 324.0, 390.0, 279.0, 300.0, 279.0, 332.0, 345.0, 285.0, 273.0, 251.0, 418.0, 332.0, 301.0, 336.0, 261.0, 309.0, 317.0, 343.0, 315.0, 368.0, 283.0, 395.0, 341.0, 264.0, 274.0, 396.0, 345.0, 326.0, 362.0, 320.0, 400.0, 274.0, 314.0, 271.0, 319.0, 239.0, 354.0, 294.0, 361.0, 349.0, 357.0, 263.0, 347.0, 305.0, 307.0, 324.0, 367.0, 298.0, 267.0, 339.0, 369.0, 302.0, 297.0, 350.0, 439.0, 348.0, 344.0, 263.0, 318.0, 376.0, 363.0, 348.0, 309.0, 317.0, 291.0, 299.0, 285.0, 320.0, 319.0, 275.0, 406.0, 411.0, 280.0, 290.0, 294.0, 384.0, 308.0, 317.0, 433.0, 362.0, 296.0, 358.0, 258.0, 331.0, 284.0, 240.0, 322.0, 301.0, 340.0, 353.0, 358.0, 318.0, 299.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5123382738395147, "mean_inference_ms": 4.471162149985644, "mean_action_processing_ms": 0.15905487504648363, "mean_env_wait_ms": 0.3058133257466415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04182171821594238, "StateBufferConnector_ms": 0.008969306945800781, "ViewRequirementAgentConnector_ms": 0.13384222984313965}, "num_episodes": 20, "episode_return_max": 439.0, "episode_return_min": 239.0, "episode_return_mean": 323.7}, "env_runner_results": {"episode_reward_max": 439.0, "episode_reward_min": 239.0, "episode_reward_mean": 323.7, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [315.0, 287.0, 361.0, 327.0, 378.0, 294.0, 320.0, 324.0, 390.0, 279.0, 300.0, 279.0, 332.0, 345.0, 285.0, 273.0, 251.0, 418.0, 332.0, 301.0, 336.0, 261.0, 309.0, 317.0, 343.0, 315.0, 368.0, 283.0, 395.0, 341.0, 264.0, 274.0, 396.0, 345.0, 326.0, 362.0, 320.0, 400.0, 274.0, 314.0, 271.0, 319.0, 239.0, 354.0, 294.0, 361.0, 349.0, 357.0, 263.0, 347.0, 305.0, 307.0, 324.0, 367.0, 298.0, 267.0, 339.0, 369.0, 302.0, 297.0, 350.0, 439.0, 348.0, 344.0, 263.0, 318.0, 376.0, 363.0, 348.0, 309.0, 317.0, 291.0, 299.0, 285.0, 320.0, 319.0, 275.0, 406.0, 411.0, 280.0, 290.0, 294.0, 384.0, 308.0, 317.0, 433.0, 362.0, 296.0, 358.0, 258.0, 331.0, 284.0, 240.0, 322.0, 301.0, 340.0, 353.0, 358.0, 318.0, 299.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5123382738395147, "mean_inference_ms": 4.471162149985644, "mean_action_processing_ms": 0.15905487504648363, "mean_env_wait_ms": 0.3058133257466415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04182171821594238, "StateBufferConnector_ms": 0.008969306945800781, "ViewRequirementAgentConnector_ms": 0.13384222984313965}, "num_episodes": 20, "episode_return_max": 439.0, "episode_return_min": 239.0, "episode_return_mean": 323.7}, "episode_reward_max": 439.0, "episode_reward_min": 239.0, "episode_reward_mean": 323.7, "episode_len_mean": 100.0, "episodes_this_iter": 20, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [315.0, 287.0, 361.0, 327.0, 378.0, 294.0, 320.0, 324.0, 390.0, 279.0, 300.0, 279.0, 332.0, 345.0, 285.0, 273.0, 251.0, 418.0, 332.0, 301.0, 336.0, 261.0, 309.0, 317.0, 343.0, 315.0, 368.0, 283.0, 395.0, 341.0, 264.0, 274.0, 396.0, 345.0, 326.0, 362.0, 320.0, 400.0, 274.0, 314.0, 271.0, 319.0, 239.0, 354.0, 294.0, 361.0, 349.0, 357.0, 263.0, 347.0, 305.0, 307.0, 324.0, 367.0, 298.0, 267.0, 339.0, 369.0, 302.0, 297.0, 350.0, 439.0, 348.0, 344.0, 263.0, 318.0, 376.0, 363.0, 348.0, 309.0, 317.0, 291.0, 299.0, 285.0, 320.0, 319.0, 275.0, 406.0, 411.0, 280.0, 290.0, 294.0, 384.0, 308.0, 317.0, 433.0, 362.0, 296.0, 358.0, 258.0, 331.0, 284.0, 240.0, 322.0, 301.0, 340.0, 353.0, 358.0, 318.0, 299.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5123382738395147, "mean_inference_ms": 4.471162149985644, "mean_action_processing_ms": 0.15905487504648363, "mean_env_wait_ms": 0.3058133257466415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04182171821594238, "StateBufferConnector_ms": 0.008969306945800781, "ViewRequirementAgentConnector_ms": 0.13384222984313965}, "num_episodes": 20, "episode_return_max": 439.0, "episode_return_min": 239.0, "episode_return_mean": 323.7, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20400, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20400, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 193.35166514277208, "num_env_steps_trained_throughput_per_sec": 198.3094001464329, "timesteps_total": 20400, "num_env_steps_sampled_lifetime": 20400, "num_agent_steps_sampled_lifetime": 20400, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 20400, "timers": {"training_iteration_time_ms": 10153.698, "restore_workers_time_ms": 0.0, "training_step_time_ms": 248.469, "sample_time_ms": 246.76, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 20400, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20400, "num_agent_steps_trained": 20000, "num_training_step_calls_since_last_synch_worker_weights": 408, "num_samples_added_to_queue": 20000}, "done": false, "episodes_total": 204, "training_iteration": 11, "trial_id": "default", "date": "2024-05-19_19-06-55", "timestamp": 1716170815, "time_this_iter_s": 10.085250616073608, "time_total_s": 111.6583604812622, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 111.6583604812622, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 5.506666666666667, "ram_util_percent": 88.17999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0, "total_loss": 1177116.625, "policy_loss": 82731.46875, "entropy": 2.0794289112091064, "entropy_coeff": 0.01, "var_gnorm": 64.00000762939453, "vf_loss": 2188791.0, "vf_explained_var": -8.344650268554688e-06}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 22300, "num_env_steps_trained": 22000, "num_agent_steps_sampled": 22300, "num_agent_steps_trained": 22000, "num_training_step_calls_since_last_synch_worker_weights": 446, "num_samples_added_to_queue": 22000, "learner_queue": {"size_count": 44, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 88.977, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2584.541, "learner_dequeue_time_ms": 98076.955}}, "sampler_results": {"episode_reward_max": 439.0, "episode_reward_min": 239.0, "episode_reward_mean": 326.38, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [301.0, 336.0, 261.0, 309.0, 317.0, 343.0, 315.0, 368.0, 283.0, 395.0, 341.0, 264.0, 274.0, 396.0, 345.0, 326.0, 362.0, 320.0, 400.0, 274.0, 314.0, 271.0, 319.0, 239.0, 354.0, 294.0, 361.0, 349.0, 357.0, 263.0, 347.0, 305.0, 307.0, 324.0, 367.0, 298.0, 267.0, 339.0, 369.0, 302.0, 297.0, 350.0, 439.0, 348.0, 344.0, 263.0, 318.0, 376.0, 363.0, 348.0, 309.0, 317.0, 291.0, 299.0, 285.0, 320.0, 319.0, 275.0, 406.0, 411.0, 280.0, 290.0, 294.0, 384.0, 308.0, 317.0, 433.0, 362.0, 296.0, 358.0, 258.0, 331.0, 284.0, 240.0, 322.0, 301.0, 340.0, 353.0, 358.0, 318.0, 299.0, 316.0, 256.0, 277.0, 381.0, 413.0, 317.0, 291.0, 370.0, 311.0, 400.0, 288.0, 397.0, 433.0, 304.0, 304.0, 277.0, 376.0, 309.0, 338.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5126915142032928, "mean_inference_ms": 4.467709798470887, "mean_action_processing_ms": 0.15679186368067, "mean_env_wait_ms": 0.30495976522893836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02931952476501465, "StateBufferConnector_ms": 0.008969306945800781, "ViewRequirementAgentConnector_ms": 0.14825654029846191}, "num_episodes": 19, "episode_return_max": 439.0, "episode_return_min": 239.0, "episode_return_mean": 326.38}, "env_runner_results": {"episode_reward_max": 439.0, "episode_reward_min": 239.0, "episode_reward_mean": 326.38, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [301.0, 336.0, 261.0, 309.0, 317.0, 343.0, 315.0, 368.0, 283.0, 395.0, 341.0, 264.0, 274.0, 396.0, 345.0, 326.0, 362.0, 320.0, 400.0, 274.0, 314.0, 271.0, 319.0, 239.0, 354.0, 294.0, 361.0, 349.0, 357.0, 263.0, 347.0, 305.0, 307.0, 324.0, 367.0, 298.0, 267.0, 339.0, 369.0, 302.0, 297.0, 350.0, 439.0, 348.0, 344.0, 263.0, 318.0, 376.0, 363.0, 348.0, 309.0, 317.0, 291.0, 299.0, 285.0, 320.0, 319.0, 275.0, 406.0, 411.0, 280.0, 290.0, 294.0, 384.0, 308.0, 317.0, 433.0, 362.0, 296.0, 358.0, 258.0, 331.0, 284.0, 240.0, 322.0, 301.0, 340.0, 353.0, 358.0, 318.0, 299.0, 316.0, 256.0, 277.0, 381.0, 413.0, 317.0, 291.0, 370.0, 311.0, 400.0, 288.0, 397.0, 433.0, 304.0, 304.0, 277.0, 376.0, 309.0, 338.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5126915142032928, "mean_inference_ms": 4.467709798470887, "mean_action_processing_ms": 0.15679186368067, "mean_env_wait_ms": 0.30495976522893836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02931952476501465, "StateBufferConnector_ms": 0.008969306945800781, "ViewRequirementAgentConnector_ms": 0.14825654029846191}, "num_episodes": 19, "episode_return_max": 439.0, "episode_return_min": 239.0, "episode_return_mean": 326.38}, "episode_reward_max": 439.0, "episode_reward_min": 239.0, "episode_reward_mean": 326.38, "episode_len_mean": 100.0, "episodes_this_iter": 19, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [301.0, 336.0, 261.0, 309.0, 317.0, 343.0, 315.0, 368.0, 283.0, 395.0, 341.0, 264.0, 274.0, 396.0, 345.0, 326.0, 362.0, 320.0, 400.0, 274.0, 314.0, 271.0, 319.0, 239.0, 354.0, 294.0, 361.0, 349.0, 357.0, 263.0, 347.0, 305.0, 307.0, 324.0, 367.0, 298.0, 267.0, 339.0, 369.0, 302.0, 297.0, 350.0, 439.0, 348.0, 344.0, 263.0, 318.0, 376.0, 363.0, 348.0, 309.0, 317.0, 291.0, 299.0, 285.0, 320.0, 319.0, 275.0, 406.0, 411.0, 280.0, 290.0, 294.0, 384.0, 308.0, 317.0, 433.0, 362.0, 296.0, 358.0, 258.0, 331.0, 284.0, 240.0, 322.0, 301.0, 340.0, 353.0, 358.0, 318.0, 299.0, 316.0, 256.0, 277.0, 381.0, 413.0, 317.0, 291.0, 370.0, 311.0, 400.0, 288.0, 397.0, 433.0, 304.0, 304.0, 277.0, 376.0, 309.0, 338.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5126915142032928, "mean_inference_ms": 4.467709798470887, "mean_action_processing_ms": 0.15679186368067, "mean_env_wait_ms": 0.30495976522893836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02931952476501465, "StateBufferConnector_ms": 0.008969306945800781, "ViewRequirementAgentConnector_ms": 0.14825654029846191}, "num_episodes": 19, "episode_return_max": 439.0, "episode_return_min": 239.0, "episode_return_mean": 326.38, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22300, "num_agent_steps_trained": 22000, "num_env_steps_sampled": 22300, "num_env_steps_trained": 22000, "num_env_steps_sampled_this_iter": 1900, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 186.61489368164246, "num_env_steps_trained_throughput_per_sec": 196.4367301912026, "timesteps_total": 22300, "num_env_steps_sampled_lifetime": 22300, "num_agent_steps_sampled_lifetime": 22300, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 22300, "timers": {"training_iteration_time_ms": 10144.772, "restore_workers_time_ms": 0.0, "training_step_time_ms": 255.944, "sample_time_ms": 255.418, "synch_weights_time_ms": 0.108}, "counters": {"num_env_steps_sampled": 22300, "num_env_steps_trained": 22000, "num_agent_steps_sampled": 22300, "num_agent_steps_trained": 22000, "num_training_step_calls_since_last_synch_worker_weights": 446, "num_samples_added_to_queue": 22000}, "done": false, "episodes_total": 223, "training_iteration": 12, "trial_id": "default", "date": "2024-05-19_19-07-05", "timestamp": 1716170825, "time_this_iter_s": 10.181395292282104, "time_total_s": 121.83975577354431, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 121.83975577354431, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 5.828571428571428, "ram_util_percent": 88.12857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0, "total_loss": 857556.8125, "policy_loss": 65974.8125, "entropy": 2.07942795753479, "entropy_coeff": 0.01, "var_gnorm": 64.00000762939453, "vf_loss": 1583184.75, "vf_explained_var": -5.364418029785156e-06}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 24150, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24150, "num_agent_steps_trained": 24000, "num_training_step_calls_since_last_synch_worker_weights": 483, "num_samples_added_to_queue": 24000, "learner_queue": {"size_count": 48, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.171, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2569.007, "learner_dequeue_time_ms": 98076.955}}, "sampler_results": {"episode_reward_max": 439.0, "episode_reward_min": 238.0, "episode_reward_mean": 326.83, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, 274.0, 314.0, 271.0, 319.0, 239.0, 354.0, 294.0, 361.0, 349.0, 357.0, 263.0, 347.0, 305.0, 307.0, 324.0, 367.0, 298.0, 267.0, 339.0, 369.0, 302.0, 297.0, 350.0, 439.0, 348.0, 344.0, 263.0, 318.0, 376.0, 363.0, 348.0, 309.0, 317.0, 291.0, 299.0, 285.0, 320.0, 319.0, 275.0, 406.0, 411.0, 280.0, 290.0, 294.0, 384.0, 308.0, 317.0, 433.0, 362.0, 296.0, 358.0, 258.0, 331.0, 284.0, 240.0, 322.0, 301.0, 340.0, 353.0, 358.0, 318.0, 299.0, 316.0, 256.0, 277.0, 381.0, 413.0, 317.0, 291.0, 370.0, 311.0, 400.0, 288.0, 397.0, 433.0, 304.0, 304.0, 277.0, 376.0, 309.0, 338.0, 336.0, 373.0, 334.0, 238.0, 352.0, 329.0, 344.0, 332.0, 345.0, 338.0, 349.0, 385.0, 278.0, 308.0, 284.0, 316.0, 324.0, 336.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5130527743244284, "mean_inference_ms": 4.4663822472173775, "mean_action_processing_ms": 0.15438065114557595, "mean_env_wait_ms": 0.3054595541681252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059682607650756836, "StateBufferConnector_ms": 0.0020589828491210938, "ViewRequirementAgentConnector_ms": 0.1448814868927002}, "num_episodes": 18, "episode_return_max": 439.0, "episode_return_min": 238.0, "episode_return_mean": 326.83}, "env_runner_results": {"episode_reward_max": 439.0, "episode_reward_min": 238.0, "episode_reward_mean": 326.83, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, 274.0, 314.0, 271.0, 319.0, 239.0, 354.0, 294.0, 361.0, 349.0, 357.0, 263.0, 347.0, 305.0, 307.0, 324.0, 367.0, 298.0, 267.0, 339.0, 369.0, 302.0, 297.0, 350.0, 439.0, 348.0, 344.0, 263.0, 318.0, 376.0, 363.0, 348.0, 309.0, 317.0, 291.0, 299.0, 285.0, 320.0, 319.0, 275.0, 406.0, 411.0, 280.0, 290.0, 294.0, 384.0, 308.0, 317.0, 433.0, 362.0, 296.0, 358.0, 258.0, 331.0, 284.0, 240.0, 322.0, 301.0, 340.0, 353.0, 358.0, 318.0, 299.0, 316.0, 256.0, 277.0, 381.0, 413.0, 317.0, 291.0, 370.0, 311.0, 400.0, 288.0, 397.0, 433.0, 304.0, 304.0, 277.0, 376.0, 309.0, 338.0, 336.0, 373.0, 334.0, 238.0, 352.0, 329.0, 344.0, 332.0, 345.0, 338.0, 349.0, 385.0, 278.0, 308.0, 284.0, 316.0, 324.0, 336.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5130527743244284, "mean_inference_ms": 4.4663822472173775, "mean_action_processing_ms": 0.15438065114557595, "mean_env_wait_ms": 0.3054595541681252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059682607650756836, "StateBufferConnector_ms": 0.0020589828491210938, "ViewRequirementAgentConnector_ms": 0.1448814868927002}, "num_episodes": 18, "episode_return_max": 439.0, "episode_return_min": 238.0, "episode_return_mean": 326.83}, "episode_reward_max": 439.0, "episode_reward_min": 238.0, "episode_reward_mean": 326.83, "episode_len_mean": 100.0, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [400.0, 274.0, 314.0, 271.0, 319.0, 239.0, 354.0, 294.0, 361.0, 349.0, 357.0, 263.0, 347.0, 305.0, 307.0, 324.0, 367.0, 298.0, 267.0, 339.0, 369.0, 302.0, 297.0, 350.0, 439.0, 348.0, 344.0, 263.0, 318.0, 376.0, 363.0, 348.0, 309.0, 317.0, 291.0, 299.0, 285.0, 320.0, 319.0, 275.0, 406.0, 411.0, 280.0, 290.0, 294.0, 384.0, 308.0, 317.0, 433.0, 362.0, 296.0, 358.0, 258.0, 331.0, 284.0, 240.0, 322.0, 301.0, 340.0, 353.0, 358.0, 318.0, 299.0, 316.0, 256.0, 277.0, 381.0, 413.0, 317.0, 291.0, 370.0, 311.0, 400.0, 288.0, 397.0, 433.0, 304.0, 304.0, 277.0, 376.0, 309.0, 338.0, 336.0, 373.0, 334.0, 238.0, 352.0, 329.0, 344.0, 332.0, 345.0, 338.0, 349.0, 385.0, 278.0, 308.0, 284.0, 316.0, 324.0, 336.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5130527743244284, "mean_inference_ms": 4.4663822472173775, "mean_action_processing_ms": 0.15438065114557595, "mean_env_wait_ms": 0.3054595541681252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059682607650756836, "StateBufferConnector_ms": 0.0020589828491210938, "ViewRequirementAgentConnector_ms": 0.1448814868927002}, "num_episodes": 18, "episode_return_max": 439.0, "episode_return_min": 238.0, "episode_return_mean": 326.83, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24150, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24150, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 1850, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 182.28675359355896, "num_env_steps_trained_throughput_per_sec": 197.06676064168536, "timesteps_total": 24150, "num_env_steps_sampled_lifetime": 24150, "num_agent_steps_sampled_lifetime": 24150, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 24150, "timers": {"training_iteration_time_ms": 10152.399, "restore_workers_time_ms": 0.0, "training_step_time_ms": 287.687, "sample_time_ms": 287.269, "synch_weights_time_ms": 0.083}, "counters": {"num_env_steps_sampled": 24150, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24150, "num_agent_steps_trained": 24000, "num_training_step_calls_since_last_synch_worker_weights": 483, "num_samples_added_to_queue": 24000}, "done": false, "episodes_total": 241, "training_iteration": 13, "trial_id": "default", "date": "2024-05-19_19-07-15", "timestamp": 1716170835, "time_this_iter_s": 10.149392366409302, "time_total_s": 131.9891481399536, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 131.9891481399536, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 5.985714285714287, "ram_util_percent": 88.67142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0, "total_loss": 923302.5, "policy_loss": 67948.5859375, "entropy": 2.0794286727905273, "entropy_coeff": 0.01, "var_gnorm": 64.00000762939453, "vf_loss": 1710728.625, "vf_explained_var": 1.817941665649414e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 26200, "num_env_steps_trained": 26000, "num_agent_steps_sampled": 26200, "num_agent_steps_trained": 26000, "num_training_step_calls_since_last_synch_worker_weights": 524, "num_samples_added_to_queue": 26000, "learner_queue": {"size_count": 52, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 89.82, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2549.345, "learner_dequeue_time_ms": 84328.709}}, "sampler_results": {"episode_reward_max": 439.0, "episode_reward_min": 238.0, "episode_reward_mean": 329.53, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.0, 297.0, 350.0, 439.0, 348.0, 344.0, 263.0, 318.0, 376.0, 363.0, 348.0, 309.0, 317.0, 291.0, 299.0, 285.0, 320.0, 319.0, 275.0, 406.0, 411.0, 280.0, 290.0, 294.0, 384.0, 308.0, 317.0, 433.0, 362.0, 296.0, 358.0, 258.0, 331.0, 284.0, 240.0, 322.0, 301.0, 340.0, 353.0, 358.0, 318.0, 299.0, 316.0, 256.0, 277.0, 381.0, 413.0, 317.0, 291.0, 370.0, 311.0, 400.0, 288.0, 397.0, 433.0, 304.0, 304.0, 277.0, 376.0, 309.0, 338.0, 336.0, 373.0, 334.0, 238.0, 352.0, 329.0, 344.0, 332.0, 345.0, 338.0, 349.0, 385.0, 278.0, 308.0, 284.0, 316.0, 324.0, 336.0, 340.0, 340.0, 328.0, 268.0, 334.0, 370.0, 395.0, 282.0, 370.0, 432.0, 329.0, 319.0, 348.0, 371.0, 255.0, 266.0, 354.0, 344.0, 324.0, 333.0, 286.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5112375966434779, "mean_inference_ms": 4.456102544128759, "mean_action_processing_ms": 0.15129803201892644, "mean_env_wait_ms": 0.3060079671802553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06127023696899414, "StateBufferConnector_ms": 0.0010552406311035156, "ViewRequirementAgentConnector_ms": 0.13593435287475586}, "num_episodes": 21, "episode_return_max": 439.0, "episode_return_min": 238.0, "episode_return_mean": 329.53}, "env_runner_results": {"episode_reward_max": 439.0, "episode_reward_min": 238.0, "episode_reward_mean": 329.53, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.0, 297.0, 350.0, 439.0, 348.0, 344.0, 263.0, 318.0, 376.0, 363.0, 348.0, 309.0, 317.0, 291.0, 299.0, 285.0, 320.0, 319.0, 275.0, 406.0, 411.0, 280.0, 290.0, 294.0, 384.0, 308.0, 317.0, 433.0, 362.0, 296.0, 358.0, 258.0, 331.0, 284.0, 240.0, 322.0, 301.0, 340.0, 353.0, 358.0, 318.0, 299.0, 316.0, 256.0, 277.0, 381.0, 413.0, 317.0, 291.0, 370.0, 311.0, 400.0, 288.0, 397.0, 433.0, 304.0, 304.0, 277.0, 376.0, 309.0, 338.0, 336.0, 373.0, 334.0, 238.0, 352.0, 329.0, 344.0, 332.0, 345.0, 338.0, 349.0, 385.0, 278.0, 308.0, 284.0, 316.0, 324.0, 336.0, 340.0, 340.0, 328.0, 268.0, 334.0, 370.0, 395.0, 282.0, 370.0, 432.0, 329.0, 319.0, 348.0, 371.0, 255.0, 266.0, 354.0, 344.0, 324.0, 333.0, 286.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5112375966434779, "mean_inference_ms": 4.456102544128759, "mean_action_processing_ms": 0.15129803201892644, "mean_env_wait_ms": 0.3060079671802553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06127023696899414, "StateBufferConnector_ms": 0.0010552406311035156, "ViewRequirementAgentConnector_ms": 0.13593435287475586}, "num_episodes": 21, "episode_return_max": 439.0, "episode_return_min": 238.0, "episode_return_mean": 329.53}, "episode_reward_max": 439.0, "episode_reward_min": 238.0, "episode_reward_mean": 329.53, "episode_len_mean": 100.0, "episodes_this_iter": 21, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [302.0, 297.0, 350.0, 439.0, 348.0, 344.0, 263.0, 318.0, 376.0, 363.0, 348.0, 309.0, 317.0, 291.0, 299.0, 285.0, 320.0, 319.0, 275.0, 406.0, 411.0, 280.0, 290.0, 294.0, 384.0, 308.0, 317.0, 433.0, 362.0, 296.0, 358.0, 258.0, 331.0, 284.0, 240.0, 322.0, 301.0, 340.0, 353.0, 358.0, 318.0, 299.0, 316.0, 256.0, 277.0, 381.0, 413.0, 317.0, 291.0, 370.0, 311.0, 400.0, 288.0, 397.0, 433.0, 304.0, 304.0, 277.0, 376.0, 309.0, 338.0, 336.0, 373.0, 334.0, 238.0, 352.0, 329.0, 344.0, 332.0, 345.0, 338.0, 349.0, 385.0, 278.0, 308.0, 284.0, 316.0, 324.0, 336.0, 340.0, 340.0, 328.0, 268.0, 334.0, 370.0, 395.0, 282.0, 370.0, 432.0, 329.0, 319.0, 348.0, 371.0, 255.0, 266.0, 354.0, 344.0, 324.0, 333.0, 286.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5112375966434779, "mean_inference_ms": 4.456102544128759, "mean_action_processing_ms": 0.15129803201892644, "mean_env_wait_ms": 0.3060079671802553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06127023696899414, "StateBufferConnector_ms": 0.0010552406311035156, "ViewRequirementAgentConnector_ms": 0.13593435287475586}, "num_episodes": 21, "episode_return_max": 439.0, "episode_return_min": 238.0, "episode_return_mean": 329.53, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26200, "num_agent_steps_trained": 26000, "num_env_steps_sampled": 26200, "num_env_steps_trained": 26000, "num_env_steps_sampled_this_iter": 2050, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 200.71027477763093, "num_env_steps_trained_throughput_per_sec": 195.81490222207896, "timesteps_total": 26200, "num_env_steps_sampled_lifetime": 26200, "num_agent_steps_sampled_lifetime": 26200, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 26200, "timers": {"training_iteration_time_ms": 10149.37, "restore_workers_time_ms": 0.0, "training_step_time_ms": 270.953, "sample_time_ms": 270.013, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 26200, "num_env_steps_trained": 26000, "num_agent_steps_sampled": 26200, "num_agent_steps_trained": 26000, "num_training_step_calls_since_last_synch_worker_weights": 524, "num_samples_added_to_queue": 26000}, "done": false, "episodes_total": 262, "training_iteration": 14, "trial_id": "default", "date": "2024-05-19_19-07-25", "timestamp": 1716170845, "time_this_iter_s": 10.213727235794067, "time_total_s": 142.20287537574768, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 142.20287537574768, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 5.726666666666668, "ram_util_percent": 88.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0, "total_loss": 1202781.875, "policy_loss": 83326.3203125, "entropy": 2.0794284343719482, "entropy_coeff": 0.01, "var_gnorm": 64.00000762939453, "vf_loss": 2238932.0, "vf_explained_var": 7.808208465576172e-06}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 28100, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28100, "num_agent_steps_trained": 28000, "num_training_step_calls_since_last_synch_worker_weights": 562, "num_samples_added_to_queue": 28000, "learner_queue": {"size_count": 56, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 97.069, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2537.641, "learner_dequeue_time_ms": 84328.709}}, "sampler_results": {"episode_reward_max": 433.0, "episode_reward_min": 236.0, "episode_reward_mean": 331.88, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [406.0, 411.0, 280.0, 290.0, 294.0, 384.0, 308.0, 317.0, 433.0, 362.0, 296.0, 358.0, 258.0, 331.0, 284.0, 240.0, 322.0, 301.0, 340.0, 353.0, 358.0, 318.0, 299.0, 316.0, 256.0, 277.0, 381.0, 413.0, 317.0, 291.0, 370.0, 311.0, 400.0, 288.0, 397.0, 433.0, 304.0, 304.0, 277.0, 376.0, 309.0, 338.0, 336.0, 373.0, 334.0, 238.0, 352.0, 329.0, 344.0, 332.0, 345.0, 338.0, 349.0, 385.0, 278.0, 308.0, 284.0, 316.0, 324.0, 336.0, 340.0, 340.0, 328.0, 268.0, 334.0, 370.0, 395.0, 282.0, 370.0, 432.0, 329.0, 319.0, 348.0, 371.0, 255.0, 266.0, 354.0, 344.0, 324.0, 333.0, 286.0, 365.0, 355.0, 337.0, 362.0, 236.0, 265.0, 298.0, 316.0, 408.0, 297.0, 401.0, 327.0, 401.0, 393.0, 338.0, 311.0, 339.0, 333.0, 316.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5092310400638135, "mean_inference_ms": 4.442954879321762, "mean_action_processing_ms": 0.14919987520487304, "mean_env_wait_ms": 0.3055682722044005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05310201644897461, "StateBufferConnector_ms": 5.1021575927734375e-05, "ViewRequirementAgentConnector_ms": 0.12690448760986328}, "num_episodes": 19, "episode_return_max": 433.0, "episode_return_min": 236.0, "episode_return_mean": 331.88}, "env_runner_results": {"episode_reward_max": 433.0, "episode_reward_min": 236.0, "episode_reward_mean": 331.88, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [406.0, 411.0, 280.0, 290.0, 294.0, 384.0, 308.0, 317.0, 433.0, 362.0, 296.0, 358.0, 258.0, 331.0, 284.0, 240.0, 322.0, 301.0, 340.0, 353.0, 358.0, 318.0, 299.0, 316.0, 256.0, 277.0, 381.0, 413.0, 317.0, 291.0, 370.0, 311.0, 400.0, 288.0, 397.0, 433.0, 304.0, 304.0, 277.0, 376.0, 309.0, 338.0, 336.0, 373.0, 334.0, 238.0, 352.0, 329.0, 344.0, 332.0, 345.0, 338.0, 349.0, 385.0, 278.0, 308.0, 284.0, 316.0, 324.0, 336.0, 340.0, 340.0, 328.0, 268.0, 334.0, 370.0, 395.0, 282.0, 370.0, 432.0, 329.0, 319.0, 348.0, 371.0, 255.0, 266.0, 354.0, 344.0, 324.0, 333.0, 286.0, 365.0, 355.0, 337.0, 362.0, 236.0, 265.0, 298.0, 316.0, 408.0, 297.0, 401.0, 327.0, 401.0, 393.0, 338.0, 311.0, 339.0, 333.0, 316.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5092310400638135, "mean_inference_ms": 4.442954879321762, "mean_action_processing_ms": 0.14919987520487304, "mean_env_wait_ms": 0.3055682722044005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05310201644897461, "StateBufferConnector_ms": 5.1021575927734375e-05, "ViewRequirementAgentConnector_ms": 0.12690448760986328}, "num_episodes": 19, "episode_return_max": 433.0, "episode_return_min": 236.0, "episode_return_mean": 331.88}, "episode_reward_max": 433.0, "episode_reward_min": 236.0, "episode_reward_mean": 331.88, "episode_len_mean": 100.0, "episodes_this_iter": 19, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [406.0, 411.0, 280.0, 290.0, 294.0, 384.0, 308.0, 317.0, 433.0, 362.0, 296.0, 358.0, 258.0, 331.0, 284.0, 240.0, 322.0, 301.0, 340.0, 353.0, 358.0, 318.0, 299.0, 316.0, 256.0, 277.0, 381.0, 413.0, 317.0, 291.0, 370.0, 311.0, 400.0, 288.0, 397.0, 433.0, 304.0, 304.0, 277.0, 376.0, 309.0, 338.0, 336.0, 373.0, 334.0, 238.0, 352.0, 329.0, 344.0, 332.0, 345.0, 338.0, 349.0, 385.0, 278.0, 308.0, 284.0, 316.0, 324.0, 336.0, 340.0, 340.0, 328.0, 268.0, 334.0, 370.0, 395.0, 282.0, 370.0, 432.0, 329.0, 319.0, 348.0, 371.0, 255.0, 266.0, 354.0, 344.0, 324.0, 333.0, 286.0, 365.0, 355.0, 337.0, 362.0, 236.0, 265.0, 298.0, 316.0, 408.0, 297.0, 401.0, 327.0, 401.0, 393.0, 338.0, 311.0, 339.0, 333.0, 316.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5092310400638135, "mean_inference_ms": 4.442954879321762, "mean_action_processing_ms": 0.14919987520487304, "mean_env_wait_ms": 0.3055682722044005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05310201644897461, "StateBufferConnector_ms": 5.1021575927734375e-05, "ViewRequirementAgentConnector_ms": 0.12690448760986328}, "num_episodes": 19, "episode_return_max": 433.0, "episode_return_min": 236.0, "episode_return_mean": 331.88, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28100, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28100, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 1900, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 189.45634847323433, "num_env_steps_trained_throughput_per_sec": 199.42773523498352, "timesteps_total": 28100, "num_env_steps_sampled_lifetime": 28100, "num_agent_steps_sampled_lifetime": 28100, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 28100, "timers": {"training_iteration_time_ms": 10134.45, "restore_workers_time_ms": 0.0, "training_step_time_ms": 266.551, "sample_time_ms": 265.556, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 28100, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28100, "num_agent_steps_trained": 28000, "num_training_step_calls_since_last_synch_worker_weights": 562, "num_samples_added_to_queue": 28000}, "done": false, "episodes_total": 281, "training_iteration": 15, "trial_id": "default", "date": "2024-05-19_19-07-35", "timestamp": 1716170855, "time_this_iter_s": 10.035732746124268, "time_total_s": 152.23860812187195, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 152.23860812187195, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 6.092857142857142, "ram_util_percent": 88.60714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0, "total_loss": 949933.1875, "policy_loss": 69731.859375, "entropy": 2.079427719116211, "entropy_coeff": 0.01, "var_gnorm": 64.00000762939453, "vf_loss": 1760423.5, "vf_explained_var": 3.5762786865234375e-06}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 30000, "num_env_steps_trained": 29500, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 29500, "num_training_step_calls_since_last_synch_worker_weights": 600, "num_samples_added_to_queue": 30000, "learner_queue": {"size_count": 59, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 93.717, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2506.861, "learner_dequeue_time_ms": 84328.709}}, "sampler_results": {"episode_reward_max": 433.0, "episode_reward_min": 194.0, "episode_reward_mean": 332.09, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [353.0, 358.0, 318.0, 299.0, 316.0, 256.0, 277.0, 381.0, 413.0, 317.0, 291.0, 370.0, 311.0, 400.0, 288.0, 397.0, 433.0, 304.0, 304.0, 277.0, 376.0, 309.0, 338.0, 336.0, 373.0, 334.0, 238.0, 352.0, 329.0, 344.0, 332.0, 345.0, 338.0, 349.0, 385.0, 278.0, 308.0, 284.0, 316.0, 324.0, 336.0, 340.0, 340.0, 328.0, 268.0, 334.0, 370.0, 395.0, 282.0, 370.0, 432.0, 329.0, 319.0, 348.0, 371.0, 255.0, 266.0, 354.0, 344.0, 324.0, 333.0, 286.0, 365.0, 355.0, 337.0, 362.0, 236.0, 265.0, 298.0, 316.0, 408.0, 297.0, 401.0, 327.0, 401.0, 393.0, 338.0, 311.0, 339.0, 333.0, 316.0, 411.0, 306.0, 343.0, 341.0, 358.0, 329.0, 316.0, 292.0, 308.0, 375.0, 194.0, 350.0, 290.0, 241.0, 411.0, 337.0, 364.0, 327.0, 343.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5082356373657513, "mean_inference_ms": 4.432596294981864, "mean_action_processing_ms": 0.14846745537757713, "mean_env_wait_ms": 0.3058265493162776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06356239318847656, "StateBufferConnector_ms": 5.1021575927734375e-05, "ViewRequirementAgentConnector_ms": 0.16815543174743652}, "num_episodes": 19, "episode_return_max": 433.0, "episode_return_min": 194.0, "episode_return_mean": 332.09}, "env_runner_results": {"episode_reward_max": 433.0, "episode_reward_min": 194.0, "episode_reward_mean": 332.09, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [353.0, 358.0, 318.0, 299.0, 316.0, 256.0, 277.0, 381.0, 413.0, 317.0, 291.0, 370.0, 311.0, 400.0, 288.0, 397.0, 433.0, 304.0, 304.0, 277.0, 376.0, 309.0, 338.0, 336.0, 373.0, 334.0, 238.0, 352.0, 329.0, 344.0, 332.0, 345.0, 338.0, 349.0, 385.0, 278.0, 308.0, 284.0, 316.0, 324.0, 336.0, 340.0, 340.0, 328.0, 268.0, 334.0, 370.0, 395.0, 282.0, 370.0, 432.0, 329.0, 319.0, 348.0, 371.0, 255.0, 266.0, 354.0, 344.0, 324.0, 333.0, 286.0, 365.0, 355.0, 337.0, 362.0, 236.0, 265.0, 298.0, 316.0, 408.0, 297.0, 401.0, 327.0, 401.0, 393.0, 338.0, 311.0, 339.0, 333.0, 316.0, 411.0, 306.0, 343.0, 341.0, 358.0, 329.0, 316.0, 292.0, 308.0, 375.0, 194.0, 350.0, 290.0, 241.0, 411.0, 337.0, 364.0, 327.0, 343.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5082356373657513, "mean_inference_ms": 4.432596294981864, "mean_action_processing_ms": 0.14846745537757713, "mean_env_wait_ms": 0.3058265493162776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06356239318847656, "StateBufferConnector_ms": 5.1021575927734375e-05, "ViewRequirementAgentConnector_ms": 0.16815543174743652}, "num_episodes": 19, "episode_return_max": 433.0, "episode_return_min": 194.0, "episode_return_mean": 332.09}, "episode_reward_max": 433.0, "episode_reward_min": 194.0, "episode_reward_mean": 332.09, "episode_len_mean": 100.0, "episodes_this_iter": 19, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [353.0, 358.0, 318.0, 299.0, 316.0, 256.0, 277.0, 381.0, 413.0, 317.0, 291.0, 370.0, 311.0, 400.0, 288.0, 397.0, 433.0, 304.0, 304.0, 277.0, 376.0, 309.0, 338.0, 336.0, 373.0, 334.0, 238.0, 352.0, 329.0, 344.0, 332.0, 345.0, 338.0, 349.0, 385.0, 278.0, 308.0, 284.0, 316.0, 324.0, 336.0, 340.0, 340.0, 328.0, 268.0, 334.0, 370.0, 395.0, 282.0, 370.0, 432.0, 329.0, 319.0, 348.0, 371.0, 255.0, 266.0, 354.0, 344.0, 324.0, 333.0, 286.0, 365.0, 355.0, 337.0, 362.0, 236.0, 265.0, 298.0, 316.0, 408.0, 297.0, 401.0, 327.0, 401.0, 393.0, 338.0, 311.0, 339.0, 333.0, 316.0, 411.0, 306.0, 343.0, 341.0, 358.0, 329.0, 316.0, 292.0, 308.0, 375.0, 194.0, 350.0, 290.0, 241.0, 411.0, 337.0, 364.0, 327.0, 343.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5082356373657513, "mean_inference_ms": 4.432596294981864, "mean_action_processing_ms": 0.14846745537757713, "mean_env_wait_ms": 0.3058265493162776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06356239318847656, "StateBufferConnector_ms": 5.1021575927734375e-05, "ViewRequirementAgentConnector_ms": 0.16815543174743652}, "num_episodes": 19, "episode_return_max": 433.0, "episode_return_min": 194.0, "episode_return_mean": 332.09, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 29500, "num_env_steps_sampled": 30000, "num_env_steps_trained": 29500, "num_env_steps_sampled_this_iter": 1900, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 184.44599654293552, "num_env_steps_trained_throughput_per_sec": 145.61526042863332, "timesteps_total": 30000, "num_env_steps_sampled_lifetime": 30000, "num_agent_steps_sampled_lifetime": 30000, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 30000, "timers": {"training_iteration_time_ms": 10147.209, "restore_workers_time_ms": 0.0, "training_step_time_ms": 271.627, "sample_time_ms": 269.748, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 30000, "num_env_steps_trained": 29500, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 29500, "num_training_step_calls_since_last_synch_worker_weights": 600, "num_samples_added_to_queue": 30000}, "done": false, "episodes_total": 300, "training_iteration": 16, "trial_id": "default", "date": "2024-05-19_19-07-46", "timestamp": 1716170866, "time_this_iter_s": 10.30111813545227, "time_total_s": 162.53972625732422, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 162.53972625732422, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 5.380000000000001, "ram_util_percent": 87.79333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0, "total_loss": 1092852.25, "policy_loss": 78846.2734375, "entropy": 2.0794291496276855, "entropy_coeff": 0.01, "var_gnorm": 64.00000762939453, "vf_loss": 2028032.875, "vf_explained_var": -7.152557373046875e-07}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 31800, "num_env_steps_trained": 31500, "num_agent_steps_sampled": 31800, "num_agent_steps_trained": 31500, "num_training_step_calls_since_last_synch_worker_weights": 636, "num_samples_added_to_queue": 31500, "learner_queue": {"size_count": 63, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 103.266, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2633.731, "learner_dequeue_time_ms": 84328.709}}, "sampler_results": {"episode_reward_max": 432.0, "episode_reward_min": 194.0, "episode_reward_mean": 333.21, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [304.0, 277.0, 376.0, 309.0, 338.0, 336.0, 373.0, 334.0, 238.0, 352.0, 329.0, 344.0, 332.0, 345.0, 338.0, 349.0, 385.0, 278.0, 308.0, 284.0, 316.0, 324.0, 336.0, 340.0, 340.0, 328.0, 268.0, 334.0, 370.0, 395.0, 282.0, 370.0, 432.0, 329.0, 319.0, 348.0, 371.0, 255.0, 266.0, 354.0, 344.0, 324.0, 333.0, 286.0, 365.0, 355.0, 337.0, 362.0, 236.0, 265.0, 298.0, 316.0, 408.0, 297.0, 401.0, 327.0, 401.0, 393.0, 338.0, 311.0, 339.0, 333.0, 316.0, 411.0, 306.0, 343.0, 341.0, 358.0, 329.0, 316.0, 292.0, 308.0, 375.0, 194.0, 350.0, 290.0, 241.0, 411.0, 337.0, 364.0, 327.0, 343.0, 371.0, 420.0, 339.0, 314.0, 353.0, 335.0, 398.0, 355.0, 383.0, 338.0, 298.0, 325.0, 403.0, 250.0, 379.0, 339.0, 267.0, 327.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5081460032314677, "mean_inference_ms": 4.424587805199113, "mean_action_processing_ms": 0.14854670517293692, "mean_env_wait_ms": 0.3068260387486442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06572818756103516, "StateBufferConnector_ms": 5.1021575927734375e-05, "ViewRequirementAgentConnector_ms": 0.15114688873291016}, "num_episodes": 18, "episode_return_max": 432.0, "episode_return_min": 194.0, "episode_return_mean": 333.21}, "env_runner_results": {"episode_reward_max": 432.0, "episode_reward_min": 194.0, "episode_reward_mean": 333.21, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [304.0, 277.0, 376.0, 309.0, 338.0, 336.0, 373.0, 334.0, 238.0, 352.0, 329.0, 344.0, 332.0, 345.0, 338.0, 349.0, 385.0, 278.0, 308.0, 284.0, 316.0, 324.0, 336.0, 340.0, 340.0, 328.0, 268.0, 334.0, 370.0, 395.0, 282.0, 370.0, 432.0, 329.0, 319.0, 348.0, 371.0, 255.0, 266.0, 354.0, 344.0, 324.0, 333.0, 286.0, 365.0, 355.0, 337.0, 362.0, 236.0, 265.0, 298.0, 316.0, 408.0, 297.0, 401.0, 327.0, 401.0, 393.0, 338.0, 311.0, 339.0, 333.0, 316.0, 411.0, 306.0, 343.0, 341.0, 358.0, 329.0, 316.0, 292.0, 308.0, 375.0, 194.0, 350.0, 290.0, 241.0, 411.0, 337.0, 364.0, 327.0, 343.0, 371.0, 420.0, 339.0, 314.0, 353.0, 335.0, 398.0, 355.0, 383.0, 338.0, 298.0, 325.0, 403.0, 250.0, 379.0, 339.0, 267.0, 327.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5081460032314677, "mean_inference_ms": 4.424587805199113, "mean_action_processing_ms": 0.14854670517293692, "mean_env_wait_ms": 0.3068260387486442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06572818756103516, "StateBufferConnector_ms": 5.1021575927734375e-05, "ViewRequirementAgentConnector_ms": 0.15114688873291016}, "num_episodes": 18, "episode_return_max": 432.0, "episode_return_min": 194.0, "episode_return_mean": 333.21}, "episode_reward_max": 432.0, "episode_reward_min": 194.0, "episode_reward_mean": 333.21, "episode_len_mean": 100.0, "episodes_this_iter": 18, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [304.0, 277.0, 376.0, 309.0, 338.0, 336.0, 373.0, 334.0, 238.0, 352.0, 329.0, 344.0, 332.0, 345.0, 338.0, 349.0, 385.0, 278.0, 308.0, 284.0, 316.0, 324.0, 336.0, 340.0, 340.0, 328.0, 268.0, 334.0, 370.0, 395.0, 282.0, 370.0, 432.0, 329.0, 319.0, 348.0, 371.0, 255.0, 266.0, 354.0, 344.0, 324.0, 333.0, 286.0, 365.0, 355.0, 337.0, 362.0, 236.0, 265.0, 298.0, 316.0, 408.0, 297.0, 401.0, 327.0, 401.0, 393.0, 338.0, 311.0, 339.0, 333.0, 316.0, 411.0, 306.0, 343.0, 341.0, 358.0, 329.0, 316.0, 292.0, 308.0, 375.0, 194.0, 350.0, 290.0, 241.0, 411.0, 337.0, 364.0, 327.0, 343.0, 371.0, 420.0, 339.0, 314.0, 353.0, 335.0, 398.0, 355.0, 383.0, 338.0, 298.0, 325.0, 403.0, 250.0, 379.0, 339.0, 267.0, 327.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5081460032314677, "mean_inference_ms": 4.424587805199113, "mean_action_processing_ms": 0.14854670517293692, "mean_env_wait_ms": 0.3068260387486442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06572818756103516, "StateBufferConnector_ms": 5.1021575927734375e-05, "ViewRequirementAgentConnector_ms": 0.15114688873291016}, "num_episodes": 18, "episode_return_max": 432.0, "episode_return_min": 194.0, "episode_return_mean": 333.21, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31800, "num_agent_steps_trained": 31500, "num_env_steps_sampled": 31800, "num_env_steps_trained": 31500, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 179.1321390759215, "num_env_steps_trained_throughput_per_sec": 199.03571008435722, "timesteps_total": 31800, "num_env_steps_sampled_lifetime": 31800, "num_agent_steps_sampled_lifetime": 31800, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 31800, "timers": {"training_iteration_time_ms": 10128.868, "restore_workers_time_ms": 0.0, "training_step_time_ms": 285.672, "sample_time_ms": 284.004, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 31800, "num_env_steps_trained": 31500, "num_agent_steps_sampled": 31800, "num_agent_steps_trained": 31500, "num_training_step_calls_since_last_synch_worker_weights": 636, "num_samples_added_to_queue": 31500}, "done": false, "episodes_total": 318, "training_iteration": 17, "trial_id": "default", "date": "2024-05-19_19-07-56", "timestamp": 1716170876, "time_this_iter_s": 10.048448085784912, "time_total_s": 172.58817434310913, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 172.58817434310913, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 6.035714285714285, "ram_util_percent": 87.48571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0, "total_loss": 987595.875, "policy_loss": 72102.109375, "entropy": 2.0794289112091064, "entropy_coeff": 0.01, "var_gnorm": 64.00000762939453, "vf_loss": 1831008.375, "vf_explained_var": 3.874301910400391e-06}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 33850, "num_env_steps_trained": 33500, "num_agent_steps_sampled": 33850, "num_agent_steps_trained": 33500, "num_training_step_calls_since_last_synch_worker_weights": 677, "num_samples_added_to_queue": 33500, "learner_queue": {"size_count": 67, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.501, "learner_load_time_ms": 0.207, "learner_load_wait_time_ms": 2612.706, "learner_dequeue_time_ms": 76072.139}}, "sampler_results": {"episode_reward_max": 432.0, "episode_reward_min": 194.0, "episode_reward_mean": 331.8, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [316.0, 324.0, 336.0, 340.0, 340.0, 328.0, 268.0, 334.0, 370.0, 395.0, 282.0, 370.0, 432.0, 329.0, 319.0, 348.0, 371.0, 255.0, 266.0, 354.0, 344.0, 324.0, 333.0, 286.0, 365.0, 355.0, 337.0, 362.0, 236.0, 265.0, 298.0, 316.0, 408.0, 297.0, 401.0, 327.0, 401.0, 393.0, 338.0, 311.0, 339.0, 333.0, 316.0, 411.0, 306.0, 343.0, 341.0, 358.0, 329.0, 316.0, 292.0, 308.0, 375.0, 194.0, 350.0, 290.0, 241.0, 411.0, 337.0, 364.0, 327.0, 343.0, 371.0, 420.0, 339.0, 314.0, 353.0, 335.0, 398.0, 355.0, 383.0, 338.0, 298.0, 325.0, 403.0, 250.0, 379.0, 339.0, 267.0, 327.0, 304.0, 301.0, 302.0, 283.0, 251.0, 336.0, 323.0, 268.0, 346.0, 304.0, 345.0, 373.0, 324.0, 312.0, 351.0, 341.0, 260.0, 380.0, 328.0, 356.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.507725638405772, "mean_inference_ms": 4.410824902354167, "mean_action_processing_ms": 0.14861696659368537, "mean_env_wait_ms": 0.3073864514774873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05533146858215332, "StateBufferConnector_ms": 0.0010247230529785156, "ViewRequirementAgentConnector_ms": 0.17232227325439453}, "num_episodes": 20, "episode_return_max": 432.0, "episode_return_min": 194.0, "episode_return_mean": 331.8}, "env_runner_results": {"episode_reward_max": 432.0, "episode_reward_min": 194.0, "episode_reward_mean": 331.8, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [316.0, 324.0, 336.0, 340.0, 340.0, 328.0, 268.0, 334.0, 370.0, 395.0, 282.0, 370.0, 432.0, 329.0, 319.0, 348.0, 371.0, 255.0, 266.0, 354.0, 344.0, 324.0, 333.0, 286.0, 365.0, 355.0, 337.0, 362.0, 236.0, 265.0, 298.0, 316.0, 408.0, 297.0, 401.0, 327.0, 401.0, 393.0, 338.0, 311.0, 339.0, 333.0, 316.0, 411.0, 306.0, 343.0, 341.0, 358.0, 329.0, 316.0, 292.0, 308.0, 375.0, 194.0, 350.0, 290.0, 241.0, 411.0, 337.0, 364.0, 327.0, 343.0, 371.0, 420.0, 339.0, 314.0, 353.0, 335.0, 398.0, 355.0, 383.0, 338.0, 298.0, 325.0, 403.0, 250.0, 379.0, 339.0, 267.0, 327.0, 304.0, 301.0, 302.0, 283.0, 251.0, 336.0, 323.0, 268.0, 346.0, 304.0, 345.0, 373.0, 324.0, 312.0, 351.0, 341.0, 260.0, 380.0, 328.0, 356.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.507725638405772, "mean_inference_ms": 4.410824902354167, "mean_action_processing_ms": 0.14861696659368537, "mean_env_wait_ms": 0.3073864514774873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05533146858215332, "StateBufferConnector_ms": 0.0010247230529785156, "ViewRequirementAgentConnector_ms": 0.17232227325439453}, "num_episodes": 20, "episode_return_max": 432.0, "episode_return_min": 194.0, "episode_return_mean": 331.8}, "episode_reward_max": 432.0, "episode_reward_min": 194.0, "episode_reward_mean": 331.8, "episode_len_mean": 100.0, "episodes_this_iter": 20, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [316.0, 324.0, 336.0, 340.0, 340.0, 328.0, 268.0, 334.0, 370.0, 395.0, 282.0, 370.0, 432.0, 329.0, 319.0, 348.0, 371.0, 255.0, 266.0, 354.0, 344.0, 324.0, 333.0, 286.0, 365.0, 355.0, 337.0, 362.0, 236.0, 265.0, 298.0, 316.0, 408.0, 297.0, 401.0, 327.0, 401.0, 393.0, 338.0, 311.0, 339.0, 333.0, 316.0, 411.0, 306.0, 343.0, 341.0, 358.0, 329.0, 316.0, 292.0, 308.0, 375.0, 194.0, 350.0, 290.0, 241.0, 411.0, 337.0, 364.0, 327.0, 343.0, 371.0, 420.0, 339.0, 314.0, 353.0, 335.0, 398.0, 355.0, 383.0, 338.0, 298.0, 325.0, 403.0, 250.0, 379.0, 339.0, 267.0, 327.0, 304.0, 301.0, 302.0, 283.0, 251.0, 336.0, 323.0, 268.0, 346.0, 304.0, 345.0, 373.0, 324.0, 312.0, 351.0, 341.0, 260.0, 380.0, 328.0, 356.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.507725638405772, "mean_inference_ms": 4.410824902354167, "mean_action_processing_ms": 0.14861696659368537, "mean_env_wait_ms": 0.3073864514774873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05533146858215332, "StateBufferConnector_ms": 0.0010247230529785156, "ViewRequirementAgentConnector_ms": 0.17232227325439453}, "num_episodes": 20, "episode_return_max": 432.0, "episode_return_min": 194.0, "episode_return_mean": 331.8, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33850, "num_agent_steps_trained": 33500, "num_env_steps_sampled": 33850, "num_env_steps_trained": 33500, "num_env_steps_sampled_this_iter": 2050, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 203.22344033526872, "num_env_steps_trained_throughput_per_sec": 198.26677105879875, "timesteps_total": 33850, "num_env_steps_sampled_lifetime": 33850, "num_agent_steps_sampled_lifetime": 33850, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 33850, "timers": {"training_iteration_time_ms": 10121.947, "restore_workers_time_ms": 0.0, "training_step_time_ms": 169.901, "sample_time_ms": 169.502, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 33850, "num_env_steps_trained": 33500, "num_agent_steps_sampled": 33850, "num_agent_steps_trained": 33500, "num_training_step_calls_since_last_synch_worker_weights": 677, "num_samples_added_to_queue": 33500}, "done": false, "episodes_total": 338, "training_iteration": 18, "trial_id": "default", "date": "2024-05-19_19-08-06", "timestamp": 1716170886, "time_this_iter_s": 10.087648868560791, "time_total_s": 182.67582321166992, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 182.67582321166992, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 5.771428571428572, "ram_util_percent": 88.03571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0, "total_loss": 1335459.125, "policy_loss": 89383.59375, "entropy": 2.0794286727905273, "entropy_coeff": 0.01, "var_gnorm": 64.00000762939453, "vf_loss": 2492171.75, "vf_explained_var": -2.384185791015625e-07}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 74.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 37150, "num_env_steps_trained": 37000, "num_agent_steps_sampled": 37150, "num_agent_steps_trained": 37000, "num_training_step_calls_since_last_synch_worker_weights": 743, "num_samples_added_to_queue": 37000, "learner_queue": {"size_count": 74, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 46.201, "learner_load_time_ms": 0.207, "learner_load_wait_time_ms": 1830.225, "learner_dequeue_time_ms": 76072.139}}, "sampler_results": {"episode_reward_max": 431.0, "episode_reward_min": 194.0, "episode_reward_mean": 329.76, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 33, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [297.0, 401.0, 327.0, 401.0, 393.0, 338.0, 311.0, 339.0, 333.0, 316.0, 411.0, 306.0, 343.0, 341.0, 358.0, 329.0, 316.0, 292.0, 308.0, 375.0, 194.0, 350.0, 290.0, 241.0, 411.0, 337.0, 364.0, 327.0, 343.0, 371.0, 420.0, 339.0, 314.0, 353.0, 335.0, 398.0, 355.0, 383.0, 338.0, 298.0, 325.0, 403.0, 250.0, 379.0, 339.0, 267.0, 327.0, 304.0, 301.0, 302.0, 283.0, 251.0, 336.0, 323.0, 268.0, 346.0, 304.0, 345.0, 373.0, 324.0, 312.0, 351.0, 341.0, 260.0, 380.0, 328.0, 356.0, 276.0, 305.0, 325.0, 403.0, 282.0, 331.0, 283.0, 385.0, 377.0, 378.0, 257.0, 310.0, 323.0, 278.0, 335.0, 305.0, 306.0, 369.0, 217.0, 300.0, 261.0, 369.0, 316.0, 340.0, 315.0, 347.0, 289.0, 384.0, 334.0, 306.0, 292.0, 431.0, 373.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49996177888109217, "mean_inference_ms": 4.344214315753939, "mean_action_processing_ms": 0.1468116961169538, "mean_env_wait_ms": 0.3041413779565188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04846978187561035, "StateBufferConnector_ms": 0.0010247230529785156, "ViewRequirementAgentConnector_ms": 0.14436721801757812}, "num_episodes": 33, "episode_return_max": 431.0, "episode_return_min": 194.0, "episode_return_mean": 329.76}, "env_runner_results": {"episode_reward_max": 431.0, "episode_reward_min": 194.0, "episode_reward_mean": 329.76, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 33, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [297.0, 401.0, 327.0, 401.0, 393.0, 338.0, 311.0, 339.0, 333.0, 316.0, 411.0, 306.0, 343.0, 341.0, 358.0, 329.0, 316.0, 292.0, 308.0, 375.0, 194.0, 350.0, 290.0, 241.0, 411.0, 337.0, 364.0, 327.0, 343.0, 371.0, 420.0, 339.0, 314.0, 353.0, 335.0, 398.0, 355.0, 383.0, 338.0, 298.0, 325.0, 403.0, 250.0, 379.0, 339.0, 267.0, 327.0, 304.0, 301.0, 302.0, 283.0, 251.0, 336.0, 323.0, 268.0, 346.0, 304.0, 345.0, 373.0, 324.0, 312.0, 351.0, 341.0, 260.0, 380.0, 328.0, 356.0, 276.0, 305.0, 325.0, 403.0, 282.0, 331.0, 283.0, 385.0, 377.0, 378.0, 257.0, 310.0, 323.0, 278.0, 335.0, 305.0, 306.0, 369.0, 217.0, 300.0, 261.0, 369.0, 316.0, 340.0, 315.0, 347.0, 289.0, 384.0, 334.0, 306.0, 292.0, 431.0, 373.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49996177888109217, "mean_inference_ms": 4.344214315753939, "mean_action_processing_ms": 0.1468116961169538, "mean_env_wait_ms": 0.3041413779565188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04846978187561035, "StateBufferConnector_ms": 0.0010247230529785156, "ViewRequirementAgentConnector_ms": 0.14436721801757812}, "num_episodes": 33, "episode_return_max": 431.0, "episode_return_min": 194.0, "episode_return_mean": 329.76}, "episode_reward_max": 431.0, "episode_reward_min": 194.0, "episode_reward_mean": 329.76, "episode_len_mean": 100.0, "episodes_this_iter": 33, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [297.0, 401.0, 327.0, 401.0, 393.0, 338.0, 311.0, 339.0, 333.0, 316.0, 411.0, 306.0, 343.0, 341.0, 358.0, 329.0, 316.0, 292.0, 308.0, 375.0, 194.0, 350.0, 290.0, 241.0, 411.0, 337.0, 364.0, 327.0, 343.0, 371.0, 420.0, 339.0, 314.0, 353.0, 335.0, 398.0, 355.0, 383.0, 338.0, 298.0, 325.0, 403.0, 250.0, 379.0, 339.0, 267.0, 327.0, 304.0, 301.0, 302.0, 283.0, 251.0, 336.0, 323.0, 268.0, 346.0, 304.0, 345.0, 373.0, 324.0, 312.0, 351.0, 341.0, 260.0, 380.0, 328.0, 356.0, 276.0, 305.0, 325.0, 403.0, 282.0, 331.0, 283.0, 385.0, 377.0, 378.0, 257.0, 310.0, 323.0, 278.0, 335.0, 305.0, 306.0, 369.0, 217.0, 300.0, 261.0, 369.0, 316.0, 340.0, 315.0, 347.0, 289.0, 384.0, 334.0, 306.0, 292.0, 431.0, 373.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49996177888109217, "mean_inference_ms": 4.344214315753939, "mean_action_processing_ms": 0.1468116961169538, "mean_env_wait_ms": 0.3041413779565188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04846978187561035, "StateBufferConnector_ms": 0.0010247230529785156, "ViewRequirementAgentConnector_ms": 0.14436721801757812}, "num_episodes": 33, "episode_return_max": 431.0, "episode_return_min": 194.0, "episode_return_mean": 329.76, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37150, "num_agent_steps_trained": 37000, "num_env_steps_sampled": 37150, "num_env_steps_trained": 37000, "num_env_steps_sampled_this_iter": 3300, "num_env_steps_trained_this_iter": 3500, "num_env_steps_sampled_throughput_per_sec": 329.487979483253, "num_env_steps_trained_throughput_per_sec": 349.45694793678354, "timesteps_total": 37150, "num_env_steps_sampled_lifetime": 37150, "num_agent_steps_sampled_lifetime": 37150, "num_steps_trained_this_iter": 3500, "agent_timesteps_total": 37150, "timers": {"training_iteration_time_ms": 10116.779, "restore_workers_time_ms": 0.0, "training_step_time_ms": 136.19, "sample_time_ms": 135.89, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 37150, "num_env_steps_trained": 37000, "num_agent_steps_sampled": 37150, "num_agent_steps_trained": 37000, "num_training_step_calls_since_last_synch_worker_weights": 743, "num_samples_added_to_queue": 37000}, "done": false, "episodes_total": 371, "training_iteration": 19, "trial_id": "default", "date": "2024-05-19_19-08-16", "timestamp": 1716170896, "time_this_iter_s": 10.01654863357544, "time_total_s": 192.69237184524536, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 192.69237184524536, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 3.6333333333333333, "ram_util_percent": 88.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0, "total_loss": 1066853.125, "policy_loss": 76652.3828125, "entropy": 2.0794286727905273, "entropy_coeff": 0.01, "var_gnorm": 64.00000762939453, "vf_loss": 1980422.375, "vf_explained_var": -7.510185241699219e-06}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 39750, "num_env_steps_trained": 39500, "num_agent_steps_sampled": 39750, "num_agent_steps_trained": 39500, "num_training_step_calls_since_last_synch_worker_weights": 795, "num_samples_added_to_queue": 39500, "learner_queue": {"size_count": 79, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 48.59, "learner_load_time_ms": 0.207, "learner_load_wait_time_ms": 1627.255, "learner_dequeue_time_ms": 76072.139}}, "sampler_results": {"episode_reward_max": 431.0, "episode_reward_min": 202.0, "episode_reward_mean": 326.34, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [364.0, 327.0, 343.0, 371.0, 420.0, 339.0, 314.0, 353.0, 335.0, 398.0, 355.0, 383.0, 338.0, 298.0, 325.0, 403.0, 250.0, 379.0, 339.0, 267.0, 327.0, 304.0, 301.0, 302.0, 283.0, 251.0, 336.0, 323.0, 268.0, 346.0, 304.0, 345.0, 373.0, 324.0, 312.0, 351.0, 341.0, 260.0, 380.0, 328.0, 356.0, 276.0, 305.0, 325.0, 403.0, 282.0, 331.0, 283.0, 385.0, 377.0, 378.0, 257.0, 310.0, 323.0, 278.0, 335.0, 305.0, 306.0, 369.0, 217.0, 300.0, 261.0, 369.0, 316.0, 340.0, 315.0, 347.0, 289.0, 384.0, 334.0, 306.0, 292.0, 431.0, 373.0, 315.0, 324.0, 303.0, 263.0, 288.0, 253.0, 321.0, 320.0, 337.0, 303.0, 325.0, 202.0, 372.0, 376.0, 278.0, 346.0, 352.0, 337.0, 314.0, 351.0, 361.0, 299.0, 349.0, 310.0, 385.0, 332.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4916583189843199, "mean_inference_ms": 4.278198417535276, "mean_action_processing_ms": 0.14473927350286556, "mean_env_wait_ms": 0.29967416941264086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038925886154174805, "StateBufferConnector_ms": 0.0010247230529785156, "ViewRequirementAgentConnector_ms": 0.10081958770751953}, "num_episodes": 26, "episode_return_max": 431.0, "episode_return_min": 202.0, "episode_return_mean": 326.34}, "env_runner_results": {"episode_reward_max": 431.0, "episode_reward_min": 202.0, "episode_reward_mean": 326.34, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 26, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [364.0, 327.0, 343.0, 371.0, 420.0, 339.0, 314.0, 353.0, 335.0, 398.0, 355.0, 383.0, 338.0, 298.0, 325.0, 403.0, 250.0, 379.0, 339.0, 267.0, 327.0, 304.0, 301.0, 302.0, 283.0, 251.0, 336.0, 323.0, 268.0, 346.0, 304.0, 345.0, 373.0, 324.0, 312.0, 351.0, 341.0, 260.0, 380.0, 328.0, 356.0, 276.0, 305.0, 325.0, 403.0, 282.0, 331.0, 283.0, 385.0, 377.0, 378.0, 257.0, 310.0, 323.0, 278.0, 335.0, 305.0, 306.0, 369.0, 217.0, 300.0, 261.0, 369.0, 316.0, 340.0, 315.0, 347.0, 289.0, 384.0, 334.0, 306.0, 292.0, 431.0, 373.0, 315.0, 324.0, 303.0, 263.0, 288.0, 253.0, 321.0, 320.0, 337.0, 303.0, 325.0, 202.0, 372.0, 376.0, 278.0, 346.0, 352.0, 337.0, 314.0, 351.0, 361.0, 299.0, 349.0, 310.0, 385.0, 332.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4916583189843199, "mean_inference_ms": 4.278198417535276, "mean_action_processing_ms": 0.14473927350286556, "mean_env_wait_ms": 0.29967416941264086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038925886154174805, "StateBufferConnector_ms": 0.0010247230529785156, "ViewRequirementAgentConnector_ms": 0.10081958770751953}, "num_episodes": 26, "episode_return_max": 431.0, "episode_return_min": 202.0, "episode_return_mean": 326.34}, "episode_reward_max": 431.0, "episode_reward_min": 202.0, "episode_reward_mean": 326.34, "episode_len_mean": 100.0, "episodes_this_iter": 26, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [364.0, 327.0, 343.0, 371.0, 420.0, 339.0, 314.0, 353.0, 335.0, 398.0, 355.0, 383.0, 338.0, 298.0, 325.0, 403.0, 250.0, 379.0, 339.0, 267.0, 327.0, 304.0, 301.0, 302.0, 283.0, 251.0, 336.0, 323.0, 268.0, 346.0, 304.0, 345.0, 373.0, 324.0, 312.0, 351.0, 341.0, 260.0, 380.0, 328.0, 356.0, 276.0, 305.0, 325.0, 403.0, 282.0, 331.0, 283.0, 385.0, 377.0, 378.0, 257.0, 310.0, 323.0, 278.0, 335.0, 305.0, 306.0, 369.0, 217.0, 300.0, 261.0, 369.0, 316.0, 340.0, 315.0, 347.0, 289.0, 384.0, 334.0, 306.0, 292.0, 431.0, 373.0, 315.0, 324.0, 303.0, 263.0, 288.0, 253.0, 321.0, 320.0, 337.0, 303.0, 325.0, 202.0, 372.0, 376.0, 278.0, 346.0, 352.0, 337.0, 314.0, 351.0, 361.0, 299.0, 349.0, 310.0, 385.0, 332.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4916583189843199, "mean_inference_ms": 4.278198417535276, "mean_action_processing_ms": 0.14473927350286556, "mean_env_wait_ms": 0.29967416941264086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038925886154174805, "StateBufferConnector_ms": 0.0010247230529785156, "ViewRequirementAgentConnector_ms": 0.10081958770751953}, "num_episodes": 26, "episode_return_max": 431.0, "episode_return_min": 202.0, "episode_return_mean": 326.34, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39750, "num_agent_steps_trained": 39500, "num_env_steps_sampled": 39750, "num_env_steps_trained": 39500, "num_env_steps_sampled_this_iter": 2600, "num_env_steps_trained_this_iter": 2500, "num_env_steps_sampled_throughput_per_sec": 255.32709791975617, "num_env_steps_trained_throughput_per_sec": 245.50682492284247, "timesteps_total": 39750, "num_env_steps_sampled_lifetime": 39750, "num_agent_steps_sampled_lifetime": 39750, "num_steps_trained_this_iter": 2500, "agent_timesteps_total": 39750, "timers": {"training_iteration_time_ms": 10129.849, "restore_workers_time_ms": 0.0, "training_step_time_ms": 269.867, "sample_time_ms": 267.988, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 39750, "num_env_steps_trained": 39500, "num_agent_steps_sampled": 39750, "num_agent_steps_trained": 39500, "num_training_step_calls_since_last_synch_worker_weights": 795, "num_samples_added_to_queue": 39500}, "done": false, "episodes_total": 397, "training_iteration": 20, "trial_id": "default", "date": "2024-05-19_19-08-26", "timestamp": 1716170906, "time_this_iter_s": 10.184051752090454, "time_total_s": 202.87642359733582, "pid": 23928, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case1env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000027F814A9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 202.87642359733582, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 4.042857142857143, "ram_util_percent": 87.72857142857141}}
