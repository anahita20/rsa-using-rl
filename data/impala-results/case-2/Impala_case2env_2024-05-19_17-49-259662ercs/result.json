{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.003, "total_loss": 755103.9375, "policy_loss": 32520.3359375, "entropy": 0.9657564163208008, "entropy_coeff": 0.01, "var_gnorm": 64.1441650390625, "vf_loss": 1445176.875, "vf_explained_var": -0.0009371042251586914}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2300, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 2300, "num_agent_steps_trained": 2000, "num_training_step_calls_since_last_synch_worker_weights": 46, "num_samples_added_to_queue": 2000, "learner_queue": {"size_count": 4, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.727, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2119.349, "learner_dequeue_time_ms": 1983.141}}, "sampler_results": {"episode_reward_max": 338.0, "episode_reward_min": -56.0, "episode_reward_mean": 155.82608695652175, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 2300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.0, 80.0, 137.0, 102.0, 33.0, 18.0, 81.0, -56.0, 88.0, 43.0, 102.0, 217.0, 212.0, 121.0, 150.0, 338.0, 223.0, 255.0, 254.0, 264.0, 269.0, 273.0, 248.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3460845134922444, "mean_inference_ms": 3.580275435698441, "mean_action_processing_ms": 0.12099944939047609, "mean_env_wait_ms": 0.3241675151839872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012705637061077616, "StateBufferConnector_ms": 0.001352766285771909, "ViewRequirementAgentConnector_ms": 0.19789675007695737}, "num_episodes": 23, "episode_return_max": 338.0, "episode_return_min": -56.0, "episode_return_mean": 155.82608695652175}, "env_runner_results": {"episode_reward_max": 338.0, "episode_reward_min": -56.0, "episode_reward_mean": 155.82608695652175, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 2300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.0, 80.0, 137.0, 102.0, 33.0, 18.0, 81.0, -56.0, 88.0, 43.0, 102.0, 217.0, 212.0, 121.0, 150.0, 338.0, 223.0, 255.0, 254.0, 264.0, 269.0, 273.0, 248.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3460845134922444, "mean_inference_ms": 3.580275435698441, "mean_action_processing_ms": 0.12099944939047609, "mean_env_wait_ms": 0.3241675151839872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012705637061077616, "StateBufferConnector_ms": 0.001352766285771909, "ViewRequirementAgentConnector_ms": 0.19789675007695737}, "num_episodes": 23, "episode_return_max": 338.0, "episode_return_min": -56.0, "episode_return_mean": 155.82608695652175}, "episode_reward_max": 338.0, "episode_reward_min": -56.0, "episode_reward_mean": 155.82608695652175, "episode_len_mean": 100.0, "episodes_this_iter": 23, "episodes_timesteps_total": 2300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [132.0, 80.0, 137.0, 102.0, 33.0, 18.0, 81.0, -56.0, 88.0, 43.0, 102.0, 217.0, 212.0, 121.0, 150.0, 338.0, 223.0, 255.0, 254.0, 264.0, 269.0, 273.0, 248.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3460845134922444, "mean_inference_ms": 3.580275435698441, "mean_action_processing_ms": 0.12099944939047609, "mean_env_wait_ms": 0.3241675151839872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012705637061077616, "StateBufferConnector_ms": 0.001352766285771909, "ViewRequirementAgentConnector_ms": 0.19789675007695737}, "num_episodes": 23, "episode_return_max": 338.0, "episode_return_min": -56.0, "episode_return_mean": 155.82608695652175, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2300, "num_agent_steps_trained": 2000, "num_env_steps_sampled": 2300, "num_env_steps_trained": 2000, "num_env_steps_sampled_this_iter": 2300, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 227.2000517005043, "num_env_steps_trained_throughput_per_sec": 197.5652623482646, "timesteps_total": 2300, "num_env_steps_sampled_lifetime": 2300, "num_agent_steps_sampled_lifetime": 2300, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 2300, "timers": {"training_iteration_time_ms": 10123.237, "restore_workers_time_ms": 0.0, "training_step_time_ms": 310.765, "sample_time_ms": 310.271, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 2300, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 2300, "num_agent_steps_trained": 2000, "num_training_step_calls_since_last_synch_worker_weights": 46, "num_samples_added_to_queue": 2000}, "done": false, "episodes_total": 23, "training_iteration": 1, "trial_id": "default", "date": "2024-05-19_17-49-36", "timestamp": 1716166176, "time_this_iter_s": 10.124338388442993, "time_total_s": 10.124338388442993, "pid": 32224, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case2env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000188B2915620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 10.124338388442993, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 6.533333333333333, "ram_util_percent": 88.35333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.003, "total_loss": 697834.75, "policy_loss": 3920.1220703125, "entropy": 0.08376336097717285, "entropy_coeff": 0.01, "var_gnorm": 64.61077117919922, "vf_loss": 1387830.125, "vf_explained_var": -0.007810831069946289}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4050, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4050, "num_agent_steps_trained": 4000, "num_training_step_calls_since_last_synch_worker_weights": 81, "num_samples_added_to_queue": 4000, "learner_queue": {"size_count": 8, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.752, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2479.404, "learner_dequeue_time_ms": 1983.141}}, "sampler_results": {"episode_reward_max": 338.0, "episode_reward_min": -56.0, "episode_reward_mean": 214.825, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.0, 80.0, 137.0, 102.0, 33.0, 18.0, 81.0, -56.0, 88.0, 43.0, 102.0, 217.0, 212.0, 121.0, 150.0, 338.0, 223.0, 255.0, 254.0, 264.0, 269.0, 273.0, 248.0, 245.0, 337.0, 290.0, 200.0, 324.0, 277.0, 298.0, 329.0, 310.0, 310.0, 313.0, 301.0, 304.0, 312.0, 301.0, 301.0, 257.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36768883148313575, "mean_inference_ms": 3.782784019416616, "mean_action_processing_ms": 0.12717047508322454, "mean_env_wait_ms": 0.36157341878676624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007305741310119629, "StateBufferConnector_ms": 0.0007778406143188477, "ViewRequirementAgentConnector_ms": 0.14343023300170898}, "num_episodes": 17, "episode_return_max": 338.0, "episode_return_min": -56.0, "episode_return_mean": 214.825}, "env_runner_results": {"episode_reward_max": 338.0, "episode_reward_min": -56.0, "episode_reward_mean": 214.825, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.0, 80.0, 137.0, 102.0, 33.0, 18.0, 81.0, -56.0, 88.0, 43.0, 102.0, 217.0, 212.0, 121.0, 150.0, 338.0, 223.0, 255.0, 254.0, 264.0, 269.0, 273.0, 248.0, 245.0, 337.0, 290.0, 200.0, 324.0, 277.0, 298.0, 329.0, 310.0, 310.0, 313.0, 301.0, 304.0, 312.0, 301.0, 301.0, 257.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36768883148313575, "mean_inference_ms": 3.782784019416616, "mean_action_processing_ms": 0.12717047508322454, "mean_env_wait_ms": 0.36157341878676624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007305741310119629, "StateBufferConnector_ms": 0.0007778406143188477, "ViewRequirementAgentConnector_ms": 0.14343023300170898}, "num_episodes": 17, "episode_return_max": 338.0, "episode_return_min": -56.0, "episode_return_mean": 214.825}, "episode_reward_max": 338.0, "episode_reward_min": -56.0, "episode_reward_mean": 214.825, "episode_len_mean": 100.0, "episodes_this_iter": 17, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [132.0, 80.0, 137.0, 102.0, 33.0, 18.0, 81.0, -56.0, 88.0, 43.0, 102.0, 217.0, 212.0, 121.0, 150.0, 338.0, 223.0, 255.0, 254.0, 264.0, 269.0, 273.0, 248.0, 245.0, 337.0, 290.0, 200.0, 324.0, 277.0, 298.0, 329.0, 310.0, 310.0, 313.0, 301.0, 304.0, 312.0, 301.0, 301.0, 257.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36768883148313575, "mean_inference_ms": 3.782784019416616, "mean_action_processing_ms": 0.12717047508322454, "mean_env_wait_ms": 0.36157341878676624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007305741310119629, "StateBufferConnector_ms": 0.0007778406143188477, "ViewRequirementAgentConnector_ms": 0.14343023300170898}, "num_episodes": 17, "episode_return_max": 338.0, "episode_return_min": -56.0, "episode_return_mean": 214.825, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4050, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4050, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 1750, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 169.92812650357666, "num_env_steps_trained_throughput_per_sec": 194.20357314694476, "timesteps_total": 4050, "num_env_steps_sampled_lifetime": 4050, "num_agent_steps_sampled_lifetime": 4050, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 4050, "timers": {"training_iteration_time_ms": 10210.854, "restore_workers_time_ms": 0.0, "training_step_time_ms": 297.788, "sample_time_ms": 297.334, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 4050, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4050, "num_agent_steps_trained": 4000, "num_training_step_calls_since_last_synch_worker_weights": 81, "num_samples_added_to_queue": 4000}, "done": false, "episodes_total": 40, "training_iteration": 2, "trial_id": "default", "date": "2024-05-19_17-49-46", "timestamp": 1716166186, "time_this_iter_s": 10.298471689224243, "time_total_s": 20.422810077667236, "pid": 32224, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case2env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000188B2915620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 20.422810077667236, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 6.593333333333333, "ram_util_percent": 88.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.003, "total_loss": 755682.8125, "policy_loss": 1295.591064453125, "entropy": 0.03757616877555847, "entropy_coeff": 0.01, "var_gnorm": 65.03047943115234, "vf_loss": 1508774.875, "vf_explained_var": -0.016771435737609863}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5750, "num_env_steps_trained": 5500, "num_agent_steps_sampled": 5750, "num_agent_steps_trained": 5500, "num_training_step_calls_since_last_synch_worker_weights": 115, "num_samples_added_to_queue": 5500, "learner_queue": {"size_count": 11, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.779, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2654.619, "learner_dequeue_time_ms": 1983.141}}, "sampler_results": {"episode_reward_max": 354.0, "episode_reward_min": -56.0, "episode_reward_mean": 240.66666666666666, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 5700, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.0, 80.0, 137.0, 102.0, 33.0, 18.0, 81.0, -56.0, 88.0, 43.0, 102.0, 217.0, 212.0, 121.0, 150.0, 338.0, 223.0, 255.0, 254.0, 264.0, 269.0, 273.0, 248.0, 245.0, 337.0, 290.0, 200.0, 324.0, 277.0, 298.0, 329.0, 310.0, 310.0, 313.0, 301.0, 304.0, 312.0, 301.0, 301.0, 257.0, 283.0, 306.0, 327.0, 354.0, 306.0, 262.0, 310.0, 319.0, 285.0, 304.0, 261.0, 271.0, 309.0, 308.0, 331.0, 315.0, 274.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.388260206271754, "mean_inference_ms": 3.9299605486008238, "mean_action_processing_ms": 0.13104678985850454, "mean_env_wait_ms": 0.3854252568115514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009075800577799479, "StateBufferConnector_ms": 0.002300948427434553, "ViewRequirementAgentConnector_ms": 0.13345291740015933}, "num_episodes": 17, "episode_return_max": 354.0, "episode_return_min": -56.0, "episode_return_mean": 240.66666666666666}, "env_runner_results": {"episode_reward_max": 354.0, "episode_reward_min": -56.0, "episode_reward_mean": 240.66666666666666, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 5700, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.0, 80.0, 137.0, 102.0, 33.0, 18.0, 81.0, -56.0, 88.0, 43.0, 102.0, 217.0, 212.0, 121.0, 150.0, 338.0, 223.0, 255.0, 254.0, 264.0, 269.0, 273.0, 248.0, 245.0, 337.0, 290.0, 200.0, 324.0, 277.0, 298.0, 329.0, 310.0, 310.0, 313.0, 301.0, 304.0, 312.0, 301.0, 301.0, 257.0, 283.0, 306.0, 327.0, 354.0, 306.0, 262.0, 310.0, 319.0, 285.0, 304.0, 261.0, 271.0, 309.0, 308.0, 331.0, 315.0, 274.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.388260206271754, "mean_inference_ms": 3.9299605486008238, "mean_action_processing_ms": 0.13104678985850454, "mean_env_wait_ms": 0.3854252568115514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009075800577799479, "StateBufferConnector_ms": 0.002300948427434553, "ViewRequirementAgentConnector_ms": 0.13345291740015933}, "num_episodes": 17, "episode_return_max": 354.0, "episode_return_min": -56.0, "episode_return_mean": 240.66666666666666}, "episode_reward_max": 354.0, "episode_reward_min": -56.0, "episode_reward_mean": 240.66666666666666, "episode_len_mean": 100.0, "episodes_this_iter": 17, "episodes_timesteps_total": 5700, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [132.0, 80.0, 137.0, 102.0, 33.0, 18.0, 81.0, -56.0, 88.0, 43.0, 102.0, 217.0, 212.0, 121.0, 150.0, 338.0, 223.0, 255.0, 254.0, 264.0, 269.0, 273.0, 248.0, 245.0, 337.0, 290.0, 200.0, 324.0, 277.0, 298.0, 329.0, 310.0, 310.0, 313.0, 301.0, 304.0, 312.0, 301.0, 301.0, 257.0, 283.0, 306.0, 327.0, 354.0, 306.0, 262.0, 310.0, 319.0, 285.0, 304.0, 261.0, 271.0, 309.0, 308.0, 331.0, 315.0, 274.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.388260206271754, "mean_inference_ms": 3.9299605486008238, "mean_action_processing_ms": 0.13104678985850454, "mean_env_wait_ms": 0.3854252568115514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009075800577799479, "StateBufferConnector_ms": 0.002300948427434553, "ViewRequirementAgentConnector_ms": 0.13345291740015933}, "num_episodes": 17, "episode_return_max": 354.0, "episode_return_min": -56.0, "episode_return_mean": 240.66666666666666, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5750, "num_agent_steps_trained": 5500, "num_env_steps_sampled": 5750, "num_env_steps_trained": 5500, "num_env_steps_sampled_this_iter": 1700, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 165.4371451003059, "num_env_steps_trained_throughput_per_sec": 145.97395155909345, "timesteps_total": 5750, "num_env_steps_sampled_lifetime": 5750, "num_agent_steps_sampled_lifetime": 5750, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 5750, "timers": {"training_iteration_time_ms": 10232.505, "restore_workers_time_ms": 0.0, "training_step_time_ms": 310.888, "sample_time_ms": 308.764, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 5750, "num_env_steps_trained": 5500, "num_agent_steps_sampled": 5750, "num_agent_steps_trained": 5500, "num_training_step_calls_since_last_synch_worker_weights": 115, "num_samples_added_to_queue": 5500}, "done": false, "episodes_total": 57, "training_iteration": 3, "trial_id": "default", "date": "2024-05-19_17-49-57", "timestamp": 1716166197, "time_this_iter_s": 10.275805950164795, "time_total_s": 30.69861602783203, "pid": 32224, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case2env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000188B2915620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 30.69861602783203, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 6.521428571428571, "ram_util_percent": 88.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.003, "total_loss": 469114.4375, "policy_loss": 456.70477294921875, "entropy": 0.013992929831147194, "entropy_coeff": 0.01, "var_gnorm": 65.45805358886719, "vf_loss": 937315.625, "vf_explained_var": -0.026979804039001465}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7300, "num_env_steps_trained": 7000, "num_agent_steps_sampled": 7300, "num_agent_steps_trained": 7000, "num_training_step_calls_since_last_synch_worker_weights": 146, "num_samples_added_to_queue": 7000, "learner_queue": {"size_count": 14, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 76.133, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2951.133, "learner_dequeue_time_ms": 1983.141}}, "sampler_results": {"episode_reward_max": 357.0, "episode_reward_min": -56.0, "episode_reward_mean": 248.94520547945206, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 7300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.0, 80.0, 137.0, 102.0, 33.0, 18.0, 81.0, -56.0, 88.0, 43.0, 102.0, 217.0, 212.0, 121.0, 150.0, 338.0, 223.0, 255.0, 254.0, 264.0, 269.0, 273.0, 248.0, 245.0, 337.0, 290.0, 200.0, 324.0, 277.0, 298.0, 329.0, 310.0, 310.0, 313.0, 301.0, 304.0, 312.0, 301.0, 301.0, 257.0, 283.0, 306.0, 327.0, 354.0, 306.0, 262.0, 310.0, 319.0, 285.0, 304.0, 261.0, 271.0, 309.0, 308.0, 331.0, 315.0, 274.0, 336.0, 303.0, 279.0, 289.0, 268.0, 357.0, 271.0, 255.0, 316.0, 271.0, 270.0, 228.0, 187.0, 314.0, 287.0, 224.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40490137970583095, "mean_inference_ms": 4.048296455715837, "mean_action_processing_ms": 0.13363916043915078, "mean_env_wait_ms": 0.40116194734362015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012577396549590647, "StateBufferConnector_ms": 0.006465389303965111, "ViewRequirementAgentConnector_ms": 0.1257275881832593}, "num_episodes": 16, "episode_return_max": 357.0, "episode_return_min": -56.0, "episode_return_mean": 248.94520547945206}, "env_runner_results": {"episode_reward_max": 357.0, "episode_reward_min": -56.0, "episode_reward_mean": 248.94520547945206, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 7300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.0, 80.0, 137.0, 102.0, 33.0, 18.0, 81.0, -56.0, 88.0, 43.0, 102.0, 217.0, 212.0, 121.0, 150.0, 338.0, 223.0, 255.0, 254.0, 264.0, 269.0, 273.0, 248.0, 245.0, 337.0, 290.0, 200.0, 324.0, 277.0, 298.0, 329.0, 310.0, 310.0, 313.0, 301.0, 304.0, 312.0, 301.0, 301.0, 257.0, 283.0, 306.0, 327.0, 354.0, 306.0, 262.0, 310.0, 319.0, 285.0, 304.0, 261.0, 271.0, 309.0, 308.0, 331.0, 315.0, 274.0, 336.0, 303.0, 279.0, 289.0, 268.0, 357.0, 271.0, 255.0, 316.0, 271.0, 270.0, 228.0, 187.0, 314.0, 287.0, 224.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40490137970583095, "mean_inference_ms": 4.048296455715837, "mean_action_processing_ms": 0.13363916043915078, "mean_env_wait_ms": 0.40116194734362015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012577396549590647, "StateBufferConnector_ms": 0.006465389303965111, "ViewRequirementAgentConnector_ms": 0.1257275881832593}, "num_episodes": 16, "episode_return_max": 357.0, "episode_return_min": -56.0, "episode_return_mean": 248.94520547945206}, "episode_reward_max": 357.0, "episode_reward_min": -56.0, "episode_reward_mean": 248.94520547945206, "episode_len_mean": 100.0, "episodes_this_iter": 16, "episodes_timesteps_total": 7300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [132.0, 80.0, 137.0, 102.0, 33.0, 18.0, 81.0, -56.0, 88.0, 43.0, 102.0, 217.0, 212.0, 121.0, 150.0, 338.0, 223.0, 255.0, 254.0, 264.0, 269.0, 273.0, 248.0, 245.0, 337.0, 290.0, 200.0, 324.0, 277.0, 298.0, 329.0, 310.0, 310.0, 313.0, 301.0, 304.0, 312.0, 301.0, 301.0, 257.0, 283.0, 306.0, 327.0, 354.0, 306.0, 262.0, 310.0, 319.0, 285.0, 304.0, 261.0, 271.0, 309.0, 308.0, 331.0, 315.0, 274.0, 336.0, 303.0, 279.0, 289.0, 268.0, 357.0, 271.0, 255.0, 316.0, 271.0, 270.0, 228.0, 187.0, 314.0, 287.0, 224.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40490137970583095, "mean_inference_ms": 4.048296455715837, "mean_action_processing_ms": 0.13363916043915078, "mean_env_wait_ms": 0.40116194734362015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012577396549590647, "StateBufferConnector_ms": 0.006465389303965111, "ViewRequirementAgentConnector_ms": 0.1257275881832593}, "num_episodes": 16, "episode_return_max": 357.0, "episode_return_min": -56.0, "episode_return_mean": 248.94520547945206, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7300, "num_agent_steps_trained": 7000, "num_env_steps_sampled": 7300, "num_env_steps_trained": 7000, "num_env_steps_sampled_this_iter": 1550, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 154.6297964984183, "num_env_steps_trained_throughput_per_sec": 149.6417385468564, "timesteps_total": 7300, "num_env_steps_sampled_lifetime": 7300, "num_agent_steps_sampled_lifetime": 7300, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 7300, "timers": {"training_iteration_time_ms": 10180.364, "restore_workers_time_ms": 0.0, "training_step_time_ms": 348.732, "sample_time_ms": 348.057, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 7300, "num_env_steps_trained": 7000, "num_agent_steps_sampled": 7300, "num_agent_steps_trained": 7000, "num_training_step_calls_since_last_synch_worker_weights": 146, "num_samples_added_to_queue": 7000}, "done": false, "episodes_total": 73, "training_iteration": 4, "trial_id": "default", "date": "2024-05-19_17-50-07", "timestamp": 1716166207, "time_this_iter_s": 10.026221752166748, "time_total_s": 40.72483777999878, "pid": 32224, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case2env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000188B2915620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 40.72483777999878, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 7.714285714285714, "ram_util_percent": 88.16428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.003, "total_loss": 487206.40625, "policy_loss": 16.31050682067871, "entropy": 0.004954469855874777, "entropy_coeff": 0.01, "var_gnorm": 65.88957214355469, "vf_loss": 974380.25, "vf_explained_var": -0.04653894901275635}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8900, "num_env_steps_trained": 8500, "num_agent_steps_sampled": 8900, "num_agent_steps_trained": 8500, "num_training_step_calls_since_last_synch_worker_weights": 178, "num_samples_added_to_queue": 8500, "learner_queue": {"size_count": 17, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 73.996, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 3058.998, "learner_dequeue_time_ms": 24307.168}}, "sampler_results": {"episode_reward_max": 357.0, "episode_reward_min": -56.0, "episode_reward_mean": 255.59550561797752, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 8900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.0, 80.0, 137.0, 102.0, 33.0, 18.0, 81.0, -56.0, 88.0, 43.0, 102.0, 217.0, 212.0, 121.0, 150.0, 338.0, 223.0, 255.0, 254.0, 264.0, 269.0, 273.0, 248.0, 245.0, 337.0, 290.0, 200.0, 324.0, 277.0, 298.0, 329.0, 310.0, 310.0, 313.0, 301.0, 304.0, 312.0, 301.0, 301.0, 257.0, 283.0, 306.0, 327.0, 354.0, 306.0, 262.0, 310.0, 319.0, 285.0, 304.0, 261.0, 271.0, 309.0, 308.0, 331.0, 315.0, 274.0, 336.0, 303.0, 279.0, 289.0, 268.0, 357.0, 271.0, 255.0, 316.0, 271.0, 270.0, 228.0, 187.0, 314.0, 287.0, 224.0, 320.0, 267.0, 313.0, 261.0, 286.0, 335.0, 285.0, 282.0, 218.0, 278.0, 288.0, 280.0, 288.0, 267.0, 278.0, 329.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41827682907955094, "mean_inference_ms": 4.1451270364904405, "mean_action_processing_ms": 0.1340668218532355, "mean_env_wait_ms": 0.41155356138382304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013693798793835586, "StateBufferConnector_ms": 0.005303072125724192, "ViewRequirementAgentConnector_ms": 0.13136702976869732}, "num_episodes": 16, "episode_return_max": 357.0, "episode_return_min": -56.0, "episode_return_mean": 255.59550561797752}, "env_runner_results": {"episode_reward_max": 357.0, "episode_reward_min": -56.0, "episode_reward_mean": 255.59550561797752, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 8900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.0, 80.0, 137.0, 102.0, 33.0, 18.0, 81.0, -56.0, 88.0, 43.0, 102.0, 217.0, 212.0, 121.0, 150.0, 338.0, 223.0, 255.0, 254.0, 264.0, 269.0, 273.0, 248.0, 245.0, 337.0, 290.0, 200.0, 324.0, 277.0, 298.0, 329.0, 310.0, 310.0, 313.0, 301.0, 304.0, 312.0, 301.0, 301.0, 257.0, 283.0, 306.0, 327.0, 354.0, 306.0, 262.0, 310.0, 319.0, 285.0, 304.0, 261.0, 271.0, 309.0, 308.0, 331.0, 315.0, 274.0, 336.0, 303.0, 279.0, 289.0, 268.0, 357.0, 271.0, 255.0, 316.0, 271.0, 270.0, 228.0, 187.0, 314.0, 287.0, 224.0, 320.0, 267.0, 313.0, 261.0, 286.0, 335.0, 285.0, 282.0, 218.0, 278.0, 288.0, 280.0, 288.0, 267.0, 278.0, 329.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41827682907955094, "mean_inference_ms": 4.1451270364904405, "mean_action_processing_ms": 0.1340668218532355, "mean_env_wait_ms": 0.41155356138382304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013693798793835586, "StateBufferConnector_ms": 0.005303072125724192, "ViewRequirementAgentConnector_ms": 0.13136702976869732}, "num_episodes": 16, "episode_return_max": 357.0, "episode_return_min": -56.0, "episode_return_mean": 255.59550561797752}, "episode_reward_max": 357.0, "episode_reward_min": -56.0, "episode_reward_mean": 255.59550561797752, "episode_len_mean": 100.0, "episodes_this_iter": 16, "episodes_timesteps_total": 8900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [132.0, 80.0, 137.0, 102.0, 33.0, 18.0, 81.0, -56.0, 88.0, 43.0, 102.0, 217.0, 212.0, 121.0, 150.0, 338.0, 223.0, 255.0, 254.0, 264.0, 269.0, 273.0, 248.0, 245.0, 337.0, 290.0, 200.0, 324.0, 277.0, 298.0, 329.0, 310.0, 310.0, 313.0, 301.0, 304.0, 312.0, 301.0, 301.0, 257.0, 283.0, 306.0, 327.0, 354.0, 306.0, 262.0, 310.0, 319.0, 285.0, 304.0, 261.0, 271.0, 309.0, 308.0, 331.0, 315.0, 274.0, 336.0, 303.0, 279.0, 289.0, 268.0, 357.0, 271.0, 255.0, 316.0, 271.0, 270.0, 228.0, 187.0, 314.0, 287.0, 224.0, 320.0, 267.0, 313.0, 261.0, 286.0, 335.0, 285.0, 282.0, 218.0, 278.0, 288.0, 280.0, 288.0, 267.0, 278.0, 329.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41827682907955094, "mean_inference_ms": 4.1451270364904405, "mean_action_processing_ms": 0.1340668218532355, "mean_env_wait_ms": 0.41155356138382304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013693798793835586, "StateBufferConnector_ms": 0.005303072125724192, "ViewRequirementAgentConnector_ms": 0.13136702976869732}, "num_episodes": 16, "episode_return_max": 357.0, "episode_return_min": -56.0, "episode_return_mean": 255.59550561797752, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8900, "num_agent_steps_trained": 8500, "num_env_steps_sampled": 8900, "num_env_steps_trained": 8500, "num_env_steps_sampled_this_iter": 1600, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 159.52955883636966, "num_env_steps_trained_throughput_per_sec": 149.55896140909655, "timesteps_total": 8900, "num_env_steps_sampled_lifetime": 8900, "num_agent_steps_sampled_lifetime": 8900, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 8900, "timers": {"training_iteration_time_ms": 10150.189, "restore_workers_time_ms": 0.0, "training_step_time_ms": 304.77, "sample_time_ms": 304.314, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 8900, "num_env_steps_trained": 8500, "num_agent_steps_sampled": 8900, "num_agent_steps_trained": 8500, "num_training_step_calls_since_last_synch_worker_weights": 178, "num_samples_added_to_queue": 8500}, "done": false, "episodes_total": 89, "training_iteration": 5, "trial_id": "default", "date": "2024-05-19_17-50-17", "timestamp": 1716166217, "time_this_iter_s": 10.030486822128296, "time_total_s": 50.755324602127075, "pid": 32224, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case2env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000188B2915620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 50.755324602127075, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 7.12, "ram_util_percent": 87.45333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.003, "total_loss": 539756.5625, "policy_loss": 2.6654560565948486, "entropy": 0.0011462975526228547, "entropy_coeff": 0.01, "var_gnorm": 66.50679016113281, "vf_loss": 1079507.75, "vf_explained_var": -0.033338069915771484}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 10600, "num_env_steps_trained": 10500, "num_agent_steps_sampled": 10600, "num_agent_steps_trained": 10500, "num_training_step_calls_since_last_synch_worker_weights": 212, "num_samples_added_to_queue": 10500, "learner_queue": {"size_count": 21, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 79.832, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 3045.886, "learner_dequeue_time_ms": 24307.168}}, "sampler_results": {"episode_reward_max": 357.0, "episode_reward_min": -56.0, "episode_reward_mean": 271.93, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [81.0, -56.0, 88.0, 43.0, 102.0, 217.0, 212.0, 121.0, 150.0, 338.0, 223.0, 255.0, 254.0, 264.0, 269.0, 273.0, 248.0, 245.0, 337.0, 290.0, 200.0, 324.0, 277.0, 298.0, 329.0, 310.0, 310.0, 313.0, 301.0, 304.0, 312.0, 301.0, 301.0, 257.0, 283.0, 306.0, 327.0, 354.0, 306.0, 262.0, 310.0, 319.0, 285.0, 304.0, 261.0, 271.0, 309.0, 308.0, 331.0, 315.0, 274.0, 336.0, 303.0, 279.0, 289.0, 268.0, 357.0, 271.0, 255.0, 316.0, 271.0, 270.0, 228.0, 187.0, 314.0, 287.0, 224.0, 320.0, 267.0, 313.0, 261.0, 286.0, 335.0, 285.0, 282.0, 218.0, 278.0, 288.0, 280.0, 288.0, 267.0, 278.0, 329.0, 244.0, 351.0, 308.0, 285.0, 281.0, 334.0, 303.0, 290.0, 334.0, 267.0, 286.0, 286.0, 279.0, 286.0, 284.0, 304.0, 225.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43513508720209876, "mean_inference_ms": 4.254921213516486, "mean_action_processing_ms": 0.13520257802933014, "mean_env_wait_ms": 0.42721882496539193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014498233795166016, "StateBufferConnector_ms": 0.004719734191894531, "ViewRequirementAgentConnector_ms": 0.13185358047485352}, "num_episodes": 17, "episode_return_max": 357.0, "episode_return_min": -56.0, "episode_return_mean": 271.93}, "env_runner_results": {"episode_reward_max": 357.0, "episode_reward_min": -56.0, "episode_reward_mean": 271.93, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [81.0, -56.0, 88.0, 43.0, 102.0, 217.0, 212.0, 121.0, 150.0, 338.0, 223.0, 255.0, 254.0, 264.0, 269.0, 273.0, 248.0, 245.0, 337.0, 290.0, 200.0, 324.0, 277.0, 298.0, 329.0, 310.0, 310.0, 313.0, 301.0, 304.0, 312.0, 301.0, 301.0, 257.0, 283.0, 306.0, 327.0, 354.0, 306.0, 262.0, 310.0, 319.0, 285.0, 304.0, 261.0, 271.0, 309.0, 308.0, 331.0, 315.0, 274.0, 336.0, 303.0, 279.0, 289.0, 268.0, 357.0, 271.0, 255.0, 316.0, 271.0, 270.0, 228.0, 187.0, 314.0, 287.0, 224.0, 320.0, 267.0, 313.0, 261.0, 286.0, 335.0, 285.0, 282.0, 218.0, 278.0, 288.0, 280.0, 288.0, 267.0, 278.0, 329.0, 244.0, 351.0, 308.0, 285.0, 281.0, 334.0, 303.0, 290.0, 334.0, 267.0, 286.0, 286.0, 279.0, 286.0, 284.0, 304.0, 225.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43513508720209876, "mean_inference_ms": 4.254921213516486, "mean_action_processing_ms": 0.13520257802933014, "mean_env_wait_ms": 0.42721882496539193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014498233795166016, "StateBufferConnector_ms": 0.004719734191894531, "ViewRequirementAgentConnector_ms": 0.13185358047485352}, "num_episodes": 17, "episode_return_max": 357.0, "episode_return_min": -56.0, "episode_return_mean": 271.93}, "episode_reward_max": 357.0, "episode_reward_min": -56.0, "episode_reward_mean": 271.93, "episode_len_mean": 100.0, "episodes_this_iter": 17, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [81.0, -56.0, 88.0, 43.0, 102.0, 217.0, 212.0, 121.0, 150.0, 338.0, 223.0, 255.0, 254.0, 264.0, 269.0, 273.0, 248.0, 245.0, 337.0, 290.0, 200.0, 324.0, 277.0, 298.0, 329.0, 310.0, 310.0, 313.0, 301.0, 304.0, 312.0, 301.0, 301.0, 257.0, 283.0, 306.0, 327.0, 354.0, 306.0, 262.0, 310.0, 319.0, 285.0, 304.0, 261.0, 271.0, 309.0, 308.0, 331.0, 315.0, 274.0, 336.0, 303.0, 279.0, 289.0, 268.0, 357.0, 271.0, 255.0, 316.0, 271.0, 270.0, 228.0, 187.0, 314.0, 287.0, 224.0, 320.0, 267.0, 313.0, 261.0, 286.0, 335.0, 285.0, 282.0, 218.0, 278.0, 288.0, 280.0, 288.0, 267.0, 278.0, 329.0, 244.0, 351.0, 308.0, 285.0, 281.0, 334.0, 303.0, 290.0, 334.0, 267.0, 286.0, 286.0, 279.0, 286.0, 284.0, 304.0, 225.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43513508720209876, "mean_inference_ms": 4.254921213516486, "mean_action_processing_ms": 0.13520257802933014, "mean_env_wait_ms": 0.42721882496539193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014498233795166016, "StateBufferConnector_ms": 0.004719734191894531, "ViewRequirementAgentConnector_ms": 0.13185358047485352}, "num_episodes": 17, "episode_return_max": 357.0, "episode_return_min": -56.0, "episode_return_mean": 271.93, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10600, "num_agent_steps_trained": 10500, "num_env_steps_sampled": 10600, "num_env_steps_trained": 10500, "num_env_steps_sampled_this_iter": 1700, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 169.2716278221763, "num_env_steps_trained_throughput_per_sec": 199.14309155550154, "timesteps_total": 10600, "num_env_steps_sampled_lifetime": 10600, "num_agent_steps_sampled_lifetime": 10600, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 10600, "timers": {"training_iteration_time_ms": 10132.329, "restore_workers_time_ms": 0.0, "training_step_time_ms": 290.661, "sample_time_ms": 288.71, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 10600, "num_env_steps_trained": 10500, "num_agent_steps_sampled": 10600, "num_agent_steps_trained": 10500, "num_training_step_calls_since_last_synch_worker_weights": 212, "num_samples_added_to_queue": 10500}, "done": false, "episodes_total": 106, "training_iteration": 6, "trial_id": "default", "date": "2024-05-19_17-50-27", "timestamp": 1716166227, "time_this_iter_s": 10.059171676635742, "time_total_s": 60.81449627876282, "pid": 32224, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case2env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000188B2915620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 60.81449627876282, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 5.285714285714286, "ram_util_percent": 87.65714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.003, "total_loss": 432257.75, "policy_loss": 0.6505489945411682, "entropy": 0.00047490341239608824, "entropy_coeff": 0.01, "var_gnorm": 67.0187759399414, "vf_loss": 864514.1875, "vf_explained_var": -0.044463276863098145}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 12200, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12200, "num_agent_steps_trained": 12000, "num_training_step_calls_since_last_synch_worker_weights": 244, "num_samples_added_to_queue": 12000, "learner_queue": {"size_count": 24, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.68, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 3037.334, "learner_dequeue_time_ms": 24307.168}}, "sampler_results": {"episode_reward_max": 357.0, "episode_reward_min": 187.0, "episode_reward_mean": 287.48, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [248.0, 245.0, 337.0, 290.0, 200.0, 324.0, 277.0, 298.0, 329.0, 310.0, 310.0, 313.0, 301.0, 304.0, 312.0, 301.0, 301.0, 257.0, 283.0, 306.0, 327.0, 354.0, 306.0, 262.0, 310.0, 319.0, 285.0, 304.0, 261.0, 271.0, 309.0, 308.0, 331.0, 315.0, 274.0, 336.0, 303.0, 279.0, 289.0, 268.0, 357.0, 271.0, 255.0, 316.0, 271.0, 270.0, 228.0, 187.0, 314.0, 287.0, 224.0, 320.0, 267.0, 313.0, 261.0, 286.0, 335.0, 285.0, 282.0, 218.0, 278.0, 288.0, 280.0, 288.0, 267.0, 278.0, 329.0, 244.0, 351.0, 308.0, 285.0, 281.0, 334.0, 303.0, 290.0, 334.0, 267.0, 286.0, 286.0, 279.0, 286.0, 284.0, 304.0, 225.0, 324.0, 303.0, 256.0, 222.0, 311.0, 319.0, 340.0, 309.0, 195.0, 242.0, 276.0, 223.0, 315.0, 263.0, 223.0, 268.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4591279502619487, "mean_inference_ms": 4.426380770590657, "mean_action_processing_ms": 0.13746932955371996, "mean_env_wait_ms": 0.4528810718386333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015610218048095703, "StateBufferConnector_ms": 0.004408597946166992, "ViewRequirementAgentConnector_ms": 0.12752938270568848}, "num_episodes": 16, "episode_return_max": 357.0, "episode_return_min": 187.0, "episode_return_mean": 287.48}, "env_runner_results": {"episode_reward_max": 357.0, "episode_reward_min": 187.0, "episode_reward_mean": 287.48, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [248.0, 245.0, 337.0, 290.0, 200.0, 324.0, 277.0, 298.0, 329.0, 310.0, 310.0, 313.0, 301.0, 304.0, 312.0, 301.0, 301.0, 257.0, 283.0, 306.0, 327.0, 354.0, 306.0, 262.0, 310.0, 319.0, 285.0, 304.0, 261.0, 271.0, 309.0, 308.0, 331.0, 315.0, 274.0, 336.0, 303.0, 279.0, 289.0, 268.0, 357.0, 271.0, 255.0, 316.0, 271.0, 270.0, 228.0, 187.0, 314.0, 287.0, 224.0, 320.0, 267.0, 313.0, 261.0, 286.0, 335.0, 285.0, 282.0, 218.0, 278.0, 288.0, 280.0, 288.0, 267.0, 278.0, 329.0, 244.0, 351.0, 308.0, 285.0, 281.0, 334.0, 303.0, 290.0, 334.0, 267.0, 286.0, 286.0, 279.0, 286.0, 284.0, 304.0, 225.0, 324.0, 303.0, 256.0, 222.0, 311.0, 319.0, 340.0, 309.0, 195.0, 242.0, 276.0, 223.0, 315.0, 263.0, 223.0, 268.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4591279502619487, "mean_inference_ms": 4.426380770590657, "mean_action_processing_ms": 0.13746932955371996, "mean_env_wait_ms": 0.4528810718386333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015610218048095703, "StateBufferConnector_ms": 0.004408597946166992, "ViewRequirementAgentConnector_ms": 0.12752938270568848}, "num_episodes": 16, "episode_return_max": 357.0, "episode_return_min": 187.0, "episode_return_mean": 287.48}, "episode_reward_max": 357.0, "episode_reward_min": 187.0, "episode_reward_mean": 287.48, "episode_len_mean": 100.0, "episodes_this_iter": 16, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [248.0, 245.0, 337.0, 290.0, 200.0, 324.0, 277.0, 298.0, 329.0, 310.0, 310.0, 313.0, 301.0, 304.0, 312.0, 301.0, 301.0, 257.0, 283.0, 306.0, 327.0, 354.0, 306.0, 262.0, 310.0, 319.0, 285.0, 304.0, 261.0, 271.0, 309.0, 308.0, 331.0, 315.0, 274.0, 336.0, 303.0, 279.0, 289.0, 268.0, 357.0, 271.0, 255.0, 316.0, 271.0, 270.0, 228.0, 187.0, 314.0, 287.0, 224.0, 320.0, 267.0, 313.0, 261.0, 286.0, 335.0, 285.0, 282.0, 218.0, 278.0, 288.0, 280.0, 288.0, 267.0, 278.0, 329.0, 244.0, 351.0, 308.0, 285.0, 281.0, 334.0, 303.0, 290.0, 334.0, 267.0, 286.0, 286.0, 279.0, 286.0, 284.0, 304.0, 225.0, 324.0, 303.0, 256.0, 222.0, 311.0, 319.0, 340.0, 309.0, 195.0, 242.0, 276.0, 223.0, 315.0, 263.0, 223.0, 268.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4591279502619487, "mean_inference_ms": 4.426380770590657, "mean_action_processing_ms": 0.13746932955371996, "mean_env_wait_ms": 0.4528810718386333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015610218048095703, "StateBufferConnector_ms": 0.004408597946166992, "ViewRequirementAgentConnector_ms": 0.12752938270568848}, "num_episodes": 16, "episode_return_max": 357.0, "episode_return_min": 187.0, "episode_return_mean": 287.48, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12200, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12200, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 1600, "num_env_steps_trained_this_iter": 1500, "num_env_steps_sampled_throughput_per_sec": 158.45414141229065, "num_env_steps_trained_throughput_per_sec": 148.5507575740225, "timesteps_total": 12200, "num_env_steps_sampled_lifetime": 12200, "num_agent_steps_sampled_lifetime": 12200, "num_steps_trained_this_iter": 1500, "agent_timesteps_total": 12200, "timers": {"training_iteration_time_ms": 10127.362, "restore_workers_time_ms": 0.0, "training_step_time_ms": 296.75, "sample_time_ms": 296.453, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 12200, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12200, "num_agent_steps_trained": 12000, "num_training_step_calls_since_last_synch_worker_weights": 244, "num_samples_added_to_queue": 12000}, "done": false, "episodes_total": 122, "training_iteration": 7, "trial_id": "default", "date": "2024-05-19_17-50-37", "timestamp": 1716166237, "time_this_iter_s": 10.09859299659729, "time_total_s": 70.91308927536011, "pid": 32224, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case2env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000188B2915620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 70.91308927536011, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 4.907142857142857, "ram_util_percent": 87.05714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.003, "total_loss": 591383.25, "policy_loss": 0.2547505795955658, "entropy": 0.00019505643285810947, "entropy_coeff": 0.01, "var_gnorm": 67.81758117675781, "vf_loss": 1182766.0, "vf_explained_var": -0.039459943771362305}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 14250, "num_env_steps_trained": 14000, "num_agent_steps_sampled": 14250, "num_agent_steps_trained": 14000, "num_training_step_calls_since_last_synch_worker_weights": 285, "num_samples_added_to_queue": 14000, "learner_queue": {"size_count": 28, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 74.857, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 2821.561, "learner_dequeue_time_ms": 24307.168}}, "sampler_results": {"episode_reward_max": 357.0, "episode_reward_min": 187.0, "episode_reward_mean": 286.49, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [327.0, 354.0, 306.0, 262.0, 310.0, 319.0, 285.0, 304.0, 261.0, 271.0, 309.0, 308.0, 331.0, 315.0, 274.0, 336.0, 303.0, 279.0, 289.0, 268.0, 357.0, 271.0, 255.0, 316.0, 271.0, 270.0, 228.0, 187.0, 314.0, 287.0, 224.0, 320.0, 267.0, 313.0, 261.0, 286.0, 335.0, 285.0, 282.0, 218.0, 278.0, 288.0, 280.0, 288.0, 267.0, 278.0, 329.0, 244.0, 351.0, 308.0, 285.0, 281.0, 334.0, 303.0, 290.0, 334.0, 267.0, 286.0, 286.0, 279.0, 286.0, 284.0, 304.0, 225.0, 324.0, 303.0, 256.0, 222.0, 311.0, 319.0, 340.0, 309.0, 195.0, 242.0, 276.0, 223.0, 315.0, 263.0, 223.0, 268.0, 290.0, 315.0, 291.0, 260.0, 270.0, 234.0, 248.0, 299.0, 300.0, 303.0, 270.0, 320.0, 274.0, 354.0, 269.0, 270.0, 317.0, 289.0, 274.0, 300.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47665775257718096, "mean_inference_ms": 4.525367863065931, "mean_action_processing_ms": 0.13698248970649538, "mean_env_wait_ms": 0.4651893106063521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016602277755737305, "StateBufferConnector_ms": 0.004408597946166992, "ViewRequirementAgentConnector_ms": 0.13217377662658691}, "num_episodes": 20, "episode_return_max": 357.0, "episode_return_min": 187.0, "episode_return_mean": 286.49}, "env_runner_results": {"episode_reward_max": 357.0, "episode_reward_min": 187.0, "episode_reward_mean": 286.49, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [327.0, 354.0, 306.0, 262.0, 310.0, 319.0, 285.0, 304.0, 261.0, 271.0, 309.0, 308.0, 331.0, 315.0, 274.0, 336.0, 303.0, 279.0, 289.0, 268.0, 357.0, 271.0, 255.0, 316.0, 271.0, 270.0, 228.0, 187.0, 314.0, 287.0, 224.0, 320.0, 267.0, 313.0, 261.0, 286.0, 335.0, 285.0, 282.0, 218.0, 278.0, 288.0, 280.0, 288.0, 267.0, 278.0, 329.0, 244.0, 351.0, 308.0, 285.0, 281.0, 334.0, 303.0, 290.0, 334.0, 267.0, 286.0, 286.0, 279.0, 286.0, 284.0, 304.0, 225.0, 324.0, 303.0, 256.0, 222.0, 311.0, 319.0, 340.0, 309.0, 195.0, 242.0, 276.0, 223.0, 315.0, 263.0, 223.0, 268.0, 290.0, 315.0, 291.0, 260.0, 270.0, 234.0, 248.0, 299.0, 300.0, 303.0, 270.0, 320.0, 274.0, 354.0, 269.0, 270.0, 317.0, 289.0, 274.0, 300.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47665775257718096, "mean_inference_ms": 4.525367863065931, "mean_action_processing_ms": 0.13698248970649538, "mean_env_wait_ms": 0.4651893106063521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016602277755737305, "StateBufferConnector_ms": 0.004408597946166992, "ViewRequirementAgentConnector_ms": 0.13217377662658691}, "num_episodes": 20, "episode_return_max": 357.0, "episode_return_min": 187.0, "episode_return_mean": 286.49}, "episode_reward_max": 357.0, "episode_reward_min": 187.0, "episode_reward_mean": 286.49, "episode_len_mean": 100.0, "episodes_this_iter": 20, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [327.0, 354.0, 306.0, 262.0, 310.0, 319.0, 285.0, 304.0, 261.0, 271.0, 309.0, 308.0, 331.0, 315.0, 274.0, 336.0, 303.0, 279.0, 289.0, 268.0, 357.0, 271.0, 255.0, 316.0, 271.0, 270.0, 228.0, 187.0, 314.0, 287.0, 224.0, 320.0, 267.0, 313.0, 261.0, 286.0, 335.0, 285.0, 282.0, 218.0, 278.0, 288.0, 280.0, 288.0, 267.0, 278.0, 329.0, 244.0, 351.0, 308.0, 285.0, 281.0, 334.0, 303.0, 290.0, 334.0, 267.0, 286.0, 286.0, 279.0, 286.0, 284.0, 304.0, 225.0, 324.0, 303.0, 256.0, 222.0, 311.0, 319.0, 340.0, 309.0, 195.0, 242.0, 276.0, 223.0, 315.0, 263.0, 223.0, 268.0, 290.0, 315.0, 291.0, 260.0, 270.0, 234.0, 248.0, 299.0, 300.0, 303.0, 270.0, 320.0, 274.0, 354.0, 269.0, 270.0, 317.0, 289.0, 274.0, 300.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47665775257718096, "mean_inference_ms": 4.525367863065931, "mean_action_processing_ms": 0.13698248970649538, "mean_env_wait_ms": 0.4651893106063521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016602277755737305, "StateBufferConnector_ms": 0.004408597946166992, "ViewRequirementAgentConnector_ms": 0.13217377662658691}, "num_episodes": 20, "episode_return_max": 357.0, "episode_return_min": 187.0, "episode_return_mean": 286.49, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14250, "num_agent_steps_trained": 14000, "num_env_steps_sampled": 14250, "num_env_steps_trained": 14000, "num_env_steps_sampled_this_iter": 2050, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 203.16870780768932, "num_env_steps_trained_throughput_per_sec": 198.2133734709164, "timesteps_total": 14250, "num_env_steps_sampled_lifetime": 14250, "num_agent_steps_sampled_lifetime": 14250, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 14250, "timers": {"training_iteration_time_ms": 10122.709, "restore_workers_time_ms": 0.0, "training_step_time_ms": 146.508, "sample_time_ms": 146.508, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 14250, "num_env_steps_trained": 14000, "num_agent_steps_sampled": 14250, "num_agent_steps_trained": 14000, "num_training_step_calls_since_last_synch_worker_weights": 285, "num_samples_added_to_queue": 14000}, "done": false, "episodes_total": 142, "training_iteration": 8, "trial_id": "default", "date": "2024-05-19_17-50-47", "timestamp": 1716166247, "time_this_iter_s": 10.090136528015137, "time_total_s": 81.00322580337524, "pid": 32224, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case2env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000188B2915620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 81.00322580337524, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 5.65, "ram_util_percent": 86.25714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.003, "total_loss": 676705.375, "policy_loss": 0.1012275442481041, "entropy": 7.85346346674487e-05, "entropy_coeff": 0.01, "var_gnorm": 69.11666870117188, "vf_loss": 1353410.5, "vf_explained_var": -0.0164334774017334}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 17350, "num_env_steps_trained": 17000, "num_agent_steps_sampled": 17350, "num_agent_steps_trained": 17000, "num_training_step_calls_since_last_synch_worker_weights": 347, "num_samples_added_to_queue": 17000, "learner_queue": {"size_count": 34, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 50.599, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 1990.126, "learner_dequeue_time_ms": 29675.385}}, "sampler_results": {"episode_reward_max": 354.0, "episode_reward_min": 195.0, "episode_reward_mean": 286.47, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 31, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [320.0, 267.0, 313.0, 261.0, 286.0, 335.0, 285.0, 282.0, 218.0, 278.0, 288.0, 280.0, 288.0, 267.0, 278.0, 329.0, 244.0, 351.0, 308.0, 285.0, 281.0, 334.0, 303.0, 290.0, 334.0, 267.0, 286.0, 286.0, 279.0, 286.0, 284.0, 304.0, 225.0, 324.0, 303.0, 256.0, 222.0, 311.0, 319.0, 340.0, 309.0, 195.0, 242.0, 276.0, 223.0, 315.0, 263.0, 223.0, 268.0, 290.0, 315.0, 291.0, 260.0, 270.0, 234.0, 248.0, 299.0, 300.0, 303.0, 270.0, 320.0, 274.0, 354.0, 269.0, 270.0, 317.0, 289.0, 274.0, 300.0, 253.0, 281.0, 252.0, 286.0, 296.0, 249.0, 340.0, 281.0, 290.0, 297.0, 276.0, 321.0, 278.0, 313.0, 299.0, 260.0, 251.0, 299.0, 282.0, 278.0, 318.0, 234.0, 319.0, 337.0, 324.0, 296.0, 308.0, 342.0, 290.0, 282.0, 257.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4764125206568097, "mean_inference_ms": 4.471981043695068, "mean_action_processing_ms": 0.1308215365440104, "mean_env_wait_ms": 0.4602113699753235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02563643455505371, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.13135933876037598}, "num_episodes": 31, "episode_return_max": 354.0, "episode_return_min": 195.0, "episode_return_mean": 286.47}, "env_runner_results": {"episode_reward_max": 354.0, "episode_reward_min": 195.0, "episode_reward_mean": 286.47, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 31, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [320.0, 267.0, 313.0, 261.0, 286.0, 335.0, 285.0, 282.0, 218.0, 278.0, 288.0, 280.0, 288.0, 267.0, 278.0, 329.0, 244.0, 351.0, 308.0, 285.0, 281.0, 334.0, 303.0, 290.0, 334.0, 267.0, 286.0, 286.0, 279.0, 286.0, 284.0, 304.0, 225.0, 324.0, 303.0, 256.0, 222.0, 311.0, 319.0, 340.0, 309.0, 195.0, 242.0, 276.0, 223.0, 315.0, 263.0, 223.0, 268.0, 290.0, 315.0, 291.0, 260.0, 270.0, 234.0, 248.0, 299.0, 300.0, 303.0, 270.0, 320.0, 274.0, 354.0, 269.0, 270.0, 317.0, 289.0, 274.0, 300.0, 253.0, 281.0, 252.0, 286.0, 296.0, 249.0, 340.0, 281.0, 290.0, 297.0, 276.0, 321.0, 278.0, 313.0, 299.0, 260.0, 251.0, 299.0, 282.0, 278.0, 318.0, 234.0, 319.0, 337.0, 324.0, 296.0, 308.0, 342.0, 290.0, 282.0, 257.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4764125206568097, "mean_inference_ms": 4.471981043695068, "mean_action_processing_ms": 0.1308215365440104, "mean_env_wait_ms": 0.4602113699753235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02563643455505371, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.13135933876037598}, "num_episodes": 31, "episode_return_max": 354.0, "episode_return_min": 195.0, "episode_return_mean": 286.47}, "episode_reward_max": 354.0, "episode_reward_min": 195.0, "episode_reward_mean": 286.47, "episode_len_mean": 100.0, "episodes_this_iter": 31, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [320.0, 267.0, 313.0, 261.0, 286.0, 335.0, 285.0, 282.0, 218.0, 278.0, 288.0, 280.0, 288.0, 267.0, 278.0, 329.0, 244.0, 351.0, 308.0, 285.0, 281.0, 334.0, 303.0, 290.0, 334.0, 267.0, 286.0, 286.0, 279.0, 286.0, 284.0, 304.0, 225.0, 324.0, 303.0, 256.0, 222.0, 311.0, 319.0, 340.0, 309.0, 195.0, 242.0, 276.0, 223.0, 315.0, 263.0, 223.0, 268.0, 290.0, 315.0, 291.0, 260.0, 270.0, 234.0, 248.0, 299.0, 300.0, 303.0, 270.0, 320.0, 274.0, 354.0, 269.0, 270.0, 317.0, 289.0, 274.0, 300.0, 253.0, 281.0, 252.0, 286.0, 296.0, 249.0, 340.0, 281.0, 290.0, 297.0, 276.0, 321.0, 278.0, 313.0, 299.0, 260.0, 251.0, 299.0, 282.0, 278.0, 318.0, 234.0, 319.0, 337.0, 324.0, 296.0, 308.0, 342.0, 290.0, 282.0, 257.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4764125206568097, "mean_inference_ms": 4.471981043695068, "mean_action_processing_ms": 0.1308215365440104, "mean_env_wait_ms": 0.4602113699753235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02563643455505371, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.13135933876037598}, "num_episodes": 31, "episode_return_max": 354.0, "episode_return_min": 195.0, "episode_return_mean": 286.47, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17350, "num_agent_steps_trained": 17000, "num_env_steps_sampled": 17350, "num_env_steps_trained": 17000, "num_env_steps_sampled_this_iter": 3100, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 308.21444779402657, "num_env_steps_trained_throughput_per_sec": 298.27204625228376, "timesteps_total": 17350, "num_env_steps_sampled_lifetime": 17350, "num_agent_steps_sampled_lifetime": 17350, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 17350, "timers": {"training_iteration_time_ms": 10115.511, "restore_workers_time_ms": 0.0, "training_step_time_ms": 158.298, "sample_time_ms": 158.298, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 17350, "num_env_steps_trained": 17000, "num_agent_steps_sampled": 17350, "num_agent_steps_trained": 17000, "num_training_step_calls_since_last_synch_worker_weights": 347, "num_samples_added_to_queue": 17000}, "done": false, "episodes_total": 173, "training_iteration": 9, "trial_id": "default", "date": "2024-05-19_17-50-57", "timestamp": 1716166257, "time_this_iter_s": 10.059159278869629, "time_total_s": 91.06238508224487, "pid": 32224, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case2env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000188B2915620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 91.06238508224487, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 4.453333333333334, "ram_util_percent": 84.15333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.003, "total_loss": 559571.5625, "policy_loss": 0.019559254869818687, "entropy": 4.552870450424962e-05, "entropy_coeff": 0.01, "var_gnorm": 70.49085998535156, "vf_loss": 1119143.125, "vf_explained_var": -0.014716267585754395}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 20700, "num_env_steps_trained": 20500, "num_agent_steps_sampled": 20700, "num_agent_steps_trained": 20500, "num_training_step_calls_since_last_synch_worker_weights": 414, "num_samples_added_to_queue": 20500, "learner_queue": {"size_count": 41, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 48.578, "learner_load_time_ms": 0.0, "learner_load_wait_time_ms": 1450.328, "learner_dequeue_time_ms": 29675.385}}, "sampler_results": {"episode_reward_max": 361.0, "episode_reward_min": 195.0, "episode_reward_mean": 284.85, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 34, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [303.0, 256.0, 222.0, 311.0, 319.0, 340.0, 309.0, 195.0, 242.0, 276.0, 223.0, 315.0, 263.0, 223.0, 268.0, 290.0, 315.0, 291.0, 260.0, 270.0, 234.0, 248.0, 299.0, 300.0, 303.0, 270.0, 320.0, 274.0, 354.0, 269.0, 270.0, 317.0, 289.0, 274.0, 300.0, 253.0, 281.0, 252.0, 286.0, 296.0, 249.0, 340.0, 281.0, 290.0, 297.0, 276.0, 321.0, 278.0, 313.0, 299.0, 260.0, 251.0, 299.0, 282.0, 278.0, 318.0, 234.0, 319.0, 337.0, 324.0, 296.0, 308.0, 342.0, 290.0, 282.0, 257.0, 259.0, 283.0, 277.0, 324.0, 298.0, 253.0, 310.0, 296.0, 323.0, 302.0, 264.0, 240.0, 233.0, 302.0, 273.0, 294.0, 258.0, 254.0, 301.0, 282.0, 267.0, 361.0, 355.0, 330.0, 285.0, 303.0, 281.0, 280.0, 268.0, 340.0, 239.0, 284.0, 225.0, 240.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4515135313849359, "mean_inference_ms": 4.243747433852075, "mean_action_processing_ms": 0.12278658613156286, "mean_env_wait_ms": 0.439121125723713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02997422218322754, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09248566627502441}, "num_episodes": 34, "episode_return_max": 361.0, "episode_return_min": 195.0, "episode_return_mean": 284.85}, "env_runner_results": {"episode_reward_max": 361.0, "episode_reward_min": 195.0, "episode_reward_mean": 284.85, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 34, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [303.0, 256.0, 222.0, 311.0, 319.0, 340.0, 309.0, 195.0, 242.0, 276.0, 223.0, 315.0, 263.0, 223.0, 268.0, 290.0, 315.0, 291.0, 260.0, 270.0, 234.0, 248.0, 299.0, 300.0, 303.0, 270.0, 320.0, 274.0, 354.0, 269.0, 270.0, 317.0, 289.0, 274.0, 300.0, 253.0, 281.0, 252.0, 286.0, 296.0, 249.0, 340.0, 281.0, 290.0, 297.0, 276.0, 321.0, 278.0, 313.0, 299.0, 260.0, 251.0, 299.0, 282.0, 278.0, 318.0, 234.0, 319.0, 337.0, 324.0, 296.0, 308.0, 342.0, 290.0, 282.0, 257.0, 259.0, 283.0, 277.0, 324.0, 298.0, 253.0, 310.0, 296.0, 323.0, 302.0, 264.0, 240.0, 233.0, 302.0, 273.0, 294.0, 258.0, 254.0, 301.0, 282.0, 267.0, 361.0, 355.0, 330.0, 285.0, 303.0, 281.0, 280.0, 268.0, 340.0, 239.0, 284.0, 225.0, 240.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4515135313849359, "mean_inference_ms": 4.243747433852075, "mean_action_processing_ms": 0.12278658613156286, "mean_env_wait_ms": 0.439121125723713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02997422218322754, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09248566627502441}, "num_episodes": 34, "episode_return_max": 361.0, "episode_return_min": 195.0, "episode_return_mean": 284.85}, "episode_reward_max": 361.0, "episode_reward_min": 195.0, "episode_reward_mean": 284.85, "episode_len_mean": 100.0, "episodes_this_iter": 34, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [303.0, 256.0, 222.0, 311.0, 319.0, 340.0, 309.0, 195.0, 242.0, 276.0, 223.0, 315.0, 263.0, 223.0, 268.0, 290.0, 315.0, 291.0, 260.0, 270.0, 234.0, 248.0, 299.0, 300.0, 303.0, 270.0, 320.0, 274.0, 354.0, 269.0, 270.0, 317.0, 289.0, 274.0, 300.0, 253.0, 281.0, 252.0, 286.0, 296.0, 249.0, 340.0, 281.0, 290.0, 297.0, 276.0, 321.0, 278.0, 313.0, 299.0, 260.0, 251.0, 299.0, 282.0, 278.0, 318.0, 234.0, 319.0, 337.0, 324.0, 296.0, 308.0, 342.0, 290.0, 282.0, 257.0, 259.0, 283.0, 277.0, 324.0, 298.0, 253.0, 310.0, 296.0, 323.0, 302.0, 264.0, 240.0, 233.0, 302.0, 273.0, 294.0, 258.0, 254.0, 301.0, 282.0, 267.0, 361.0, 355.0, 330.0, 285.0, 303.0, 281.0, 280.0, 268.0, 340.0, 239.0, 284.0, 225.0, 240.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4515135313849359, "mean_inference_ms": 4.243747433852075, "mean_action_processing_ms": 0.12278658613156286, "mean_env_wait_ms": 0.439121125723713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02997422218322754, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09248566627502441}, "num_episodes": 34, "episode_return_max": 361.0, "episode_return_min": 195.0, "episode_return_mean": 284.85, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20700, "num_agent_steps_trained": 20500, "num_env_steps_sampled": 20700, "num_env_steps_trained": 20500, "num_env_steps_sampled_this_iter": 3350, "num_env_steps_trained_this_iter": 3500, "num_env_steps_sampled_throughput_per_sec": 331.5697195398491, "num_env_steps_trained_throughput_per_sec": 346.4161248923796, "timesteps_total": 20700, "num_env_steps_sampled_lifetime": 20700, "num_agent_steps_sampled_lifetime": 20700, "num_steps_trained_this_iter": 3500, "agent_timesteps_total": 20700, "timers": {"training_iteration_time_ms": 10114.306, "restore_workers_time_ms": 0.0, "training_step_time_ms": 147.999, "sample_time_ms": 147.421, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 20700, "num_env_steps_trained": 20500, "num_agent_steps_sampled": 20700, "num_agent_steps_trained": 20500, "num_training_step_calls_since_last_synch_worker_weights": 414, "num_samples_added_to_queue": 20500}, "done": false, "episodes_total": 207, "training_iteration": 10, "trial_id": "default", "date": "2024-05-19_17-51-08", "timestamp": 1716166268, "time_this_iter_s": 10.104455709457397, "time_total_s": 101.16684079170227, "pid": 32224, "hostname": "LAPTOP-Q8FAPJED", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "case2env", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.003, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 500, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000188B2915620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 1.0, "vtrace_clip_pg_rho_threshold": 1.0, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.0, "replay_buffer_num_slots": 0, "learner_queue_size": 16, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "after_train_step": null, "_minibatch_size": "auto", "num_data_loader_buffers": -1, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.MyPPOCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 101.16684079170227, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 3.0857142857142863, "ram_util_percent": 85.27857142857144}}
